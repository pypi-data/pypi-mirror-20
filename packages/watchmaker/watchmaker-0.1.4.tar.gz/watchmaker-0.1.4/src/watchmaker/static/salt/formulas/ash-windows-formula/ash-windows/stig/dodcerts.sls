#!py

import base64

CERTS = [
    {
        'id': 'SV-52961r3_rule',
        'keys': [
            r'HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\SystemCertificates\Root\Certificates\8C941B34EA1EA6ED9AE2BC54CF687252B4C9B561',
            r'HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\EnterpriseCertificates\Root\Certificates\8C941B34EA1EA6ED9AE2BC54CF687252B4C9B561',
            r'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\SystemCertificates\Root\Certificates\8C941B34EA1EA6ED9AE2BC54CF687252B4C9B561',
            r'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\EnterpriseCertificates\Root\Certificates\8C941B34EA1EA6ED9AE2BC54CF687252B4C9B561',
        ],
        'vdata': base64.b16decode(
            '5c0000000100000004000000000800001900000001000000100000000369ec22'
            '2bd877c01803f7e32eeaf6990f00000001000000140000008df2c761ae6d13b7'
            '1643f207be9b82362dcc14920300000001000000140000008c941b34ea1ea6ed'
            '9ae2bc54cf687252b4c9b5611400000001000000140000004974bb0c5eba7afe'
            '0254ef7ba0c695c609807096040000000100000010000000477892db8aec1b53'
            '68f01d009c34775e2000000001000000740300003082037030820258a0030201'
            '02020105300d06092a864886f70d0101050500305b310b300906035504061302'
            '555331183016060355040a130f552e532e20476f7665726e6d656e74310c300a'
            '060355040b1303446f44310c300a060355040b1303504b493116301406035504'
            '03130d446f4420526f6f742043412032301e170d303431323133313530303130'
            '5a170d3239313230353135303031305a305b310b300906035504061302555331'
            '183016060355040a130f552e532e20476f7665726e6d656e74310c300a060355'
            '040b1303446f44310c300a060355040b1303504b49311630140603550403130d'
            '446f4420526f6f74204341203230820122300d06092a864886f70d0101010500'
            '0382010f003082010a0282010100c02cc1f68d3bacff3f3cd671beb8742207ec'
            '704115fcab40e307aac1c3d89ffeda4c3abf3fc8d8287b4b3601c0ac4525c3d2'
            '0e0a8f851864103d1a13702a6f8ed7dc8d93b3410f3821cdadabc23d2a05d357'
            '11370dcd8c51f993e3cc4649218e14b4cdcb143e38cd7231eeab12f265ea342e'
            '565dffee6375cb6dba9134fc9ef3f42d1cbe50c442df5988ff6ab3faa86c3dcb'
            '5671710596bb9f80e58045596741b0ebc3ad60a4807506179c0ef443e0990e1b'
            'fb7ff5b3ccb28182b1fd32c1b8be41a464b5603a5a51308ccede412c19475c49'
            '1064b974a98741af7d6ebac1b8a1bf65313a0467f9b5bb8e928a0063b8b1e68c'
            '385f83ff50d53ba25d6bb210cc630203010001a33f303d301d0603551d0e0416'
            '04144974bb0c5eba7afe0254ef7ba0c695c609807096300b0603551d0f040403'
            '020186300f0603551d130101ff040530030101ff300d06092a864886f70d0101'
            '050500038201010098918d3f89c8bbf5c06973293b35acbab308763d700992e9'
            '844421017d14761bee516c1d8d15372d7b3169f49a44b8af46cc34fa23cb0327'
            '19d28321752be7e01b9926dc844095e8a8d2ccf6585c66ef3f4a9710821dba0a'
            'a2dd5b062b9da7644eeb2e0135a4b43f13ad55e4d573a8699b11f198f2311e6f'
            '40d4f8789f8e91a06f70049066aa062bcee17a92b57de1e0d196e7a13a2dccb1'
            '9d1f0544ed8799d34d1a7039c1040ce57ed9f1afd7200ef1227a25a47399cc3f'
            'a4072796a8a295ed82b916d39e0b87c2c1f288f562df68dfc7bc6951edb15cdc'
            '5454290f09399aac03c1db0c4dae6f0a7a1649f1bf91d23894d3f6952cb76cc9'
            '42b68dca908d85d9'
            .upper()
        ),
    },
    {
        'id': 'SV-52957r3_rule',
        'keys': [
            r'HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\SystemCertificates\Disallowed\Certificates\99C494ECE4FC093EEE13C4D65B1B1E01B9B5D434',
            r'HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\EnterpriseCertificates\Disallowed\Certificates\99C494ECE4FC093EEE13C4D65B1B1E01B9B5D434',
            r'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\SystemCertificates\Disallowed\Certificates\99C494ECE4FC093EEE13C4D65B1B1E01B9B5D434',
            r'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\EnterpriseCertificates\Disallowed\Certificates\99C494ECE4FC093EEE13C4D65B1B1E01B9B5D434',
        ],
        'vdata': base64.b16decode(
            '0f0000000100000014000000d937493704bb4e086b379c6f3b5f98716e5ef385'
            '03000000010000001400000099c494ece4fc093eee13c4d65b1b1e01b9b5d434'
            '20000000010000001b05000030820517308203ffa00302010202020378300d06'
            '092a864886f70d0101050500306c310b30090603550406130255533118301606'
            '0355040a130f552e532e20476f7665726e6d656e74310c300a060355040b1303'
            '446f44310c300a060355040b1303504b49312730250603550403131e446f4420'
            '496e7465726f7065726162696c69747920526f6f742043412031301e170d3133'
            '313031303133313534305a170d3136313030393133313534305a305b310b3009'
            '06035504061302555331183016060355040a130f552e532e20476f7665726e6d'
            '656e74310c300a060355040b1303446f44310c300a060355040b1303504b4931'
            '1630140603550403130d446f4420526f6f74204341203230820122300d06092a'
            '864886f70d01010105000382010f003082010a0282010100c02cc1f68d3bacff'
            '3f3cd671beb8742207ec704115fcab40e307aac1c3d89ffeda4c3abf3fc8d828'
            '7b4b3601c0ac4525c3d20e0a8f851864103d1a13702a6f8ed7dc8d93b3410f38'
            '21cdadabc23d2a05d35711370dcd8c51f993e3cc4649218e14b4cdcb143e38cd'
            '7231eeab12f265ea342e565dffee6375cb6dba9134fc9ef3f42d1cbe50c442df'
            '5988ff6ab3faa86c3dcb5671710596bb9f80e58045596741b0ebc3ad60a48075'
            '06179c0ef443e0990e1bfb7ff5b3ccb28182b1fd32c1b8be41a464b5603a5a51'
            '308ccede412c19475c491064b974a98741af7d6ebac1b8a1bf65313a0467f9b5'
            'bb8e928a0063b8b1e68c385f83ff50d53ba25d6bb210cc630203010001a38201'
            'd2308201ce301d0603551d0e041604144974bb0c5eba7afe0254ef7ba0c695c6'
            '09807096301f0603551d2304183016801476861edfed00c97e14317c5b948221'
            '4957be7007300e0603551d0f0101ff040403020106304a0603551d2004433041'
            '300b0609608648016502010b05300b0609608648016502010b09300b06096086'
            '48016502010b11300b0609608648016502010b12300b0609608648016502010b'
            '13307c06082b060105050701010470306e304a06082b06010505073002863e68'
            '7474703a2f2f63726c2e646973612e6d696c2f697373756564746f2f444f4449'
            '4e5445524f5045524142494c495459524f4f544341315f49542e703763302006'
            '082b060105050730018614687474703a2f2f6f6373702e646973612e6d696c30'
            '4a06082b0601050507010b043e303c303a06082b06010505073005862e687474'
            '703a2f2f63726c2e646973612e6d696c2f69737375656462792f444f44524f4f'
            '544341325f49422e703763300f0603551d130101ff040530030101ff300c0603'
            '551d240405300380010030470603551d1f0440303e303ca03aa0388636687474'
            '703a2f2f63726c2e646973612e6d696c2f63726c2f444f44494e5445524f5045'
            '524142494c495459524f4f544341312e63726c300d06092a864886f70d010105'
            '050003820101006d41168cc949e166ae06a1475bf4c014ca9e64d7ea49a788ae'
            '4eebac46e815e5ded4bfaee38b97b69a377c5400a613f2c9825aecfcc561c02d'
            '63d33cebcf2e905797bb2a93f421ba7c255bbe84918be8facd18c72b6099fe73'
            'b569191b37ef551cd688a690af7358559e41dfeb5604f8425571b0bbd762223f'
            'c1125bfdcc90a19b2ecb97b04218ef2892e3dccd3e02f4c5aec3bda377f6959d'
            '188caebbfd22554dda39797ce018aa0c134330e5626310716b2c9279d3654ccc'
            '561032a62a9ad7b327d0ffa056ed0eff0e048a617b27f689f9e535de56491bb4'
            '59ed11b50a6e209e80652a3b4d373a2d4a08f1e3fbdccc4407a589e759992cfa'
            '9a3ba52aa9271a'
            .upper()
        ),
    },
    {
        'id': 'SV-52196r3_rule',
        'keys': [
            r'HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\SystemCertificates\Disallowed\Certificates\7DA8E84296EE238818EE427287774508B26D094A',
            r'HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\EnterpriseCertificates\Disallowed\Certificates\7DA8E84296EE238818EE427287774508B26D094A',
            r'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\SystemCertificates\Disallowed\Certificates\7DA8E84296EE238818EE427287774508B26D094A',
            r'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\EnterpriseCertificates\Disallowed\Certificates\7DA8E84296EE238818EE427287774508B26D094A',
        ],
        'vdata': base64.b16decode(
            '0f0000000100000014000000511d2d92ef7908cf8157d5c16789db198db3c3a7'
            '0300000001000000140000007da8e84296ee238818ee427287774508b26d094a'
            '2000000001000000320500003082052e30820416a00302010202014e300d0609'
            '2a864886f70d01010505003074310b3009060355040613025553311830160603'
            '55040a130f552e532e20476f7665726e6d656e74310c300a060355040b130344'
            '6f44310c300a060355040b1303504b49312f302d06035504031326555320446f'
            '44204343454220496e7465726f7065726162696c69747920526f6f7420434120'
            '31301e170d3133303530313132353333315a170d313630353031313235333331'
            '5a305b310b300906035504061302555331183016060355040a130f552e532e20'
            '476f7665726e6d656e74310c300a060355040b1303446f44310c300a06035504'
            '0b1303504b49311630140603550403130d446f4420526f6f7420434120323082'
            '0122300d06092a864886f70d01010105000382010f003082010a0282010100c0'
            '2cc1f68d3bacff3f3cd671beb8742207ec704115fcab40e307aac1c3d89ffeda'
            '4c3abf3fc8d8287b4b3601c0ac4525c3d20e0a8f851864103d1a13702a6f8ed7'
            'dc8d93b3410f3821cdadabc23d2a05d35711370dcd8c51f993e3cc4649218e14'
            'b4cdcb143e38cd7231eeab12f265ea342e565dffee6375cb6dba9134fc9ef3f4'
            '2d1cbe50c442df5988ff6ab3faa86c3dcb5671710596bb9f80e58045596741b0'
            'ebc3ad60a4807506179c0ef443e0990e1bfb7ff5b3ccb28182b1fd32c1b8be41'
            'a464b5603a5a51308ccede412c19475c491064b974a98741af7d6ebac1b8a1bf'
            '65313a0467f9b5bb8e928a0063b8b1e68c385f83ff50d53ba25d6bb210cc6302'
            '03010001a38201e2308201de301f0603551d2304183016801497185fab7bb0ac'
            'e483b95063d5618b4c80014d21301d0603551d0e041604144974bb0c5eba7afe'
            '0254ef7ba0c695c609807096300e0603551d0f0101ff040403020106304a0603'
            '551d2004433041300b0609608648016502010b05300b0609608648016502010b'
            '09300b0609608648016502010b11300b0609608648016502010b12300b060960'
            '8648016502010b13300f0603551d130101ff040530030101ff300f0603551d24'
            '0101ff04053003800100304d0603551d1f044630443042a040a03e863c687474'
            '703a2f2f63726c2e646973612e6d696c2f63726c2f5553444f4443434542494e'
            '5445524f5045524142494c495459524f4f544341312e63726c30818206082b06'
            '01050507010104763074305006082b060105050730028644687474703a2f2f63'
            '726c2e646973612e6d696c2f697373756564746f2f5553444f4443434542494e'
            '5445524f5045524142494c495459524f4f544341315f49542e70376330200608'
            '2b060105050730018614687474703a2f2f6f6373702e646973612e6d696c304a'
            '06082b0601050507010b043e303c303a06082b06010505073005862e68747470'
            '3a2f2f63726c2e646973612e6d696c2f69737375656462792f444f44524f4f54'
            '4341325f49422e703763300d06092a864886f70d010105050003820101003496'
            'cea3da8213503c20cf8016dac3f6cf3f25c418388f1cf18aec0645eb9f305b1b'
            'be7f167ec66b7334d495b1102b832c18e8508752013df2187318203cd9654172'
            'ec9ad7ea05830f4e1aa3870393d2bd520870e940f29917b22f18c9f6a395c0a3'
            'd711888e783312fb4f0d5c05d469dcb72578e7f70e74a1e23a330aa343ab4397'
            'bc024ad4d2b9a03a8da1be0acbb905c4253523bba5621153faea9000672f057c'
            'dec103aa385016de75f148d975a37c653c92aedeee55d216ba755c5f2304276c'
            '8b9116f6f25820f95c007721ba8a9106920762b67587b0dc30be0bc2b3fe181a'
            '9528f7cd066ece81f65a566ad072f571a182762c2b4f0f84b39f9877818a'
            .upper()
        ),
    },
    {
        'id': 'SV-48308r2_rule',
        'keys': [
            r'HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\SystemCertificates\Root\Certificates\C313F919A6ED4E0E8451AFA930FB419A20F181E4',
            r'HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\EnterpriseCertificates\Root\Certificates\C313F919A6ED4E0E8451AFA930FB419A20F181E4',
            r'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\SystemCertificates\Root\Certificates\C313F919A6ED4E0E8451AFA930FB419A20F181E4',
            r'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\EnterpriseCertificates\Root\Certificates\C313F919A6ED4E0E8451AFA930FB419A20F181E4',
        ],
        'vdata': base64.b16decode(
            '190000000100000010000000e58952d37187ad771faa5ad3177a21de0f000000'
            '0100000014000000d224113ec1b44b8da2850f5428b931d092b7e87a03000000'
            '0100000014000000c313f919a6ed4e0e8451afa930fb419a20f181e414000000'
            '0100000014000000ede487d027c450e6843af7ccf7eb3a49fc524e2120000000'
            '010000003e0400003082043a30820322a003020102020105300d06092a864886'
            'f70d0101050500304d310b300906035504061302555331183016060355040a13'
            '0f552e532e20476f7665726e6d656e74310c300a060355040b13034543413116'
            '30140603550403130d45434120526f6f742043412032301e170d303830343034'
            '3134323434395a170d3238303333303134323434395a304d310b300906035504'
            '061302555331183016060355040a130f552e532e20476f7665726e6d656e7431'
            '0c300a060355040b1303454341311630140603550403130d45434120526f6f74'
            '204341203230820122300d06092a864886f70d01010105000382010f00308201'
            '0a0282010100b390d81eef9aed6e47b14661468da356089c4a32c745f2d2a4a4'
            '66be7e3d9780efe9d76be9e0c03b8de2f812fa1335a4cd5a868bb0d02f348cf7'
            '05ed876fa73017d016c65846bd95f9561a88d44e1e7e581f1ba273159d5e8b06'
            '2413763c9f6062adb0b5f4e024c153f7d91c371de63cf0fad3f1f9a198f13785'
            'd8cf0260f0a038944b512809c217fc40a461790eb48c1b208262f5e49ad6298a'
            '36fa1f81c0a111314bfe56fdd8bf51932759daf5833e44a4dfd52067eb9f00a7'
            'fbde31b663311c3df71c6c098d7ff4ba9ca87c1f01c6806d0101d837a8fe2d7d'
            '2bc2cbd6e99cba948d7616decc8175047b4177156515c9ac00b6bfeb1cdcb98d'
            '642dff35dbc50203010001a38201233082011f301d0603551d0e04160414ede4'
            '87d027c450e6843af7ccf7eb3a49fc524e21300e0603551d0f0101ff04040302'
            '0186300f0603551d130101ff040530030101ff3081dc06082b0601050507010b'
            '0481cf3081cc304306082b060105050730058637687474703a2f2f63726c2e67'
            '64732e646973612e6d696c2f67657449737375656442793f454341253230526f'
            '6f7425323043412532303230818406082b0601050507300586786c6461703a2f'
            '2f63726c2e6764732e646973612e6d696c2f636e253364454341253230526f6f'
            '742532304341253230322532636f752533644543412532636f253364552e532e'
            '253230476f7665726e6d656e742532636325336455533f63726f737343657274'
            '69666963617465506169723b62696e617279300d06092a864886f70d01010505'
            '0003820101004acc1be785889323d9b9becfbaf13594c14b3c13705d832e4e7e'
            'c1560f2dc17e1f0de9ddfe02997c60e386aab98623c3177ec7110fe3d04256a3'
            '1cf3708fb18891b5bc0e892566c83f5f362a0e3eb667408c3d40dfa762e03818'
            'fa246d2d23d3c0b8745e9544547a21970f5acdc3fc953d222215dd18605d8537'
            'a94df781fcbd4aa6588c4fbfc765a1ffe2d334481a170132f284f3de05b26449'
            '9837cd21f5a8815b64c5da7c58b061611fadc0aded34b694abc79cec65972985'
            '949433c435248b3dcdfc372abbfaa4b61b90f295571748e0efa99dad00e2b164'
            'd967791183b99ae80b3236ce2067e37a6d4bea5e53e52f3041ddf8e5549da9d7'
            '69c675d94547'
            .upper()
        ),
    },
]

def run():
    config = {}
    for cert in CERTS:
        for index,key in enumerate(cert['keys']):
            config['{0}_{1}'.format(cert['id'],index)] = {
                'reg.present' : [
                    { 'name': key },
                    { 'vname': 'Blob' },
                    { 'vdata': cert['vdata'] },
                    { 'vtype': 'REG_BINARY' },
                ],
            }
    return config
