language: python
sudo: false
python:
    - 2.6
    - 2.7
    - 3.5
install:
    # Install old (pytest-)flake8 for py26
  - "[ ${TRAVIS_PYTHON_VERSION:0:3} == 2.6 ] && pip install pytest-flake8==0.5 flake8==2.6.2 || :"
    # https://github.com/release-engineering/kobo/issues/31
  - "[ ${TRAVIS_PYTHON_VERSION:0:1} == 3 ] && pip install git+git://github.com/release-engineering/kobo.git@python-3-dev || :"
    # We have to upgrade pytest explicitly here due to the following:
    # * Travis CI's virtualenv already comes with pytest preinstalled.
    # * pytest-flake8 requires pytest>=2.8, and sometimes this requirement is
    #   higher than what Travis CI has pre-installed into the virtualenv.
    # * 'python setup.py test' uses EasyInstall, so it will not upgrade a
    #   package to a newer version if the package is already present in a
    #   virtualenv.
  - pip install pytest-flake8
script:
  - python setup.py test
cache: pip
