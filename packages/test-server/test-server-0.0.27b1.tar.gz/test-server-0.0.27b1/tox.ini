[tox]
envlist = py2,py3,py2-engine-subprocess,py3-engine-subprocess,qa

[testenv]
commands =
    python setup.py check -s
    pytest --cov test_server \
    engine-thread: --engine=thread \
    engine-subprocess: --engine=subprocess \
    --tb=short {posargs}
deps =
    -rrequirements_dev.txt

[testenv:py3-bug]
commands=pytest -m bug --tb=short {posargs}

[testenv:py-appveyor]
passenv = DISTUTILS_USE_SDK MSSdk INCLUDE LIB
commands =
    pytest {posargs}

[testenv:pylint-all]
commands = pylint test_server test --enable=all --disable=missing-docstring,locally-disabled,locally-enabled,suppressed-message {posargs}

[testenv:qa]
commands =
    flake8 setup.py useragent test
    pylint setup test_server test

[testenv:pylint-debug]
commands = pylint {posargs}

[testenv:doc]
whitelist_externals=make
basepython=python3
changedir = docs
commands =
    make html
deps = sphinx
