import unittest
import os
import numpy as np
from .. import prop, sirifc

class TestProp(unittest.TestCase):

    def setUp(self):
        n, e = os.path.splitext(__file__)
        tmpdir = n + ".d"
        self.propfile = os.path.join(tmpdir, 'AOPROPER')
        self.ifcfile = os.path.join(tmpdir, 'SIRIFC')

    def test_zdiplen(self):
        zdip_ref = [
               0.05500804,
               0.01366193, 0.05500804,
               0.00000000, 0.00000000, 0.05500804,
               0.00000000, 0.00000000, 0.00000000, 0.05500804,
               0.07185549, 0.83874358, 0.00000000, 0.00000000, 0.05500804,
               0.00000001,-0.00059808, 0.00005388,-0.00094623, 0.00163262,-0.01842483,
               0.00179677, 0.00353354,-0.00036655, 0.00643692, 0.21224246,-0.00436123,-0.01842483,
               0.00016727, 0.00014520, 0.00245884, 0.00038401, 0.01127809,-0.00000000,-0.00000000,-0.01842483,
              -0.00293742,-0.00254987, 0.00038401,-0.00426291,-0.19805411, 0.00000000,-0.00000000, 0.00000000,-0.01842483,
               0.00299893, 0.24772917,-0.01623694, 0.28513619,-0.00031653, 0.05079193, 0.64117284, 0.00000000, 0.00000000,-0.01842483,
               0.00352248, 0.03871634, 0.03230011,-0.01749595, 0.34975204,-0.00007638, 0.00161763, 0.00097255,-0.00162423, 0.05058192, 0.10251953,
               0.00339260, 0.03187821,-0.02532613,-0.01683544, 0.34769670,-0.00008089, 0.00099743,-0.00050214,-0.00107283, 0.05161612, 0.01273269, 0.07612195 
                ]
        z, = prop.read('ZDIPLEN', filename=self.propfile, unpack=False)
        np.testing.assert_almost_equal(z, zdip_ref)

if __name__ == "__main__":
    unittest.main()


