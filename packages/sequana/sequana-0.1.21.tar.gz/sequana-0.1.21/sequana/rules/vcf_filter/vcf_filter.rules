rule vcf_filter:
    """ It filters VCF file from freebayes with score, coverage depth and strand
    ratio.

    Required input:
        __vcf_filter__input: VCF file from freebayes

    Required output:
        __bedtools_genomecov__output: bed file

    Required parameters:
        config["vcf_filter"]["freebayes_score"]: minimal freebayes score
        config["vcf_filter"]["frequency"]: minimal alternative allele frequency
        config["vcf_filter"]["depth"]: minimal coverage depth
        config["vcf_filter"]["forward_depth"]: minimal coverage depth of forward strand
        config["vcf_filter"]["reverse_depth"]: minimal coverage depth of reverse strand
        config["vcf_filter"]["strand_ratio"]: minimal strand ratio [0:0.5]

    """
    input:
        vcf = __vcf_filter__input
    output:
        vcf = __vcf_filter__output
    params:
        filter_dict = config["vcf_filter"]
    run:
        from sequana import vcf_filter
        
        vcf_record = vcf_filter.VCF(input["vcf"])
        vcf_record.filter_vcf(params["filter_dict"], output["vcf"])
