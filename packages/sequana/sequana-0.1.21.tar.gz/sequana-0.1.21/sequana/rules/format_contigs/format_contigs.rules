rule format_contigs:
    """ Change names of contigs to have sample name and filter reads shorter 
    than a threshold.

    Required input:
        __format_contigs__input: fasta file

    Required output:
        __format_contigs__output: fasta file

    Required parameter:
        config["format_contigs"]["length_min"]: length treshold

    Contributors:
        Sequana consortium
    """
    input:
        contigs = __format_contigs__input
    output:
        contigs = __format_contigs__output
    params:
        length_min = config["format_contigs"]["length_min"]
    run:
        from sequana import FastA

        contigs = FastA(input.contigs)
        contigs.format_contigs_denovo(output_file=output.contigs,
            len_min=params.length_min)
