'use strict';var $jscomp={scope:{},getGlobal:function(r){return"undefined"!=typeof window&&window===r?r:"undefined"!=typeof global?global:r}};$jscomp.global=$jscomp.getGlobal(this);$jscomp.patches={};$jscomp.patch=function(r,B){($jscomp.patches[r]=$jscomp.patches[r]||[]).push(B);var D=$jscomp.global;r=r.split(".");for(var F=0;F<r.length-1&&D;F++)D=D[r[F]];r=r[r.length-1];D&&D[r]instanceof Function&&(D[r]=B(D[r]))};$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};if(!$jscomp.global.Symbol){$jscomp.global.Symbol=$jscomp.Symbol;var r=[],B=function(D){return function(F){r=[];F=D(F);for(var B=[],L=0,H=F.length;L<H;L++){var u;a:if(u=F[L],u.length<$jscomp.SYMBOL_PREFIX.length)u=!1;else{for(var G=0;G<$jscomp.SYMBOL_PREFIX.length;G++)if(u[G]!=$jscomp.SYMBOL_PREFIX[G]){u=!1;break a}u=!0}u?r.push(F[L]):B.push(F[L])}return B}};$jscomp.patch("Object.keys",B);$jscomp.patch("Object.getOwnPropertyNames",B);$jscomp.patch("Object.getOwnPropertySymbols",
function(D){return function(F){B.unused=Object.getOwnPropertyNames(F);r.push.apply(D(F));return r}})}};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(r){return $jscomp.SYMBOL_PREFIX+r+$jscomp.symbolCounter_++};$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();$jscomp.global.Symbol.iterator||($jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));$jscomp.initSymbolIterator=function(){}};
$jscomp.makeIterator=function(r){$jscomp.initSymbolIterator();$jscomp.initSymbol();$jscomp.initSymbolIterator();var B=r[Symbol.iterator];if(B)return B.call(r);var D=0;return{next:function(){return D<r.length?{done:!1,value:r[D++]}:{done:!0}}}};
function pong(){function r(b){return 0<=["boolean","number"].indexOf(typeof b)||b instanceof Function||P(b)?b:!1}function B(b){this.iterable=b;this.index=0}function D(b){this.iterable=b;this.index=0}function F(b,a,k){void 0==a&&(a=b,b=0);void 0==k&&(k=1);if(0<k&&b>=a||0>k&&b<=a)return[];for(var n=[];0<k?b<a:b>a;b+=k)n.push(b);return n}function ca(b){if(null==b||"object"==typeof b)return b;var a={},k;for(k in obj)b.hasOwnProperty(k)&&(a[k]=b[k]);return a}function L(b){if(null==b||"object"==typeof b)return b;
var a={},k;for(k in obj)b.hasOwnProperty(k)&&(a[k]=L(b[k]));return a}function H(b){return b?Array.from(b):[]}function u(b){b=b?[].slice.apply(b):[];b.__class__=u;return b}function G(b){var a=[];if(b)for(var k=0;k<b.length;k++)a.add(b[k]);a.__class__=G;return a}function K(b){try{return b.__str__()}catch(a){try{return U(b)}catch(k){return String(b)}}}function ha(){var b=[],a;for(a in this)V(a)||b.push(a);return b}function ia(){var b=[],a;for(a in this)V(a)||b.push([a,this[a]]);return b}function ja(b){delete this[b]}
function ka(){for(var b in this)delete this[b]}function la(b,a){b=this[b];return void 0==b?void 0==a?null:a:b}function ma(b,a){var k=this[b];if(void 0!=k)return k;a=void 0==a?null:a;return this[b]=a}function na(b,a){var k=this[b];if(void 0!=k)return delete this[b],k;if(void 0===a)throw da(b,Error());return a}function oa(){var b=Object.keys(this)[0];if(null==b)throw da(b,Error());var a=u([b,this[b]]);delete this[b];return a}function pa(b){for(var a in b)this[a]=b[a]}function qa(b){return this[b]}function ra(b,
a){this[b]=a}function y(b){var a={};if(!b||b instanceof Array){if(b)for(var k=0;k<b.length;k++){var n=b[k];if(!(n instanceof Array)||2!=n.length)throw ea("dict update sequence element #"+k+" has length "+n.length+"; 2 is required",Error());var p=n[0],n=n[1];!(b instanceof Array)&&b instanceof Object&&(W(b,y)||(n=y(n)));a[p]=n}}else if(W(b,y))for(n=b.py_keys(),k=0;k<n.length;k++)p=n[k],a[p]=b[p];else if(b instanceof Object)a=b;else throw ea("Invalid type of object for dict creation",Error());E(a,"__class__",
{value:y,enumerable:!1,writable:!0});E(a,"py_keys",{value:ha,enumerable:!1});E(a,"__iter__",{value:function(){new B(this.py_keys())},enumerable:!1});$jscomp.initSymbol();$jscomp.initSymbolIterator();E(a,Symbol.iterator,{value:function(){new D(this.py_keys())},enumerable:!1});E(a,"py_items",{value:ia,enumerable:!1});E(a,"py_del",{value:ja,enumerable:!1});E(a,"py_clear",{value:ka,enumerable:!1});E(a,"py_get",{value:la,enumerable:!1});E(a,"py_setdefault",{value:ma,enumerable:!1});E(a,"py_pop",{value:na,
enumerable:!1});E(a,"py_popitem",{value:oa,enumerable:!1});E(a,"py_update",{value:pa,enumerable:!1});E(a,"__getitem__",{value:qa,enumerable:!1});E(a,"__setitem__",{value:ra,enumerable:!1});return a}var m={},Q=function(b,a,k){if(""!=a){a=a.split(".");for(var n=a.length,p=0;p<a.length;p++){if(!b.hasOwnProperty(a[p])){n=p;break}b=b[a[p]]}for(p=n;p<a.length;p++)b[a[p]]={},b=b[a[p]]}for(var l in k)b[l]=k[l]};m.__nest__=Q;var X=function(b){b.__inited__||(b.__all__.__init__(b.__all__),b.__inited__=!0);return b.__all__};
m.__init__=X;var q=function(b,a,k){return b&&(b.hasOwnProperty("__class__")||"string"==typeof b||b instanceof String)?(k&&Object.defineProperty(b,k,{value:function(){var n=[].slice.apply(arguments);return a.apply(null,[b].concat(n))},writable:!0,enumerable:!0,configurable:!0}),function(){var n=[].slice.apply(arguments);return a.apply(null,[b].concat(n))}):a};m.__get__=q;var M={__name__:"type",__bases__:[],__new__:function(b,a,k,n){for(var p=function(){var d=[].slice.apply(arguments);return p.__new__(d)},
l=k.length-1;0<=l;l--){var h=k[l],g;for(g in h){var c=Object.getOwnPropertyDescriptor(h,g);Object.defineProperty(p,g,c)}for(var e=$jscomp.makeIterator(Object.getOwnPropertySymbols(h)),c=e.next();!c.done;c=e.next()){var f=c.value,c=Object.getOwnPropertyDescriptor(h,f);Object.defineProperty(p,f,c)}}p.__metaclass__=b;p.__name__=a;p.__bases__=k;for(g in n)c=Object.getOwnPropertyDescriptor(n,g),Object.defineProperty(p,g,c);b=$jscomp.makeIterator(Object.getOwnPropertySymbols(n));for(c=b.next();!c.done;c=
b.next())f=c.value,c=Object.getOwnPropertyDescriptor(n,f),Object.defineProperty(p,f,c);return p}};M.__metaclass__=M;m.py_metatype=M;var R={__init__:function(b){},__metaclass__:M,__name__:"object",__bases__:[],__new__:function(b){var a=Object.create(this,{__class__:{value:this,enumerable:!0}});if("__getattr__"in this||"__setattr__"in this)a=new Proxy(a,{get:function(b,a){var p=b[a];return void 0==p?b.__getattr__(a):p},set:function(b,a,p){try{b.__setattr__(a,p)}catch(l){b[a]=p}return!0}});this.__init__.apply(null,
[a].concat(b));return a}};m.object=R;var v=function(b,a,k,n){void 0==n&&(n=a[0].__metaclass__);return n.__new__(n,b,a,k)};m.__class__=v;m.__pragma__=function(){};Q(m,"org.transcrypt.__base__",{__all__:{__inited__:!1,__init__:function(b){var a=v("__Envir__",[R],{get __init__(){return q(this,function(b){b.interpreter_name="python";b.transpiler_name="transcrypt";b.transpiler_version="3.6.22";b.target_subdir="__javascript__"})}}),k=a();b.__Envir__=a;b.__envir__=k}}});Q(m,"org.transcrypt.__standard__",
{__all__:{__inited__:!1,__init__:function(b){var a=v("Exception",[R],{get __init__(){return q(this,function(d){var f=y();if(arguments.length){var c=arguments.length-1;if(arguments[c]&&arguments[c].hasOwnProperty("__kwargtrans__")){var e=arguments[c--],b;for(b in e)switch(b){case "self":d=e[b];break;default:f[b]=e[b]}delete f.__kwargtrans__}c=u([].slice.apply(arguments).slice(1,c+1))}else c=u();d.__args__=c;try{d.stack=f.error.stack}catch(g){d.stack="No stack trace available"}})},get __repr__(){return q(this,
function(d){return P(d.__args__)?"{}{}".format(d.__class__.__name__,U(u(d.__args__))):"{}()".format(d.__class__.__name__)})},get __str__(){return q(this,function(d){return 1<P(d.__args__)?K(u(d.__args__)):P(d.__args__)?K(d.__args__[0]):""})}}),k=v("IterableError",[a],{get __init__(){return q(this,function(d,f){a.__init__(d,"Can't iterate over non-iterable",I({error:f}))})}}),n=v("StopIteration",[a],{get __init__(){return q(this,function(d,f){a.__init__(d,"Iterator exhausted",I({error:f}))})}}),p=
v("ValueError",[a],{get __init__(){return q(this,function(d,f){a.__init__(d,"Erroneous value",I({error:f}))})}}),l=v("KeyError",[a],{get __init__(){return q(this,function(d,f){a.__init__(d,"Invalid key",I({error:f}))})}}),h=v("AssertionError",[a],{get __init__(){return q(this,function(d,f,c){f?a.__init__(d,f,I({error:c})):a.__init__(d,I({error:c}))})}}),g=v("NotImplementedError",[a],{get __init__(){return q(this,function(d,f,c){a.__init__(d,f,I({error:c}))})}}),c=v("IndexError",[a],{get __init__(){return q(this,
function(d,f,c){a.__init__(d,f,I({error:c}))})}}),e=v("AttributeError",[a],{get __init__(){return q(this,function(d,f,c){a.__init__(d,f,I({error:c}))})}}),f=v("Warning",[a],{}),d=v("UserWarning",[f],{}),t=v("DeprecationWarning",[f],{}),z=v("RuntimeWarning",[f],{}),A=function(d,f,c){if("undefined"==typeof f||null!=f&&f.hasOwnProperty("__kwargtrans__"))f=null;if("undefined"==typeof c||null!=c&&c.hasOwnProperty("__kwargtrans__"))c=!1;if(arguments.length){var e=arguments.length-1;if(arguments[e]&&arguments[e].hasOwnProperty("__kwargtrans__")){var e=
arguments[e--],b;for(b in e)switch(b){case "iterable":d=e[b];break;case "key":f=e[b];break;case "reverse":c=e[b]}}}f?d.sort(function(d,c){if(arguments.length){var e=arguments.length-1;if(arguments[e]&&arguments[e].hasOwnProperty("__kwargtrans__")){var e=arguments[e--],b;for(b in e)switch(b){case "a":d=e[b];break;case "b":c=e[b]}}}return f(d)>f(c)?1:-1}):d.sort();c&&d.reverse()},O=v("__Terminal__",[R],{get __init__(){return q(this,function(d){d.buffer="";try{d.element=document.getElementById("__terminal__")}catch(f){d.element=
null}d.element&&(d.element.style.overflowX="auto",d.element.style.boxSizing="border-box",d.element.style.padding="5px",d.element.innerHTML="_")})},get print(){return q(this,function(d){var f=" ",c="\n";if(arguments.length){var e=arguments.length-1;if(arguments[e]&&arguments[e].hasOwnProperty("__kwargtrans__")){var b=arguments[e--],g;for(g in b)switch(g){case "self":d=b[g];break;case "sep":f=b[g];break;case "end":c=b[g]}}var l=u([].slice.apply(arguments).slice(1,e+1))}else l=u();d.buffer="{}{}{}".format(d.buffer,
f.join(function(){for(var d=[],f=$jscomp.makeIterator(l),c=f.next();!c.done;c=f.next())d.append(K(c.value));return d}()),c).__getslice__(-4096,null,1);d.element?(d.element.innerHTML=d.buffer.py_replace("\n","<br>"),d.element.scrollTop=d.element.scrollHeight):console.log(f.join(function(){for(var d=[],f=$jscomp.makeIterator(l),c=f.next();!c.done;c=f.next())d.append(K(c.value));return d}()))})},get input(){return q(this,function(d,f){if(arguments.length){var c=arguments.length-1;if(arguments[c]&&arguments[c].hasOwnProperty("__kwargtrans__")){var c=
arguments[c--],e;for(e in c)switch(e){case "self":d=c[e];break;case "question":f=c[e]}}}d.print("{}".format(f),I({end:""}));e=window.prompt("\n".join(d.buffer.py_split("\n").__getslice__(-16,null,1)));d.print(e);return e})}}),ta=O();b.AssertionError=h;b.AttributeError=e;b.DeprecationWarning=t;b.Exception=a;b.IndexError=c;b.IterableError=k;b.KeyError=l;b.NotImplementedError=g;b.RuntimeWarning=z;b.StopIteration=n;b.UserWarning=d;b.ValueError=p;b.Warning=f;b.__Terminal__=O;b.__sort__=A;b.__terminal__=
ta;b.filter=function(d,f){var c=[];f=$jscomp.makeIterator(f);for(var e=f.next();!e.done;e=f.next())e=e.value,d(e)&&c.append(e);return c};b.map=function(d,f){var c=[];f=$jscomp.makeIterator(f);for(var e=f.next();!e.done;e=f.next())c.append(d(e.value));return c};b.sorted=function(d,f,c){if("undefined"==typeof f||null!=f&&f.hasOwnProperty("__kwargtrans__"))f=null;if("undefined"==typeof c||null!=c&&c.hasOwnProperty("__kwargtrans__"))c=!1;if(arguments.length){var e=arguments.length-1;if(arguments[e]&&
arguments[e].hasOwnProperty("__kwargtrans__")){var e=arguments[e--],b;for(b in e)switch(b){case "iterable":d=e[b];break;case "key":f=e[b];break;case "reverse":c=e[b]}}}b=Y(d)==y?ca(d.py_keys()):ca(d);A(b,f,c);return b}}}});m.__call__=function(){var b=[].slice.apply(arguments);return"object"==typeof b[0]&&"__call__"in b[0]?b[0].__call__.apply(b[1],b.slice(2)):b[0].apply(b[1],b.slice(2))};Q(m,"",X(m.org.transcrypt.__base__));M=m.__envir__;Q(m,"",X(m.org.transcrypt.__standard__));var ua=m.Exception,
va=m.StopIteration,ea=m.ValueError,da=m.KeyError,wa=m.AssertionError,xa=m.__sort__;m.print=m.__terminal__.print;m.input=m.__terminal__.input;M.executor_name=M.transpiler_name;m.main={__file__:""};m.__except__=null;var I=function(b){b.__kwargtrans__=null;b.constructor=Object;return b};m.__kwargtrans__=I;m.__globals__=function(b){return W(b,y)?b:y(b)};m.__super__=function(b,a){b=$jscomp.makeIterator(b.__bases__);for(var k=b.next();!k.done;k=b.next())if(k=k.value,a in k)return k[a];throw new ua("Superclass method not found");
};m.property=function(b,a){a||(a=function(){});return{get:function(){return b(this)},set:function(b){a(this,b)},enumerable:!0}};var E=function(b,a,k){b.hasOwnProperty(a)||Object.defineProperty(b,a,k)};m.__setProperty__=E;m.assert=function(b,a){if(!b)throw wa(a,Error());};m.__merge__=function(b,a){var k={},n;for(n in b)k[n]=b[n];for(n in a)k[n]=a[n];return k};m.dir=function(b){var a=[],k;for(k in b)a.push(k);a.sort();return a};m.setattr=function(b,a,k){b[a]=k};m.getattr=function(b,a){return b[a]};
m.hasattr=function(b,a){return a in b};m.delattr=function(b,a){delete b[a]};m.__in__=function(b,a){return Y(a)==y?a.hasOwnProperty(b):a.indexOf?-1<a.indexOf(b):a.hasOwnProperty(b)};var V=function(b){return b.startswith("__")&&b.endswith("__")||"constructor"==b||b.startswith("py_")};m.__specialattrib__=V;var P=function(b){if(b){var a=b.length;if(void 0==a){var a=0,k;for(k in b)V(k)||a++}return a}return 0};m.len=P;m.__t__=r;var S=function(b){return!!r(b)};S.__name__="bool";m.bool=S;var Z=function(b){if("inf"==
b)return Infinity;if("-inf"==b)return-Infinity;if(isNaN(b))throw ea(Error());return+b};Z.__name__="float";m.float=Z;var aa=function(b){return Z(b)|0};aa.__name__="int";m.int=aa;var Y=function(b){var a=typeof b;if("object"==a)try{return b.__class__}catch(k){return a}else return"boolean"==a?S:"string"==a?K:"number"==a?0==b%1?aa:Z:null};m.py_typeof=Y;var W=function(b,a){function k(b){if(b==a)return!0;for(var h=0;h<b.__bases__.length;h++)if(k(b.__bases__[h],a))return!0;return!1}if(a instanceof Array){for(var n=
$jscomp.makeIterator(a),p=n.next();!p.done;p=n.next())if(W(b,p.value))return!0;return!1}try{return"__class__"in b?k(b.__class__):b instanceof a}catch(l){return b=Y(b),b==a||b==S&&a==aa}};m.isinstance=W;m.callable=function(b){return"object"==typeof b&&"__call__"in b?!0:"function"===typeof b};var U=function(b){try{return b.__repr__()}catch(l){try{return b.__str__()}catch(h){try{if(null==b)return"None";if(b.constructor==Object){var a="{",k=!1,n;for(n in b)if(!V(n)){var p=n.isnumeric()?n:"'"+n+"'";k?
a+=", ":k=!0;a+=p+": "+U(b[n])}return a+"}"}return"boolean"==typeof b?b.toString().capitalize():b.toString()}catch(g){return console.log("ERROR: Could not evaluate repr (<object of type "+typeof b+">)"),console.log(g),"???"}}}};m.repr=U;m.chr=function(b){return String.fromCharCode(b)};var T=function(b){return b.charCodeAt(0)};m.org=T;m.max=Math.max;m.min=Math.min;m.abs=Math.abs;m.round=function(b,a){if(a){var k=Math.pow(10,a);b*=k}var n=Math.round(b);.5==n-b&&n%2&&--n;a&&(n/=k);return n};B.prototype.__next__=
function(){if(this.index<this.iterable.length)return this.iterable[this.index++];throw va(Error());};D.prototype.next=function(){return this.index<this.iterable.py_keys.length?{value:this.index++,done:!1}:{value:void 0,done:!0}};m.py_reversed=function(b){b=b.slice();b.reverse();return b};var ba=function(){var b=[].slice.call(arguments);if("string"==typeof b[0])for(var a=0;a<b.length;a++)b[a]=b[a].split("");return(0==b.length?[]:b.reduce(function(b,a){return b.length<a.length?b:a})).map(function(a,
n){return b.map(function(b){return b[n]})})};m.zip=ba;m.range=F;m.any=function(b){b=$jscomp.makeIterator(b);for(var a=b.next();!a.done;a=b.next())if(S(a.value))return!0;return!1};m.all=function(b){b=$jscomp.makeIterator(b);for(var a=b.next();!a.done;a=b.next())if(!S(a.value))return!1;return!0};m.sum=function(b){var a=0;b=$jscomp.makeIterator(b);for(var k=b.next();!k.done;k=b.next())a+=k.value;return a};m.enumerate=function(b){return ba(F(P(b)),b)};m.copy=ca;m.deepcopy=L;m.list=H;Array.prototype.__class__=
H;H.__name__="list";Array.prototype.__iter__=function(){return new B(this)};Array.prototype.__getslice__=function(b,a,k){0>b&&(b=this.length+b);null==a?a=this.length:0>a?a=this.length+a:a>this.length&&(a=this.length);for(var n=H([]);b<a;b+=k)n.push(this[b]);return n};Array.prototype.__setslice__=function(b,a,k,n){0>b&&(b=this.length+b);null==a?a=this.length:0>a&&(a=this.length+a);if(null==k)Array.prototype.splice.apply(this,[b,a-b].concat(n));else for(var p=0;b<a;b+=k)this[b]=n[p++]};Array.prototype.__repr__=
function(){if(this.__class__==G&&!this.length)return"set()";for(var b=this.__class__&&this.__class__!=H?this.__class__==u?"(":"{":"[",a=0;a<this.length;a++)a&&(b+=", "),b+=U(this[a]);this.__class__==u&&1==this.length&&(b+=",");return b+=this.__class__&&this.__class__!=H?this.__class__==u?")":"}":"]"};Array.prototype.__str__=Array.prototype.__repr__;Array.prototype.append=function(b){this.push(b)};Array.prototype.clear=function(){this.length=0};Array.prototype.extend=function(b){this.push.apply(this,
b)};Array.prototype.insert=function(b,a){this.splice(b,0,a)};Array.prototype.remove=function(b){b=this.indexOf(b);if(-1==b)throw da(Error());this.splice(b,1)};Array.prototype.index=function(b){return this.indexOf(b)};Array.prototype.py_pop=function(b){return void 0==b?this.pop():this.splice(b,1)[0]};Array.prototype.py_sort=function(){xa.apply(null,[this].concat([].slice.apply(arguments)))};Array.prototype.__add__=function(b){return H(this.concat(b))};Array.prototype.__mul__=function(b){for(var a=
this,k=1;k<b;k++)a=a.concat(this);return a};Array.prototype.__rmul__=Array.prototype.__mul__;m.tuple=u;u.__name__="tuple";m.set=G;G.__name__="set";Array.prototype.__bindexOf__=function(b){b+="";for(var a=0,k=this.length-1;a<=k;){var n=(a+k)/2|0,p=this[n]+"";if(p<b)a=n+1;else if(p>b)k=n-1;else return n}return-1};Array.prototype.add=function(b){-1==this.indexOf(b)&&this.push(b)};Array.prototype.discard=function(b){b=this.indexOf(b);-1!=b&&this.splice(b,1)};Array.prototype.isdisjoint=function(b){this.sort();
for(var a=0;a<b.length;a++)if(-1!=this.__bindexOf__(b[a]))return!1;return!0};Array.prototype.issuperset=function(b){this.sort();for(var a=0;a<b.length;a++)if(-1==this.__bindexOf__(b[a]))return!1;return!0};Array.prototype.issubset=function(b){return G(b.slice()).issuperset(this)};Array.prototype.union=function(b){for(var a=G(this.slice().sort()),k=0;k<b.length;k++)-1==a.__bindexOf__(b[k])&&a.push(b[k]);return a};Array.prototype.intersection=function(b){this.sort();for(var a=G(),k=0;k<b.length;k++)-1!=
this.__bindexOf__(b[k])&&a.push(b[k]);return a};Array.prototype.difference=function(b){b=G(b.slice().sort());for(var a=G(),k=0;k<this.length;k++)-1==b.__bindexOf__(this[k])&&a.push(this[k]);return a};Array.prototype.symmetric_difference=function(b){return this.union(b).difference(this.intersection(b))};Array.prototype.py_update=function(){var b=[].concat.apply(this.slice(),arguments).sort();this.clear();for(var a=0;a<b.length;a++)b[a]!=b[a-1]&&this.push(b[a])};Array.prototype.__eq__=function(b){if(this.length!=
b.length)return!1;this.__class__==G&&(this.sort(),b.sort());for(var a=0;a<this.length;a++)if(this[a]!=b[a])return!1;return!0};Array.prototype.__ne__=function(b){return!this.__eq__(b)};Array.prototype.__le__=function(b){return this.issubset(b)};Array.prototype.__ge__=function(b){return this.issuperset(b)};Array.prototype.__lt__=function(b){return this.issubset(b)&&!this.issuperset(b)};Array.prototype.__gt__=function(b){return this.issuperset(b)&&!this.issubset(b)};m.str=K;String.prototype.__class__=
K;K.__name__="str";String.prototype.__iter__=function(){new B(this)};String.prototype.__repr__=function(){return(-1==this.indexOf("'")?"'"+this+"'":'"'+this+'"').py_replace("\t","\\t").py_replace("\n","\\n")};String.prototype.__str__=function(){return this};String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)};String.prototype.endswith=function(b){return""==b||this.slice(-b.length)==b};String.prototype.find=function(b,a){return this.indexOf(b,a)};String.prototype.__getslice__=
function(b,a,k){0>b&&(b=this.length+b);null==a?a=this.length:0>a&&(a=this.length+a);var n="";if(1==k)n=this.substring(b,a);else for(;b<a;b+=k)n=n.concat(this.charAt(b));return n};E(String.prototype,"format",{get:function(){return q(this,function(b){var a=u([].slice.apply(arguments).slice(1)),k=0;return b.replace(/\{(\w*)\}/g,function(b,p){""==p&&(p=k++);if(p==+p)return void 0==a[p]?b:K(a[p]);for(var l=0;l<a.length;l++)if("object"==typeof a[l]&&void 0!=a[l][p])return K(a[l][p]);return b})})},enumerable:!0});
String.prototype.isnumeric=function(){return!isNaN(parseFloat(this))&&isFinite(this)};String.prototype.join=function(b){b=Array.from(b);return b.join(this)};String.prototype.lower=function(){return this.toLowerCase()};String.prototype.py_replace=function(b,a,k){return this.split(b,k).join(a)};String.prototype.lstrip=function(){return this.replace(/^\s*/g,"")};String.prototype.rfind=function(b,a){return this.lastIndexOf(b,a)};String.prototype.rsplit=function(b,a){if(void 0==b||null==b){b=/\s+/;var k=
this.strip()}else k=this;if(void 0==a||-1==a)return k.split(b);k=k.split(b);return a<k.length?(a=k.length-a,[k.slice(0,a).join(b)].concat(k.slice(a))):k};String.prototype.rstrip=function(){return this.replace(/\s*$/g,"")};String.prototype.py_split=function(b,a){if(void 0==b||null==b){b=/\s+/;var k=this.strip()}else k=this;if(void 0==a||-1==a)return k.split(b);k=k.split(b);return a<k.length?k.slice(0,a).concat([k.slice(a).join(b)]):k};String.prototype.startswith=function(b){return 0==this.indexOf(b)};
String.prototype.strip=function(){return this.trim()};String.prototype.upper=function(){return this.toUpperCase()};String.prototype.__mul__=function(b){for(var a=this,k=1;k<b;k++)a+=this;return a};String.prototype.__rmul__=String.prototype.__mul__;m.dict=y;y.__name__="dict";E(Function.prototype,"__setdoc__",{value:function(b){this.__doc__=b;return this},enumerable:!1});m.__neg__=function(b){return"object"==typeof b&&"__neg__"in b?b.__neg__():-b};m.__matmul__=function(b,a){return b.__matmul__(a)};
m.pow=function(b,a){return"object"==typeof b&&"__pow__"in b?b.__pow__(a):"object"==typeof a&&"__rpow__"in a?a.__rpow__(b):Math.pow(b,a)};m.__jsmod__=function(b,a){return"object"==typeof b&&"__mod__"in b?b.__mod__(a):"object"==typeof a&&"__rpow__"in a?a.__rmod__(b):b%a};m.mod=function(b,a){return"object"==typeof b&&"__mod__"in b?b.__mod__(a):"object"==typeof a&&"__rpow__"in a?a.__rmod__(b):(b%a+a)%a};m.__mul__=function(b,a){return"object"==typeof b&&"__mul__"in b?b.__mul__(a):"object"==typeof a&&"__rmul__"in
a?a.__rmul__(b):"string"==typeof b?b.__mul__(a):"string"==typeof a?a.__rmul__(b):b*a};m.__div__=function(b,a){return"object"==typeof b&&"__div__"in b?b.__div__(a):"object"==typeof a&&"__rdiv__"in a?a.__rdiv__(b):b/a};m.__add__=function(b,a){return"object"==typeof b&&"__add__"in b?b.__add__(a):"object"==typeof a&&"__radd__"in a?a.__radd__(b):b+a};m.__sub__=function(b,a){return"object"==typeof b&&"__sub__"in b?b.__sub__(a):"object"==typeof a&&"__rsub__"in a?a.__rsub__(b):b-a};m.__lshift__=function(b,
a){return"object"==typeof b&&"__lshift__"in b?b.__lshift__(a):"object"==typeof a&&"__rlshift__"in a?a.__rlshift__(b):b<<a};m.__rshift__=function(b,a){return"object"==typeof b&&"__rshift__"in b?b.__rshift__(a):"object"==typeof a&&"__rrshift__"in a?a.__rrshift__(b):b>>a};m.__or__=function(b,a){return"object"==typeof b&&"__or__"in b?b.__or__(a):"object"==typeof a&&"__ror__"in a?a.__ror__(b):b|a};m.__xor__=function(b,a){return"object"==typeof b&&"__xor__"in b?b.__xor__(a):"object"==typeof a&&"__rxor__"in
a?a.__rxor__(b):b^a};m.__and__=function(b,a){return"object"==typeof b&&"__and__"in b?b.__and__(a):"object"==typeof a&&"__rand__"in a?a.__rand__(b):b&a};m.__eq__=function(b,a){return"object"==typeof b&&"__eq__"in b?b.__eq__(a):b==a};m.__ne__=function(b,a){return"object"==typeof b&&"__ne__"in b?b.__ne__(a):b!=a};m.__lt__=function(b,a){return"object"==typeof b&&"__lt__"in b?b.__lt__(a):b<a};m.__le__=function(b,a){return"object"==typeof b&&"__le__"in b?b.__le__(a):b<=a};m.__gt__=function(b,a){return"object"==
typeof b&&"__gt__"in b?b.__gt__(a):b>a};m.__ge__=function(b,a){return"object"==typeof b&&"__ge__"in b?b.__ge__(a):b>=a};m.__imatmul__=function(b,a){return"__imatmul__"in b?b.__imatmul__(a):b.__matmul__(a)};m.ipow=function(b,a){return"object"==typeof b&&"__pow__"in b?b.__ipow__(a):"object"==typeof b&&"__ipow__"in b?b.__pow__(a):"object"==typeof a&&"__rpow__"in a?a.__rpow__(b):Math.pow(b,a)};m.ijsmod__=function(b,a){return"object"==typeof b&&"__imod__"in b?b.__ismod__(a):"object"==typeof b&&"__mod__"in
b?b.__mod__(a):"object"==typeof a&&"__rpow__"in a?a.__rmod__(b):b%a};m.imod=function(b,a){return"object"==typeof b&&"__imod__"in b?b.__imod__(a):"object"==typeof b&&"__mod__"in b?b.__mod__(a):"object"==typeof a&&"__rpow__"in a?a.__rmod__(b):(b%a+a)%a};m.__imul__=function(b,a){return"object"==typeof b&&"__imul__"in b?b.__imul__(a):"object"==typeof b&&"__mul__"in b?b.__mul__(a):"object"==typeof a&&"__rmul__"in a?a.__rmul__(b):"string"==typeof b?b.__mul__(a):"string"==typeof a?a.__rmul__(b):b*a};m.__idiv__=
function(b,a){return"object"==typeof b&&"__idiv__"in b?b.__idiv__(a):"object"==typeof b&&"__div__"in b?b.__div__(a):"object"==typeof a&&"__rdiv__"in a?a.__rdiv__(b):b/a};m.__iadd__=function(b,a){return"object"==typeof b&&"__iadd__"in b?b.__iadd__(a):"object"==typeof b&&"__add__"in b?b.__add__(a):"object"==typeof a&&"__radd__"in a?a.__radd__(b):b+a};m.__isub__=function(b,a){return"object"==typeof b&&"__isub__"in b?b.__isub__(a):"object"==typeof b&&"__sub__"in b?b.__sub__(a):"object"==typeof a&&"__rsub__"in
a?a.__rsub__(b):b-a};m.__ilshift__=function(b,a){return"object"==typeof b&&"__ilshift__"in b?b.__ilshift__(a):"object"==typeof b&&"__lshift__"in b?b.__lshift__(a):"object"==typeof a&&"__rlshift__"in a?a.__rlshift__(b):b<<a};m.__irshift__=function(b,a){return"object"==typeof b&&"__irshift__"in b?b.__irshift__(a):"object"==typeof b&&"__rshift__"in b?b.__rshift__(a):"object"==typeof a&&"__rrshift__"in a?a.__rrshift__(b):b>>a};m.__ior__=function(b,a){return"object"==typeof b&&"__ior__"in b?b.__ior__(a):
"object"==typeof b&&"__or__"in b?b.__or__(a):"object"==typeof a&&"__ror__"in a?a.__ror__(b):b|a};m.__ixor__=function(b,a){return"object"==typeof b&&"__ixor__"in b?b.__ixor__(a):"object"==typeof b&&"__xor__"in b?b.__xor__(a):"object"==typeof a&&"__rxor__"in a?a.__rxor__(b):b^a};m.__iand__=function(b,a){return"object"==typeof b&&"__iand__"in b?b.__iand__(a):"object"==typeof b&&"__and__"in b?b.__and__(a):"object"==typeof a&&"__rand__"in a?a.__rand__(b):b&a};m.__getitem__=function(b,a){return"object"==
typeof b&&"__getitem__"in b?b.__getitem__(a):b[a]};m.__setitem__=function(b,a,k){"object"==typeof b&&"__setitem__"in b?b.__setitem__(a,k):b[a]=k};m.__getslice__=function(b,a,k,n){return"object"==typeof b&&"__getitem__"in b?b.__getitem__([a,k,n]):b.__getslice__(a,k,n)};m.__setslice__=function(b,a,k,n,p){"object"==typeof b&&"__setitem__"in b?b.__setitem__([a,k,n],p):b.__setslice__(a,k,n,p)};Q(m,"com.fabricjs",{__all__:{__inited__:!1,__init__:function(b){var a=function(){var b={},a=a||{version:"1.5.0"};
"undefined"!==typeof b&&(b.fabric=a);"undefined"!==typeof document&&"undefined"!==typeof window?(a.document=document,a.window=window,window.fabric=a):(a.document=require("jsdom").jsdom("<!DOCTYPE html><html><head></head><body></body></html>"),a.window=a.document.createWindow?a.document.createWindow():a.document.parentWindow);a.isTouchSupported="ontouchstart"in a.document.documentElement;a.isLikelyNode="undefined"!==typeof Buffer&&"undefined"===typeof window;a.SHARED_ATTRIBUTES="display transform fill fill-opacity fill-rule opacity stroke stroke-dasharray stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width".split(" ");
a.DPI=96;a.reNum="(?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:e[-+]?\\d+)?)";(function(){function b(c,e){this.__eventListeners[c]&&(e?a.util.removeFromArray(this.__eventListeners[c],e):this.__eventListeners[c].length=0)}function l(c,e){this.__eventListeners||(this.__eventListeners={});if(1===arguments.length)for(var f in c)this.on(f,c[f]);else this.__eventListeners[c]||(this.__eventListeners[c]=[]),this.__eventListeners[c].push(e);return this}function h(c,e){if(this.__eventListeners){if(0===arguments.length)this.__eventListeners=
{};else if(1===arguments.length&&"object"===typeof arguments[0])for(var f in c)b.call(this,f,c[f]);else b.call(this,c,e);return this}}function g(c,e){if(this.__eventListeners&&(c=this.__eventListeners[c])){for(var f=0,d=c.length;f<d;f++)c[f].call(this,e||{});return this}}a.Observable={observe:l,stopObserving:h,fire:g,on:l,off:h,trigger:g}})();a.Collection={add:function(){this._objects.push.apply(this._objects,arguments);for(var a=0,b=arguments.length;a<b;a++)this._onObjectAdded(arguments[a]);this.renderOnAddRemove&&
this.renderAll();return this},insertAt:function(a,b,h){var g=this.getObjects();h?g[b]=a:g.splice(b,0,a);this._onObjectAdded(a);this.renderOnAddRemove&&this.renderAll();return this},remove:function(){for(var a=this.getObjects(),b,h=0,g=arguments.length;h<g;h++)b=a.indexOf(arguments[h]),-1!==b&&(a.splice(b,1),this._onObjectRemoved(arguments[h]));this.renderOnAddRemove&&this.renderAll();return this},forEachObject:function(a,b){for(var h=this.getObjects(),g=h.length;g--;)a.call(b,h[g],g,h);return this},
getObjects:function(a){return"undefined"===typeof a?this._objects:this._objects.filter(function(b){return b.type===a})},item:function(a){return this.getObjects()[a]},isEmpty:function(){return 0===this.getObjects().length},size:function(){return this.getObjects().length},contains:function(a){return-1<this.getObjects().indexOf(a)},complexity:function(){return this.getObjects().reduce(function(a,b){return a+=b.complexity?b.complexity():0},0)}};(function(b){var l=Math.sqrt,h=Math.atan2,g=Math.PI/180;
a.util={removeFromArray:function(c,e){e=c.indexOf(e);-1!==e&&c.splice(e,1);return c},getRandomInt:function(c,e){return Math.floor(Math.random()*(e-c+1))+c},degreesToRadians:function(c){return c*g},radiansToDegrees:function(c){return c/g},rotatePoint:function(c,e,f){var d=Math.sin(f);f=Math.cos(f);c.subtractEquals(e);return(new a.Point(c.x*f-c.y*d,c.x*d+c.y*f)).addEquals(e)},transformPoint:function(c,e,f){return f?new a.Point(e[0]*c.x+e[2]*c.y,e[1]*c.x+e[3]*c.y):new a.Point(e[0]*c.x+e[2]*c.y+e[4],
e[1]*c.x+e[3]*c.y+e[5])},invertTransform:function(c){var e;c.slice();e=1/(c[0]*c[3]-c[1]*c[2]);e=[e*c[3],-e*c[1],-e*c[2],e*c[0],0,0];c=a.util.transformPoint({x:c[4],y:c[5]},e);e[4]=-c.x;e[5]=-c.y;return e},toFixed:function(c,e){return parseFloat(Number(c).toFixed(e))},parseUnit:function(c,e){var f=/\D{0,2}$/.exec(c);c=parseFloat(c);e||(e=a.Text.DEFAULT_SVG_FONT_SIZE);switch(f[0]){case "mm":return c*a.DPI/25.4;case "cm":return c*a.DPI/2.54;case "in":return c*a.DPI;case "pt":return c*a.DPI/72;case "pc":return c*
a.DPI/72*12;case "em":return c*e;default:return c}},falseFunction:function(){return!1},getKlass:function(c,e){c=a.util.string.camelize(c.charAt(0).toUpperCase()+c.slice(1));return a.util.resolveNamespace(e)[c]},resolveNamespace:function(c){if(!c)return a;c=c.split(".");for(var e=c.length,f=b||a.window,d=0;d<e;++d)f=f[c[d]];return f},loadImage:function(c,e,f,d){if(c){var b=a.util.createImage();b.onload=function(){e&&e.call(f,b);b=b.onload=b.onerror=null};b.onerror=function(){a.log("Error loading "+
b.src);e&&e.call(f,null,!0);b=b.onload=b.onerror=null};0!==c.indexOf("data")&&"undefined"!==typeof d&&(b.crossOrigin=d);b.src=c}else e&&e.call(f,c)},enlivenObjects:function(c,e,f,d){function b(){++l===h&&e&&e(g)}c=c||[];var g=[],l=0,h=c.length;h?c.forEach(function(c,e){if(c&&c.type){var l=a.util.getKlass(c.type,f);l.async?l.fromObject(c,function(f,a){a||(g[e]=f,d&&d(c,g[e]));b()}):(g[e]=l.fromObject(c),d&&d(c,g[e]),b())}else b()}):e&&e(g)},groupSVGElements:function(c,e,f){c=new a.PathGroup(c,e);"undefined"!==
typeof f&&c.setSourcePath(f);return c},populateWithProperties:function(c,e,f){if(f&&"[object Array]"===Object.prototype.toString.call(f))for(var d=0,a=f.length;d<a;d++)f[d]in c&&(e[f[d]]=c[f[d]])},drawDashedLine:function(c,e,f,d,a,b){d-=e;var g=a-f;a=l(d*d+g*g);d=h(g,d);var g=b.length,O=0,p=!0;c.save();c.translate(e,f);c.moveTo(0,0);c.rotate(d);for(e=0;a>e;)e+=b[O++%g],e>a&&(e=a),c[p?"lineTo":"moveTo"](e,0),p=!p;c.restore()},createCanvasElement:function(c){c||(c=a.document.createElement("canvas"));
c.getContext||"undefined"===typeof G_vmlCanvasManager||G_vmlCanvasManager.initElement(c);return c},createImage:function(){return a.isLikelyNode?new (require("canvas").Image):a.document.createElement("img")},createAccessors:function(c){c=c.prototype;for(var e=c.stateProperties.length;e--;){var f=c.stateProperties[e],d=f.charAt(0).toUpperCase()+f.slice(1),a="set"+d,d="get"+d;c[d]||(c[d]=new Function('return this.get("'+f+'")'));c[a]||(c[a]=new Function("value",'return this.set("'+f+'", value)'))}},
clipContext:function(c,e){e.save();e.beginPath();c.clipTo(e);e.clip()},multiplyTransformMatrices:function(c,e){return[c[0]*e[0]+c[2]*e[1],c[1]*e[0]+c[3]*e[1],c[0]*e[2]+c[2]*e[3],c[1]*e[2]+c[3]*e[3],c[0]*e[4]+c[2]*e[5]+c[4],c[1]*e[4]+c[3]*e[5]+c[5]]},getFunctionBody:function(c){return(String(c).match(/function[^{]*\{([\s\S]*)\}/)||{})[1]},isTransparent:function(c,e,f,d){0<d&&(e=e>d?e-d:0,f=f>d?f-d:0);var a=!0;c=c.getImageData(e,f,2*d||1,2*d||1);e=3;for(f=c.data.length;e<f&&(a=0>=c.data[e],!1!==a);e+=
4);return a}}})("undefined"!==typeof b?b:this);(function(){function b(f,e,a,g,p,k,sa){var fa=d.call(arguments);if(c[fa])return c[fa];var N=Math.PI,m=sa*N/180,n=Math.sin(m),m=Math.cos(m),ga=0,J=0;a=Math.abs(a);g=Math.abs(g);var C=-m*f*.5-n*e*.5,q=-m*e*.5+n*f*.5,r=a*a,x=g*g,u=q*q,w=C*C,v=r*x-r*u-x*w,y=0;0>v?(r=Math.sqrt(1-v/(r*x)),a*=r,g*=r):y=(p===k?-1:1)*Math.sqrt(v/(r*u+x*w));u=y*a*q/g;w=-y*g*C/a;y=m*u-n*w+.5*f;r=n*u+m*w+.5*e;x=h(1,0,(C-u)/a,(q-w)/g);q=h((C-u)/a,(q-w)/g,(-C-u)/a,(-q-w)/g);0===k&&
0<q?q-=2*N:1===k&&0>q&&(q+=2*N);N=Math.ceil(Math.abs(q/N*2));C=[];q/=N;u=8/3*Math.sin(q/4)*Math.sin(q/4)/Math.sin(q/2);w=x+q;for(v=0;v<N;v++)C[v]=l(x,w,m,n,a,g,y,r,u,ga,J),ga=C[v][4],J=C[v][5],x=w,w+=q;return c[fa]=C}function l(f,c,a,b,g,l,h,p,k,m,n){var q=d.call(arguments);if(e[q])return e[q];var J=Math.cos(f),C=Math.sin(f),r=Math.cos(c),u=Math.sin(c),x=a*g*r-b*l*u+h,v=b*g*r+a*l*u+p;e[q]=[m+k*(-a*g*C-b*l*J),n+k*(-b*g*C+a*l*J),x+k*(a*g*u+b*l*r),v+k*(b*g*u-a*l*r),x,v];return e[q]}function h(d,f,c,
e){d=Math.atan2(f,d);c=Math.atan2(e,c);return c>=d?c-d:2*Math.PI-(d-c)}function g(c,e,a,b,g,l,h,p){var k=d.call(arguments);if(f[k])return f[k];var m=Math.sqrt,n=Math.min,q=Math.max,J=Math.abs,C=[],r=[[],[]],u,x,v,w,y;x=6*c-12*a+6*g;u=-3*c+9*a-9*g+3*h;v=3*a-3*c;for(var B=0;2>B;++B)0<B&&(x=6*e-12*b+6*l,u=-3*e+9*b-9*l+3*p,v=3*b-3*e),1E-12>J(u)?1E-12>J(x)||(w=-v/x,0<w&&1>w&&C.push(w)):(w=x*x-4*v*u,0>w||(y=m(w),w=(-x+y)/(2*u),0<w&&1>w&&C.push(w),w=(-x-y)/(2*u),0<w&&1>w&&C.push(w)));for(J=m=C.length;m--;)w=
C[m],x=1-w,u=x*x*x*c+3*x*x*w*a+3*x*w*w*g+w*w*w*h,r[0][m]=u,u=x*x*x*e+3*x*x*w*b+3*x*w*w*l+w*w*w*p,r[1][m]=u;r[0][J]=c;r[1][J]=e;r[0][J+1]=h;r[1][J+1]=p;n=[{x:n.apply(null,r[0]),y:n.apply(null,r[1])},{x:q.apply(null,r[0]),y:q.apply(null,r[1])}];return f[k]=n}var c={},e={},f={},d=Array.prototype.join;a.util.drawArc=function(d,f,c,e){var a=[[],[],[],[]];e=b(e[5]-f,e[6]-c,e[0],e[1],e[3],e[4],e[2]);for(var g=0,l=e.length;g<l;g++)a[g][0]=e[g][0]+f,a[g][1]=e[g][1]+c,a[g][2]=e[g][2]+f,a[g][3]=e[g][3]+c,a[g][4]=
e[g][4]+f,a[g][5]=e[g][5]+c,d.bezierCurveTo.apply(d,a[g])};a.util.getBoundsOfArc=function(d,f,c,e,a,l,h,k,m){var n=0,q=0,r=[];c=b(k-d,m-f,c,e,l,h,a);e=[[],[]];a=0;for(l=c.length;a<l;a++)n=g(n,q,c[a][0],c[a][1],c[a][2],c[a][3],c[a][4],c[a][5]),e[0].x=n[0].x+d,e[0].y=n[0].y+f,e[1].x=n[1].x+d,e[1].y=n[1].y+f,r.push(e[0]),r.push(e[1]),n=c[a][4],q=c[a][5];return r};a.util.getBoundsOfCurve=g})();(function(){function b(a,g,c){if(a&&0!==a.length){var e=a.length-1,f=g?a[e][g]:a[e];if(g)for(;e--;)c(a[e][g],
f)&&(f=a[e][g]);else for(;e--;)c(a[e],f)&&(f=a[e]);return f}}var l=Array.prototype.slice;Array.prototype.indexOf||(Array.prototype.indexOf=function(a){if(void 0===this||null===this)throw new TypeError;var b=Object(this),c=b.length>>>0;if(0===c)return-1;var e=0;0<arguments.length&&(e=Number(arguments[1]),e!==e?e=0:0!==e&&e!==Number.POSITIVE_INFINITY&&e!==Number.NEGATIVE_INFINITY&&(e=(0<e||-1)*Math.floor(Math.abs(e))));if(e>=c)return-1;for(e=0<=e?e:Math.max(c-Math.abs(e),0);e<c;e++)if(e in b&&b[e]===
a)return e;return-1});Array.prototype.forEach||(Array.prototype.forEach=function(a,b){for(var c=0,e=this.length>>>0;c<e;c++)c in this&&a.call(b,this[c],c,this)});Array.prototype.map||(Array.prototype.map=function(a,b){for(var c=[],e=0,f=this.length>>>0;e<f;e++)e in this&&(c[e]=a.call(b,this[e],e,this));return c});Array.prototype.every||(Array.prototype.every=function(a,b){for(var c=0,e=this.length>>>0;c<e;c++)if(c in this&&!a.call(b,this[c],c,this))return!1;return!0});Array.prototype.some||(Array.prototype.some=
function(a,b){for(var c=0,e=this.length>>>0;c<e;c++)if(c in this&&a.call(b,this[c],c,this))return!0;return!1});Array.prototype.filter||(Array.prototype.filter=function(a,b){for(var c=[],e,f=0,d=this.length>>>0;f<d;f++)f in this&&(e=this[f],a.call(b,e,f,this)&&c.push(e));return c});Array.prototype.reduce||(Array.prototype.reduce=function(a){var b=this.length>>>0,c=0,e;if(1<arguments.length)e=arguments[1];else{do{if(c in this){e=this[c++];break}if(++c>=b)throw new TypeError;}while(1)}for(;c<b;c++)c in
this&&(e=a.call(null,e,this[c],c,this));return e});a.util.array={invoke:function(a,b){for(var c=l.call(arguments,2),e=[],f=0,d=a.length;f<d;f++)e[f]=c.length?a[f][b].apply(a[f],c):a[f][b].call(a[f]);return e},min:function(a,g){return b(a,g,function(c,e){return c<e})},max:function(a,g){return b(a,g,function(c,e){return c>=e})}}})();(function(){function b(a,h){for(var g in h)a[g]=h[g];return a}a.util.object={extend:b,clone:function(a){return b({},a)}}})();(function(){String.prototype.trim||(String.prototype.trim=
function(){return this.replace(/^[\s\xA0]+/,"").replace(/[\s\xA0]+$/,"")});a.util.string={camelize:function(a){return a.replace(/-+(.)?/g,function(a,b){return b?b.toUpperCase():""})},capitalize:function(a,b){return a.charAt(0).toUpperCase()+(b?a.slice(1):a.slice(1).toLowerCase())},escapeXml:function(a){return a.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}}})();(function(){var a=Array.prototype.slice,b=Function.prototype.apply,h=function(){};
Function.prototype.bind||(Function.prototype.bind=function(g){var c=this,e=a.call(arguments,1),f;f=e.length?function(){return b.call(c,this instanceof h?this:g,e.concat(a.call(arguments)))}:function(){return b.call(c,this instanceof h?this:g,arguments)};h.prototype=this.prototype;f.prototype=new h;return f})})();(function(){function b(){}function l(f){var d=this.constructor.superclass.prototype[f];return 1<arguments.length?d.apply(this,h.call(arguments,1)):d.call(this)}var h=Array.prototype.slice,
g=function(){},c=function(){for(var f in{toString:1})if("toString"===f)return!1;return!0}(),e=function(f,d,e){for(var a in d)a in f.prototype&&"function"===typeof f.prototype[a]&&-1<(d[a]+"").indexOf("callSuper")?f.prototype[a]=function(f){return function(){var c=this.constructor.superclass;this.constructor.superclass=e;var a=d[f].apply(this,arguments);this.constructor.superclass=c;if("initialize"!==f)return a}}(a):f.prototype[a]=d[a],c&&(d.toString!==Object.prototype.toString&&(f.prototype.toString=
d.toString),d.valueOf!==Object.prototype.valueOf&&(f.prototype.valueOf=d.valueOf))};a.util.createClass=function(){function f(){this.initialize.apply(this,arguments)}var d=null,c=h.call(arguments,0);"function"===typeof c[0]&&(d=c.shift());f.superclass=d;f.subclasses=[];d&&(b.prototype=d.prototype,f.prototype=new b,d.subclasses.push(f));for(var a=0,A=c.length;a<A;a++)e(f,c[a],d);f.prototype.initialize||(f.prototype.initialize=g);f.prototype.constructor=f;f.prototype.callSuper=l;return f}})();(function(){function b(d){var f=
Array.prototype.slice.call(arguments,1),c,e,a=f.length;for(e=0;e<a;e++)if(c=typeof d[f[e]],!/^(?:function|object|unknown)$/.test(c))return!1;return!0}function l(d,f){return function(e){f.call(c(d),e||a.window.event)}}function h(d,f){return function(c){if(A[d]&&A[d][f])for(var e=A[d][f],b=0,g=e.length;b<g;b++)e[b].call(this,c||a.window.event)}}function g(d,f,c){var e="touchend"===d.type?"changedTouches":"touches";return d[e]&&d[e][0]?d[e][0][f]-(d[e][0][f]-d[e][0][c])||d[c]:d[c]}var c,e,f=function(){var d=
0;return function(f){return f.__uniqueID||(f.__uniqueID="uniqueID__"+d++)}}();(function(){var d={};c=function(f){return d[f]};e=function(f,c){d[f]=c}})();var d=b(a.document.documentElement,"addEventListener","removeEventListener")&&b(a.window,"addEventListener","removeEventListener"),t=b(a.document.documentElement,"attachEvent","detachEvent")&&b(a.window,"attachEvent","detachEvent"),z={},A={};d?(d=function(d,f,c){d.addEventListener(f,c,!1)},t=function(d,f,c){d.removeEventListener(f,c,!1)}):t?(d=function(d,
c,a){var b=f(d);e(b,d);z[b]||(z[b]={});z[b][c]||(z[b][c]=[]);a={handler:a,wrappedHandler:l(b,a)};z[b][c].push(a);d.attachEvent("on"+c,a.wrappedHandler)},t=function(d,c,e){var a=f(d),b;if(z[a]&&z[a][c])for(var g=0,l=z[a][c].length;g<l;g++)(b=z[a][c][g])&&b.handler===e&&(d.detachEvent("on"+c,b.wrappedHandler),z[a][c][g]=null)}):(d=function(d,c,e){var a=f(d);A[a]||(A[a]={});if(!A[a][c]){A[a][c]=[];var b=d["on"+c];b&&A[a][c].push(b);d["on"+c]=h(a,c)}A[a][c].push(e)},t=function(d,c,e){d=f(d);if(A[d]&&
A[d][c]){c=A[d][c];d=0;for(var a=c.length;d<a;d++)c[d]===e&&c.splice(d,1)}});a.util.addListener=d;a.util.removeListener=t;var O=function(d){return"unknown"!==typeof d.clientX?d.clientX:0},k=function(d){return"unknown"!==typeof d.clientY?d.clientY:0};a.isTouchSupported&&(O=function(d){return g(d,"pageX","clientX")},k=function(d){return g(d,"pageY","clientY")});a.util.getPointer=function(d,f){d||(d=a.window.event);f=a.util.getScrollLeftTop(d.target||("unknown"!==typeof d.srcElement?d.srcElement:null),
f);return{x:O(d)+f.left,y:k(d)+f.top}};a.util.object.extend(a.util,a.Observable)})();(function(){var b=a.document.createElement("div"),l="string"===typeof b.style.filter,h=/alpha\s*\(\s*opacity\s*=\s*([^\)]+)\)/,g=function(c){return c};"string"===typeof b.style.opacity?g=function(c,e){c.style.opacity=e;return c}:l&&(g=function(c,e){var f=c.style;c.currentStyle&&!c.currentStyle.hasLayout&&(f.zoom=1);h.test(f.filter)?f.filter=f.filter.replace(h,.9999<=e?"":"alpha(opacity="+100*e+")"):f.filter+=" alpha(opacity="+
100*e+")";return c});a.util.setStyle=function(c,e){var f=c.style;if(!f)return c;if("string"===typeof e)return c.style.cssText+=";"+e,-1<e.indexOf("opacity")?g(c,e.match(/opacity:\s*(\d?\.?\d*)/)[1]):c;for(var d in e)"opacity"===d?g(c,e[d]):f["float"===d||"cssFloat"===d?"undefined"===typeof f.styleFloat?"cssFloat":"styleFloat":d]=e[d];return c}})();(function(){function b(c,f){c=a.document.createElement(c);for(var d in f)"class"===d?c.className=f[d]:"for"===d?c.htmlFor=f[d]:c.setAttribute(d,f[d]);return c}
var l=Array.prototype.slice,h,g=function(c){return l.call(c,0)};try{h=g(a.document.childNodes)instanceof Array}catch(e){}h||(g=function(c){for(var f=Array(c.length),d=c.length;d--;)f[d]=c[d];return f});var c;c=a.document.defaultView&&a.document.defaultView.getComputedStyle?function(c,f){return(c=a.document.defaultView.getComputedStyle(c,null))?c[f]:void 0}:function(c,f){var d=c.style[f];!d&&c.currentStyle&&(d=c.currentStyle[f]);return d};(function(){var c=a.document.documentElement.style,f="userSelect"in
c?"userSelect":"MozUserSelect"in c?"MozUserSelect":"WebkitUserSelect"in c?"WebkitUserSelect":"KhtmlUserSelect"in c?"KhtmlUserSelect":"";a.util.makeElementUnselectable=function(d){"undefined"!==typeof d.onselectstart&&(d.onselectstart=a.util.falseFunction);f?d.style[f]="none":"string"===typeof d.unselectable&&(d.unselectable="on");return d};a.util.makeElementSelectable=function(d){"undefined"!==typeof d.onselectstart&&(d.onselectstart=null);f?d.style[f]="":"string"===typeof d.unselectable&&(d.unselectable=
"");return d}})();(function(){a.util.getScript=function(c,f){var d=a.document.getElementsByTagName("head")[0],b=a.document.createElement("script"),g=!0;b.onload=b.onreadystatechange=function(d){!g||"string"===typeof this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(g=!1,f(d||a.window.event),b=b.onload=b.onreadystatechange=null)};b.src=c;d.appendChild(b)}})();a.util.getById=function(c){return"string"===typeof c?a.document.getElementById(c):c};a.util.toArray=g;a.util.makeElement=
b;a.util.addClass=function(c,f){c&&-1===(" "+c.className+" ").indexOf(" "+f+" ")&&(c.className+=(c.className?" ":"")+f)};a.util.wrapElement=function(c,f,d){"string"===typeof f&&(f=b(f,d));c.parentNode&&c.parentNode.replaceChild(f,c);f.appendChild(c);return f};a.util.getScrollLeftTop=function(c,f){var d,b,g=0,l=0,h=a.document.documentElement,p=a.document.body||{scrollLeft:0,scrollTop:0};for(b=c;c&&c.parentNode&&!d;)c=c.parentNode,1===c.nodeType&&"fixed"===a.util.getElementStyle(c,"position")&&(d=c),
1===c.nodeType&&b!==f&&"absolute"===a.util.getElementStyle(c,"position")?l=g=0:c===a.document?(g=p.scrollLeft||h.scrollLeft||0,l=p.scrollTop||h.scrollTop||0):(g+=c.scrollLeft||0,l+=c.scrollTop||0);return{left:g,top:l}};a.util.getElementOffset=function(e){var f;f=e&&e.ownerDocument;var d={left:0,top:0},b={left:0,top:0},g={borderLeftWidth:"left",borderTopWidth:"top",paddingLeft:"left",paddingTop:"top"};if(!f)return{left:0,top:0};for(var l in g)b[g[l]]+=parseInt(c(e,l),10)||0;f=f.documentElement;"undefined"!==
typeof e.getBoundingClientRect&&(d=e.getBoundingClientRect());e=a.util.getScrollLeftTop(e,null);return{left:d.left+e.left-(f.clientLeft||0)+b.left,top:d.top+e.top-(f.clientTop||0)+b.top}};a.util.getElementStyle=c})();(function(){function b(a,c){return a+(/\?/.test(a)?"&":"?")+c}function l(){}var h=function(){for(var a=[function(){return new ActiveXObject("Microsoft.XMLHTTP")},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml2.XMLHTTP.3.0")},function(){return new XMLHttpRequest}],
c=a.length;c--;)try{if(a[c]())return a[c]}catch(e){}}();a.util.request=function(a,c){c||(c={});var e=c.method?c.method.toUpperCase():"GET",f=c.onComplete||function(){},d=h(),t;d.onreadystatechange=function(){4===d.readyState&&(f(d),d.onreadystatechange=l)};"GET"===e&&(t=null,"string"===typeof c.parameters&&(a=b(a,c.parameters)));d.open(e,a,!0);"POST"!==e&&"PUT"!==e||d.setRequestHeader("Content-Type","application/x-www-form-urlencoded");d.send(t);return d}})();a.log=function(){};a.warn=function(){};
"undefined"!==typeof console&&["log","warn"].forEach(function(b){"undefined"!==typeof console[b]&&"function"===typeof console[b].apply&&(a[b]=function(){return console[b].apply(console,arguments)})});(function(a){function b(a,g){this.x=a;this.y=g}a=a.fabric||(a.fabric={});a.Point?a.warn("fabric.Point is already defined"):(a.Point=b,b.prototype={constructor:b,add:function(a){return new b(this.x+a.x,this.y+a.y)},addEquals:function(a){this.x+=a.x;this.y+=a.y;return this},scalarAdd:function(a){return new b(this.x+
a,this.y+a)},scalarAddEquals:function(a){this.x+=a;this.y+=a;return this},subtract:function(a){return new b(this.x-a.x,this.y-a.y)},subtractEquals:function(a){this.x-=a.x;this.y-=a.y;return this},scalarSubtract:function(a){return new b(this.x-a,this.y-a)},scalarSubtractEquals:function(a){this.x-=a;this.y-=a;return this},multiply:function(a){return new b(this.x*a,this.y*a)},multiplyEquals:function(a){this.x*=a;this.y*=a;return this},divide:function(a){return new b(this.x/a,this.y/a)},divideEquals:function(a){this.x/=
a;this.y/=a;return this},eq:function(a){return this.x===a.x&&this.y===a.y},lt:function(a){return this.x<a.x&&this.y<a.y},lte:function(a){return this.x<=a.x&&this.y<=a.y},gt:function(a){return this.x>a.x&&this.y>a.y},gte:function(a){return this.x>=a.x&&this.y>=a.y},lerp:function(a,g){return new b(this.x+(a.x-this.x)*g,this.y+(a.y-this.y)*g)},distanceFrom:function(a){var b=this.x-a.x;a=this.y-a.y;return Math.sqrt(b*b+a*a)},midPointFrom:function(a){return new b(this.x+(a.x-this.x)/2,this.y+(a.y-this.y)/
2)},min:function(a){return new b(Math.min(this.x,a.x),Math.min(this.y,a.y))},max:function(a){return new b(Math.max(this.x,a.x),Math.max(this.y,a.y))},toString:function(){return this.x+","+this.y},setXY:function(a,b){this.x=a;this.y=b},setFromPoint:function(a){this.x=a.x;this.y=a.y},swap:function(a){var b=this.x,c=this.y;this.x=a.x;this.y=a.y;a.x=b;a.y=c}})})("undefined"!==typeof b?b:this);(function(a){function b(a){this.status=a;this.points=[]}var h=a.fabric||(a.fabric={});h.Intersection?h.warn("fabric.Intersection is already defined"):
(h.Intersection=b,h.Intersection.prototype={appendPoint:function(a){this.points.push(a)},appendPoints:function(a){this.points=this.points.concat(a)}},h.Intersection.intersectLineLine=function(a,c,e,f){var d,t=(f.x-e.x)*(a.y-e.y)-(f.y-e.y)*(a.x-e.x);d=(c.x-a.x)*(a.y-e.y)-(c.y-a.y)*(a.x-e.x);e=(f.y-e.y)*(c.x-a.x)-(f.x-e.x)*(c.y-a.y);0!==e?(t/=e,d/=e,0<=t&&1>=t&&0<=d&&1>=d?(d=new b("Intersection"),d.points.push(new h.Point(a.x+t*(c.x-a.x),a.y+t*(c.y-a.y)))):d=new b):d=0===t||0===d?new b("Coincident"):
new b("Parallel");return d},h.Intersection.intersectLinePolygon=function(a,c,e){for(var f=new b,d=e.length,h=0;h<d;h++){var z=b.intersectLineLine(a,c,e[h],e[(h+1)%d]);f.appendPoints(z.points)}0<f.points.length&&(f.status="Intersection");return f},h.Intersection.intersectPolygonPolygon=function(a,c){for(var e=new b,f=a.length,d=0;d<f;d++){var h=b.intersectLinePolygon(a[d],a[(d+1)%f],c);e.appendPoints(h.points)}0<e.points.length&&(e.status="Intersection");return e},h.Intersection.intersectPolygonRectangle=
function(a,c,e){var f=c.min(e),d=c.max(e);e=new h.Point(d.x,f.y);var t=new h.Point(f.x,d.y);c=b.intersectLinePolygon(f,e,a);e=b.intersectLinePolygon(e,d,a);d=b.intersectLinePolygon(d,t,a);a=b.intersectLinePolygon(t,f,a);f=new b;f.appendPoints(c.points);f.appendPoints(e.points);f.appendPoints(d.points);f.appendPoints(a.points);0<f.points.length&&(f.status="Intersection");return f})})("undefined"!==typeof b?b:this);(function(a){function b(c){c?this._tryParsingColor(c):this.setSource([0,0,0,1])}function h(c,
a,f){0>f&&(f+=1);1<f&&--f;return f<1/6?c+6*(a-c)*f:.5>f?a:f<2/3?c+(a-c)*(2/3-f)*6:c}var g=a.fabric||(a.fabric={});g.Color?g.warn("fabric.Color is already defined."):(g.Color=b,g.Color.prototype={_tryParsingColor:function(c){var a;c in b.colorNameMap&&(c=b.colorNameMap[c]);"transparent"===c?this.setSource([255,255,255,0]):((a=b.sourceFromHex(c))||(a=b.sourceFromRgb(c)),a||(a=b.sourceFromHsl(c)),a&&this.setSource(a))},_rgbToHsl:function(c,a,f){c/=255;a/=255;f/=255;var d,b,l,h=g.util.array.max([c,a,
f]);b=g.util.array.min([c,a,f]);l=(h+b)/2;if(h===b)d=b=0;else{var p=h-b;b=.5<l?p/(2-h-b):p/(h+b);switch(h){case c:d=(a-f)/p+(a<f?6:0);break;case a:d=(f-c)/p+2;break;case f:d=(c-a)/p+4}d/=6}return[Math.round(360*d),Math.round(100*b),Math.round(100*l)]},getSource:function(){return this._source},setSource:function(c){this._source=c},toRgb:function(){var c=this.getSource();return"rgb("+c[0]+","+c[1]+","+c[2]+")"},toRgba:function(){var c=this.getSource();return"rgba("+c[0]+","+c[1]+","+c[2]+","+c[3]+")"},
toHsl:function(){var c=this.getSource(),c=this._rgbToHsl(c[0],c[1],c[2]);return"hsl("+c[0]+","+c[1]+"%,"+c[2]+"%)"},toHsla:function(){var c=this.getSource(),a=this._rgbToHsl(c[0],c[1],c[2]);return"hsla("+a[0]+","+a[1]+"%,"+a[2]+"%,"+c[3]+")"},toHex:function(){var c=this.getSource(),a,f;a=c[0].toString(16);a=1===a.length?"0"+a:a;f=c[1].toString(16);f=1===f.length?"0"+f:f;c=c[2].toString(16);c=1===c.length?"0"+c:c;return a.toUpperCase()+f.toUpperCase()+c.toUpperCase()},getAlpha:function(){return this.getSource()[3]},
setAlpha:function(c){var a=this.getSource();a[3]=c;this.setSource(a);return this},toGrayscale:function(){var c=this.getSource(),a=parseInt((.3*c[0]+.59*c[1]+.11*c[2]).toFixed(0),10);this.setSource([a,a,a,c[3]]);return this},toBlackWhite:function(c){var a=this.getSource(),f=(.3*a[0]+.59*a[1]+.11*a[2]).toFixed(0),a=a[3],f=Number(f)<Number(c||127)?0:255;this.setSource([f,f,f,a]);return this},overlayWith:function(c){c instanceof b||(c=new b(c));var a=[],f=this.getAlpha(),d=this.getSource();c=c.getSource();
for(var g=0;3>g;g++)a.push(Math.round(.5*d[g]+.5*c[g]));a[3]=f;this.setSource(a);return this}},g.Color.reRGBa=/^rgba?\(\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/,g.Color.reHSLa=/^hsla?\(\s*(\d{1,3})\s*,\s*(\d{1,3}\%)\s*,\s*(\d{1,3}\%)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/,g.Color.reHex=/^#?([0-9a-f]{6}|[0-9a-f]{3})$/i,g.Color.colorNameMap={aqua:"#00FFFF",black:"#000000",blue:"#0000FF",fuchsia:"#FF00FF",gray:"#808080",green:"#008000",
lime:"#00FF00",maroon:"#800000",navy:"#000080",olive:"#808000",orange:"#FFA500",purple:"#800080",red:"#FF0000",silver:"#C0C0C0",teal:"#008080",white:"#FFFFFF",yellow:"#FFFF00"},g.Color.fromRgb=function(c){return b.fromSource(b.sourceFromRgb(c))},g.Color.sourceFromRgb=function(c){if(c=c.match(b.reRGBa)){var a=parseInt(c[1],10)/(/%$/.test(c[1])?100:1)*(/%$/.test(c[1])?255:1),f=parseInt(c[2],10)/(/%$/.test(c[2])?100:1)*(/%$/.test(c[2])?255:1),d=parseInt(c[3],10)/(/%$/.test(c[3])?100:1)*(/%$/.test(c[3])?
255:1);return[parseInt(a,10),parseInt(f,10),parseInt(d,10),c[4]?parseFloat(c[4]):1]}},g.Color.fromRgba=b.fromRgb,g.Color.fromHsl=function(c){return b.fromSource(b.sourceFromHsl(c))},g.Color.sourceFromHsl=function(c){if(c=c.match(b.reHSLa)){var a=(parseFloat(c[1])%360+360)%360/360,f=parseFloat(c[2])/(/%$/.test(c[2])?100:1),d=parseFloat(c[3])/(/%$/.test(c[3])?100:1);if(0===f)d=f=a=d;else var g=.5>=d?d*(f+1):d+f-d*f,z=2*d-g,d=h(z,g,a+1/3),f=h(z,g,a),a=h(z,g,a-1/3);return[Math.round(255*d),Math.round(255*
f),Math.round(255*a),c[4]?parseFloat(c[4]):1]}},g.Color.fromHsla=b.fromHsl,g.Color.fromHex=function(c){return b.fromSource(b.sourceFromHex(c))},g.Color.sourceFromHex=function(c){if(c.match(b.reHex)){var a=c.slice(c.indexOf("#")+1),f=3===a.length;c=f?a.charAt(0)+a.charAt(0):a.substring(0,2);var d=f?a.charAt(1)+a.charAt(1):a.substring(2,4),a=f?a.charAt(2)+a.charAt(2):a.substring(4,6);return[parseInt(c,16),parseInt(d,16),parseInt(a,16),1]}},g.Color.fromSource=function(c){var a=new b;a.setSource(c);return a})})("undefined"!==
typeof b?b:this);(function(){if(a.StaticCanvas)a.warn("fabric.StaticCanvas is already defined.");else{var b=a.util.object.extend,l=a.util.getElementOffset,h=a.util.removeFromArray,g=Error("Could not initialize `canvas` element");a.StaticCanvas=a.util.createClass({initialize:function(c,b){b||(b={});this._initStatic(c,b);a.StaticCanvas.activeInstance=this},backgroundColor:"",backgroundImage:null,overlayColor:"",overlayImage:null,includeDefaultValues:!0,stateful:!0,renderOnAddRemove:!0,clipTo:null,controlsAboveOverlay:!1,
allowTouchScrolling:!1,imageSmoothingEnabled:!0,preserveObjectStacking:!1,viewportTransform:[1,0,0,1,0,0],onBeforeScaleRotate:function(){},_initStatic:function(c,a){this._objects=[];this._createLowerCanvas(c);this._initOptions(a);this._setImageSmoothing();a.overlayImage&&this.setOverlayImage(a.overlayImage,this.renderAll.bind(this));a.backgroundImage&&this.setBackgroundImage(a.backgroundImage,this.renderAll.bind(this));a.backgroundColor&&this.setBackgroundColor(a.backgroundColor,this.renderAll.bind(this));
a.overlayColor&&this.setOverlayColor(a.overlayColor,this.renderAll.bind(this));this.calcOffset()},calcOffset:function(){this._offset=l(this.lowerCanvasEl);return this},setOverlayImage:function(c,a,f){return this.__setBgOverlayImage("overlayImage",c,a,f)},setBackgroundImage:function(c,a,f){return this.__setBgOverlayImage("backgroundImage",c,a,f)},setOverlayColor:function(c,a){return this.__setBgOverlayColor("overlayColor",c,a)},setBackgroundColor:function(c,a){return this.__setBgOverlayColor("backgroundColor",
c,a)},_setImageSmoothing:function(){var c=this.getContext();c.imageSmoothingEnabled=this.imageSmoothingEnabled;c.webkitImageSmoothingEnabled=this.imageSmoothingEnabled;c.mozImageSmoothingEnabled=this.imageSmoothingEnabled;c.msImageSmoothingEnabled=this.imageSmoothingEnabled;c.oImageSmoothingEnabled=this.imageSmoothingEnabled},__setBgOverlayImage:function(c,b,f,d){"string"===typeof b?a.util.loadImage(b,function(b){this[c]=new a.Image(b,d);f&&f()},this,d&&d.crossOrigin):(d&&b.setOptions(d),this[c]=
b,f&&f());return this},__setBgOverlayColor:function(c,b,f){if(b&&b.source){var d=this;a.util.loadImage(b.source,function(g){d[c]=new a.Pattern({source:g,repeat:b.repeat,offsetX:b.offsetX,offsetY:b.offsetY});f&&f()})}else this[c]=b,f&&f();return this},_createCanvasElement:function(){var c=a.document.createElement("canvas");c.style||(c.style={});if(!c)throw g;this._initCanvasElement(c);return c},_initCanvasElement:function(c){a.util.createCanvasElement(c);if("undefined"===typeof c.getContext)throw g;
},_initOptions:function(c){for(var a in c)this[a]=c[a];this.width=this.width||parseInt(this.lowerCanvasEl.width,10)||0;this.height=this.height||parseInt(this.lowerCanvasEl.height,10)||0;this.lowerCanvasEl.style&&(this.lowerCanvasEl.width=this.width,this.lowerCanvasEl.height=this.height,this.lowerCanvasEl.style.width=this.width+"px",this.lowerCanvasEl.style.height=this.height+"px",this.viewportTransform=this.viewportTransform.slice())},_createLowerCanvas:function(c){this.lowerCanvasEl=a.util.getById(c)||
this._createCanvasElement();this._initCanvasElement(this.lowerCanvasEl);a.util.addClass(this.lowerCanvasEl,"lower-canvas");this.interactive&&this._applyCanvasStyle(this.lowerCanvasEl);this.contextContainer=this.lowerCanvasEl.getContext("2d")},getWidth:function(){return this.width},getHeight:function(){return this.height},setWidth:function(c,a){return this.setDimensions({width:c},a)},setHeight:function(c,a){return this.setDimensions({height:c},a)},setDimensions:function(c,a){var f;a=a||{};for(var d in c)f=
c[d],a.cssOnly||(this._setBackstoreDimension(d,c[d]),f+="px"),a.backstoreOnly||this._setCssDimension(d,f);a.cssOnly||this.renderAll();this.calcOffset();return this},_setBackstoreDimension:function(c,a){this.lowerCanvasEl[c]=a;this.upperCanvasEl&&(this.upperCanvasEl[c]=a);this.cacheCanvasEl&&(this.cacheCanvasEl[c]=a);this[c]=a;return this},_setCssDimension:function(c,a){this.lowerCanvasEl.style[c]=a;this.upperCanvasEl&&(this.upperCanvasEl.style[c]=a);this.wrapperEl&&(this.wrapperEl.style[c]=a);return this},
getZoom:function(){return Math.sqrt(this.viewportTransform[0]*this.viewportTransform[3])},setViewportTransform:function(c){var a=this.getActiveGroup();this.viewportTransform=c;this.renderAll();c=0;for(var f=this._objects.length;c<f;c++)this._objects[c].setCoords();a&&a.setCoords();return this},zoomToPoint:function(c,b){var f=c;c=a.util.transformPoint(c,a.util.invertTransform(this.viewportTransform));this.viewportTransform[0]=b;this.viewportTransform[3]=b;c=a.util.transformPoint(c,this.viewportTransform);
this.viewportTransform[4]+=f.x-c.x;this.viewportTransform[5]+=f.y-c.y;this.renderAll();f=0;for(c=this._objects.length;f<c;f++)this._objects[f].setCoords();return this},setZoom:function(c){this.zoomToPoint(new a.Point(0,0),c);return this},absolutePan:function(c){this.viewportTransform[4]=-c.x;this.viewportTransform[5]=-c.y;this.renderAll();c=0;for(var a=this._objects.length;c<a;c++)this._objects[c].setCoords();return this},relativePan:function(c){return this.absolutePan(new a.Point(-c.x-this.viewportTransform[4],
-c.y-this.viewportTransform[5]))},getElement:function(){return this.lowerCanvasEl},getActiveObject:function(){return null},getActiveGroup:function(){return null},_draw:function(c,a){if(a){c.save();var f=this.viewportTransform;c.transform(f[0],f[1],f[2],f[3],f[4],f[5]);this._shouldRenderObject(a)&&a.render(c);c.restore();this.controlsAboveOverlay||a._renderControls(c)}},_shouldRenderObject:function(c){return c?c!==this.getActiveGroup()||!this.preserveObjectStacking:!1},_onObjectAdded:function(c){this.stateful&&
c.setupState();c.canvas=this;c.setCoords();this.fire("object:added",{target:c});c.fire("added")},_onObjectRemoved:function(c){this.getActiveObject()===c&&(this.fire("before:selection:cleared",{target:c}),this._discardActiveObject(),this.fire("selection:cleared"));this.fire("object:removed",{target:c});c.fire("removed")},clearContext:function(c){c.clearRect(0,0,this.width,this.height);return this},getContext:function(){return this.contextContainer},clear:function(){this._objects.length=0;this.discardActiveGroup&&
this.discardActiveGroup();this.discardActiveObject&&this.discardActiveObject();this.clearContext(this.contextContainer);this.contextTop&&this.clearContext(this.contextTop);this.fire("canvas:cleared");this.renderAll();return this},renderAll:function(c){var b=this[!0===c&&this.interactive?"contextTop":"contextContainer"],f=this.getActiveGroup();this.contextTop&&this.selection&&!this._groupSelector&&this.clearContext(this.contextTop);c||this.clearContext(b);this.fire("before:render");this.clipTo&&a.util.clipContext(this,
b);this._renderBackground(b);this._renderObjects(b,f);this._renderActiveGroup(b,f);this.clipTo&&b.restore();this._renderOverlay(b);this.controlsAboveOverlay&&this.interactive&&this.drawControls(b);this.fire("after:render");return this},_renderObjects:function(c,a){var f,d;if(!a||this.preserveObjectStacking)for(f=0,d=this._objects.length;f<d;++f)this._draw(c,this._objects[f]);else for(f=0,d=this._objects.length;f<d;++f)this._objects[f]&&!a.contains(this._objects[f])&&this._draw(c,this._objects[f])},
_renderActiveGroup:function(c,a){if(a){var f=[];this.forEachObject(function(d){a.contains(d)&&f.push(d)});a._set("objects",f);this._draw(c,a)}},_renderBackground:function(c){this.backgroundColor&&(c.fillStyle=this.backgroundColor.toLive?this.backgroundColor.toLive(c):this.backgroundColor,c.fillRect(this.backgroundColor.offsetX||0,this.backgroundColor.offsetY||0,this.width,this.height));this.backgroundImage&&this._draw(c,this.backgroundImage)},_renderOverlay:function(c){this.overlayColor&&(c.fillStyle=
this.overlayColor.toLive?this.overlayColor.toLive(c):this.overlayColor,c.fillRect(this.overlayColor.offsetX||0,this.overlayColor.offsetY||0,this.width,this.height));this.overlayImage&&this._draw(c,this.overlayImage)},renderTop:function(){var c=this.contextTop||this.contextContainer;this.clearContext(c);this.selection&&this._groupSelector&&this._drawSelection();var a=this.getActiveGroup();a&&a.render(c);this._renderOverlay(c);this.fire("after:render");return this},getCenter:function(){return{top:this.getHeight()/
2,left:this.getWidth()/2}},centerObjectH:function(c){this._centerObject(c,new a.Point(this.getCenter().left,c.getCenterPoint().y));this.renderAll();return this},centerObjectV:function(c){this._centerObject(c,new a.Point(c.getCenterPoint().x,this.getCenter().top));this.renderAll();return this},centerObject:function(c){var b=this.getCenter();this._centerObject(c,new a.Point(b.left,b.top));this.renderAll();return this},_centerObject:function(c,a){c.setPositionByOrigin(a,"center","center");return this},
toDatalessJSON:function(c){return this.toDatalessObject(c)},toObject:function(c){return this._toObjectMethod("toObject",c)},toDatalessObject:function(c){return this._toObjectMethod("toDatalessObject",c)},_toObjectMethod:function(c,e){c={objects:this._toObjects(c,e)};b(c,this.__serializeBgOverlay());a.util.populateWithProperties(this,c,e);return c},_toObjects:function(c,a){return this.getObjects().map(function(f){return this._toObject(f,c,a)},this)},_toObject:function(c,a,f){var d;this.includeDefaultValues||
(d=c.includeDefaultValues,c.includeDefaultValues=!1);var b=this._realizeGroupTransformOnObject(c);a=c[a](f);this.includeDefaultValues||(c.includeDefaultValues=d);this._unwindGroupTransformOnObject(c,b);return a},_realizeGroupTransformOnObject:function(c){var a="angle flipX flipY height left scaleX scaleY top width".split(" ");if(c.group&&c.group===this.getActiveGroup()){var f={};a.forEach(function(d){f[d]=c[d]});this.getActiveGroup().realizeTransform(c);return f}return null},_unwindGroupTransformOnObject:function(c,
a){a&&c.set(a)},__serializeBgOverlay:function(){var c={background:this.backgroundColor&&this.backgroundColor.toObject?this.backgroundColor.toObject():this.backgroundColor};this.overlayColor&&(c.overlay=this.overlayColor.toObject?this.overlayColor.toObject():this.overlayColor);this.backgroundImage&&(c.backgroundImage=this.backgroundImage.toObject());this.overlayImage&&(c.overlayImage=this.overlayImage.toObject());return c},svgViewportTransformation:!0,toSVG:function(c,a){c||(c={});var f=[];this._setSVGPreamble(f,
c);this._setSVGHeader(f,c);this._setSVGBgOverlayColor(f,"backgroundColor");this._setSVGBgOverlayImage(f,"backgroundImage");this._setSVGObjects(f,a);this._setSVGBgOverlayColor(f,"overlayColor");this._setSVGBgOverlayImage(f,"overlayImage");f.push("</svg>");return f.join("")},_setSVGPreamble:function(c,a){a.suppressPreamble||c.push('<?xml version="1.0" encoding="',a.encoding||"UTF-8",'" standalone="no" ?>','<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ','"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">\n')},
_setSVGHeader:function(c,b){var f,d,g;b.viewBox?(f=b.viewBox.width,d=b.viewBox.height):(f=this.width,d=this.height,this.svgViewportTransformation||(g=this.viewportTransform,f/=g[0],d/=g[3]));c.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',f,'" ','height="',d,'" ',this.backgroundColor&&!this.backgroundColor.toLive?'style="background-color: '+this.backgroundColor+'" ':null,b.viewBox?'viewBox="'+b.viewBox.x+" "+b.viewBox.y+
" "+b.viewBox.width+" "+b.viewBox.height+'" ':null,'xml:space="preserve">',"<desc>Created with Fabric.js ",a.version,"</desc>","<defs>",a.createSVGFontFacesMarkup(this.getObjects()),a.createSVGRefElementsMarkup(this),"</defs>")},_setSVGObjects:function(c,a){for(var f=0,d=this.getObjects(),b=d.length;f<b;f++){var g=d[f],l=this._realizeGroupTransformOnObject(g);c.push(g.toSVG(a));this._unwindGroupTransformOnObject(g,l)}},_setSVGBgOverlayImage:function(c,a){this[a]&&this[a].toSVG&&c.push(this[a].toSVG())},
_setSVGBgOverlayColor:function(c,a){this[a]&&this[a].source?c.push('<rect x="',this[a].offsetX,'" y="',this[a].offsetY,'" ','width="',"repeat-y"===this[a].repeat||"no-repeat"===this[a].repeat?this[a].source.width:this.width,'" height="',"repeat-x"===this[a].repeat||"no-repeat"===this[a].repeat?this[a].source.height:this.height,'" fill="url(#'+a+'Pattern)"',"></rect>"):this[a]&&"overlayColor"===a&&c.push('<rect x="0" y="0" ','width="',this.width,'" height="',this.height,'" fill="',this[a],'"',"></rect>")},
sendToBack:function(a){h(this._objects,a);this._objects.unshift(a);return this.renderAll&&this.renderAll()},bringToFront:function(a){h(this._objects,a);this._objects.push(a);return this.renderAll&&this.renderAll()},sendBackwards:function(a,b){var f=this._objects.indexOf(a);0!==f&&(b=this._findNewLowerIndex(a,f,b),h(this._objects,a),this._objects.splice(b,0,a),this.renderAll&&this.renderAll());return this},_findNewLowerIndex:function(a,b,f){if(f)for(f=b,--b;0<=b;--b){if(a.intersectsWithObject(this._objects[b])||
a.isContainedWithinObject(this._objects[b])||this._objects[b].isContainedWithinObject(a)){f=b;break}}else f=b-1;return f},bringForward:function(a,b){var f=this._objects.indexOf(a);f!==this._objects.length-1&&(b=this._findNewUpperIndex(a,f,b),h(this._objects,a),this._objects.splice(b,0,a),this.renderAll&&this.renderAll());return this},_findNewUpperIndex:function(a,b,f){if(f)for(f=b,b+=1;b<this._objects.length;++b){if(a.intersectsWithObject(this._objects[b])||a.isContainedWithinObject(this._objects[b])||
this._objects[b].isContainedWithinObject(a)){f=b;break}}else f=b+1;return f},moveTo:function(a,b){h(this._objects,a);this._objects.splice(b,0,a);return this.renderAll&&this.renderAll()},dispose:function(){this.clear();this.interactive&&this.removeListeners();return this},toString:function(){return"#<fabric.Canvas ("+this.complexity()+"): { objects: "+this.getObjects().length+" }>"}});b(a.StaticCanvas.prototype,a.Observable);b(a.StaticCanvas.prototype,a.Collection);b(a.StaticCanvas.prototype,a.DataURLExporter);
b(a.StaticCanvas,{EMPTY_JSON:'{"objects": [], "background": "white"}',supports:function(c){var b=a.util.createCanvasElement();if(!b||!b.getContext)return null;var f=b.getContext("2d");if(!f)return null;switch(c){case "getImageData":return"undefined"!==typeof f.getImageData;case "setLineDash":return"undefined"!==typeof f.setLineDash;case "toDataURL":return"undefined"!==typeof b.toDataURL;case "toDataURLWithQuality":try{return b.toDataURL("image/jpeg",0),!0}catch(d){}return!1;default:return null}}});
a.StaticCanvas.prototype.toJSON=a.StaticCanvas.prototype.toObject}})();(function(){var b=a.util.getPointer,l=a.util.degreesToRadians,h=a.util.radiansToDegrees,g=Math.atan2,c=Math.abs;a.Canvas=a.util.createClass(a.StaticCanvas,{initialize:function(f,d){d||(d={});this._initStatic(f,d);this._initInteractive();this._createCacheCanvas();a.Canvas.activeInstance=this},uniScaleTransform:!1,centeredScaling:!1,centeredRotation:!1,interactive:!0,selection:!0,selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],
selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",rotationCursor:"crosshair",containerClass:"canvas-container",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,_initInteractive:function(){this._groupSelector=this._currentTransform=null;this._initWrapperElement();this._createUpperCanvas();this._initEventListeners();this.freeDrawingBrush=a.PencilBrush&&new a.PencilBrush(this);this.calcOffset()},
_resetCurrentTransform:function(a){var d=this._currentTransform;d.target.set({scaleX:d.original.scaleX,scaleY:d.original.scaleY,left:d.original.left,top:d.original.top});this._shouldCenterTransform(a,d.target)?"rotate"===d.action?this._setOriginToCenter(d.target):("center"!==d.originX&&(d.mouseXSign="right"===d.originX?-1:1),"center"!==d.originY&&(d.mouseYSign="bottom"===d.originY?-1:1),d.originX="center",d.originY="center"):(d.originX=d.original.originX,d.originY=d.original.originY)},containsPoint:function(a,
d){a=this.getPointer(a,!0);var c=this._normalizePointer(d,a);return d.containsPoint(c)||d._findTargetCorner(a)},_normalizePointer:function(c,d){var b=this.getActiveGroup(),e=d.x;d=d.y;b&&"group"!==c.type&&b.contains(c)&&(c=new a.Point(b.left,b.top),c=a.util.transformPoint(c,this.viewportTransform,!0),e-=c.x,d-=c.y);return{x:e,y:d}},isTargetTransparent:function(c,d,b){var e=c.hasBorders,g=c.transparentCorners;c.hasBorders=c.transparentCorners=!1;this._draw(this.contextCache,c);c.hasBorders=e;c.transparentCorners=
g;c=a.util.isTransparent(this.contextCache,d,b,this.targetFindTolerance);this.clearContext(this.contextCache);return c},_shouldClearSelection:function(a,d){var c=this.getActiveGroup(),b=this.getActiveObject();return!d||d&&c&&!c.contains(d)&&c!==d&&!a.shiftKey||d&&!d.evented||d&&!d.selectable&&b&&b!==d},_shouldCenterTransform:function(a,d){if(d){var c=this._currentTransform,b;"scale"===c.action||"scaleX"===c.action||"scaleY"===c.action?b=this.centeredScaling||d.centeredScaling:"rotate"===c.action&&
(b=this.centeredRotation||d.centeredRotation);return b?!a.altKey:a.altKey}},_getOriginFromCorner:function(a,d){a={x:a.originX,y:a.originY};if("ml"===d||"tl"===d||"bl"===d)a.x="right";else if("mr"===d||"tr"===d||"br"===d)a.x="left";if("tl"===d||"mt"===d||"tr"===d)a.y="bottom";else if("bl"===d||"mb"===d||"br"===d)a.y="top";return a},_getActionFromCorner:function(a,d){a="drag";d&&(a="ml"===d||"mr"===d?"scaleX":"mt"===d||"mb"===d?"scaleY":"mtr"===d?"rotate":"scale");return a},_setupCurrentTransform:function(a,
d){if(d){var c=this.getPointer(a),b=d._findTargetCorner(this.getPointer(a,!0)),e=this._getActionFromCorner(d,b),b=this._getOriginFromCorner(d,b);this._currentTransform={target:d,action:e,scaleX:d.scaleX,scaleY:d.scaleY,offsetX:c.x-d.left,offsetY:c.y-d.top,originX:b.x,originY:b.y,ex:c.x,ey:c.y,left:d.left,top:d.top,theta:l(d.angle),width:d.width*d.scaleX,mouseXSign:1,mouseYSign:1};this._currentTransform.original={left:d.left,top:d.top,scaleX:d.scaleX,scaleY:d.scaleY,originX:b.x,originY:b.y};this._resetCurrentTransform(a)}},
_translateObject:function(a,d){var c=this._currentTransform.target;c.get("lockMovementX")||c.set("left",a-this._currentTransform.offsetX);c.get("lockMovementY")||c.set("top",d-this._currentTransform.offsetY)},_scaleObject:function(c,d,b){var e=this._currentTransform,g=e.target,l=g.get("lockScalingX"),h=g.get("lockScalingY"),p=g.get("lockScalingFlip");if(!l||!h){var k=g.translateToOriginPoint(g.getCenterPoint(),e.originX,e.originY);c=g.toLocalPoint(new a.Point(c,d),e.originX,e.originY);this._setLocalMouse(c,
e);this._setObjectScale(c,e,l,h,b,p);g.setPositionByOrigin(k,e.originX,e.originY)}},_setObjectScale:function(a,d,c,b,e,g){var l=d.target,h=!1,p=!1,k=l.stroke?l.strokeWidth:0;d.newScaleX=a.x/(l.width+k/2);d.newScaleY=a.y/(l.height+k/2);g&&0>=d.newScaleX&&d.newScaleX<l.scaleX&&(h=!0);g&&0>=d.newScaleY&&d.newScaleY<l.scaleY&&(p=!0);"equally"!==e||c||b?e?"x"!==e||l.get("lockUniScaling")?"y"!==e||l.get("lockUniScaling")||p||b||l.set("scaleY",d.newScaleY):h||c||l.set("scaleX",d.newScaleX):(h||c||l.set("scaleX",
d.newScaleX),p||b||l.set("scaleY",d.newScaleY)):h||p||this._scaleObjectEqually(a,l,d);h||p||this._flipObject(d,e)},_scaleObjectEqually:function(a,d,c){a=a.y+a.x;var b=d.stroke?d.strokeWidth:0,b=(d.height+b/2)*c.original.scaleY+(d.width+b/2)*c.original.scaleX;c.newScaleX=c.original.scaleX*a/b;c.newScaleY=c.original.scaleY*a/b;d.set("scaleX",c.newScaleX);d.set("scaleY",c.newScaleY)},_flipObject:function(a,d){0>a.newScaleX&&"y"!==d&&("left"===a.originX?a.originX="right":"right"===a.originX&&(a.originX=
"left"));0>a.newScaleY&&"x"!==d&&("top"===a.originY?a.originY="bottom":"bottom"===a.originY&&(a.originY="top"))},_setLocalMouse:function(a,d){var b=d.target;"right"===d.originX?a.x*=-1:"center"===d.originX&&(a.x=2*a.x*d.mouseXSign,0>a.x&&(d.mouseXSign=-d.mouseXSign));"bottom"===d.originY?a.y*=-1:"center"===d.originY&&(a.y=2*a.y*d.mouseYSign,0>a.y&&(d.mouseYSign=-d.mouseYSign));c(a.x)>b.padding?a.x=0>a.x?a.x+b.padding:a.x-b.padding:a.x=0;c(a.y)>b.padding?a.y=0>a.y?a.y+b.padding:a.y-b.padding:a.y=0},
_rotateObject:function(a,d){var c=this._currentTransform;if(!c.target.get("lockRotation")){var b=g(c.ey-c.top,c.ex-c.left);a=g(d-c.top,a-c.left);b=h(a-b+c.theta);0>b&&(b=360+b);c.target.angle=b%360}},setCursor:function(a){this.upperCanvasEl.style.cursor=a},_resetObjectTransform:function(a){a.scaleX=1;a.scaleY=1;a.setAngle(0)},_drawSelection:function(){var f=this.contextTop,d=this._groupSelector,b=d.left,e=d.top,g=c(b),l=c(e);f.fillStyle=this.selectionColor;f.fillRect(d.ex-(0<b?0:-b),d.ey-(0<e?0:-e),
g,l);f.lineWidth=this.selectionLineWidth;f.strokeStyle=this.selectionBorderColor;1<this.selectionDashArray.length?(b=d.ex+.5-(0<b?0:g),d=d.ey+.5-(0<e?0:l),f.beginPath(),a.util.drawDashedLine(f,b,d,b+g,d,this.selectionDashArray),a.util.drawDashedLine(f,b,d+l-1,b+g,d+l-1,this.selectionDashArray),a.util.drawDashedLine(f,b,d,b,d+l,this.selectionDashArray),a.util.drawDashedLine(f,b+g-1,d,b+g-1,d+l,this.selectionDashArray),f.closePath(),f.stroke()):f.strokeRect(d.ex+.5-(0<b?0:g),d.ey+.5-(0<e?0:l),g,l)},
_isLastRenderedObject:function(a){return this.controlsAboveOverlay&&this.lastRenderedObjectWithControlsAboveOverlay&&this.lastRenderedObjectWithControlsAboveOverlay.visible&&this.containsPoint(a,this.lastRenderedObjectWithControlsAboveOverlay)&&this.lastRenderedObjectWithControlsAboveOverlay._findTargetCorner(this.getPointer(a,!0))},findTarget:function(a,d){if(!this.skipTargetFind){if(this._isLastRenderedObject(a))return this.lastRenderedObjectWithControlsAboveOverlay;var c=this.getActiveGroup();
if(c&&!d&&this.containsPoint(a,c))return c;a=this._searchPossibleTargets(a);this._fireOverOutEvents(a);return a}},_fireOverOutEvents:function(a){a?this._hoveredTarget!==a&&(this.fire("mouse:over",{target:a}),a.fire("mouseover"),this._hoveredTarget&&(this.fire("mouse:out",{target:this._hoveredTarget}),this._hoveredTarget.fire("mouseout")),this._hoveredTarget=a):this._hoveredTarget&&(this.fire("mouse:out",{target:this._hoveredTarget}),this._hoveredTarget.fire("mouseout"),this._hoveredTarget=null)},
_checkTarget:function(a,d,c){if(d&&d.visible&&d.evented&&this.containsPoint(a,d)&&(!this.perPixelTargetFind&&!d.perPixelTargetFind||d.isEditing||!this.isTargetTransparent(d,c.x,c.y)))return!0},_searchPossibleTargets:function(a){for(var d,c=this.getPointer(a,!0),b=this._objects.length;b--;)if(!this._objects[b].group&&this._checkTarget(a,this._objects[b],c)){this.relatedTarget=this._objects[b];d=this._objects[b];break}return d},getPointer:function(c,d,e){e||(e=this.upperCanvasEl);c=b(c,e);var g=e.getBoundingClientRect(),
l=g.width||0,h=g.height||0;l&&h||("top"in g&&"bottom"in g&&(h=Math.abs(g.top-g.bottom)),"right"in g&&"left"in g&&(l=Math.abs(g.right-g.left)));this.calcOffset();c.x-=this._offset.left;c.y-=this._offset.top;d||(c=a.util.transformPoint(c,a.util.invertTransform(this.viewportTransform)));0===l||0===h?e=d=1:(d=e.width/l,e=e.height/h);return{x:c.x*d,y:c.y*e}},_createUpperCanvas:function(){var c=this.lowerCanvasEl.className.replace(/\s*lower-canvas\s*/,"");this.upperCanvasEl=this._createCanvasElement();
a.util.addClass(this.upperCanvasEl,"upper-canvas "+c);this.wrapperEl.appendChild(this.upperCanvasEl);this._copyCanvasStyle(this.lowerCanvasEl,this.upperCanvasEl);this._applyCanvasStyle(this.upperCanvasEl);this.contextTop=this.upperCanvasEl.getContext("2d")},_createCacheCanvas:function(){this.cacheCanvasEl=this._createCanvasElement();this.cacheCanvasEl.setAttribute("width",this.width);this.cacheCanvasEl.setAttribute("height",this.height);this.contextCache=this.cacheCanvasEl.getContext("2d")},_initWrapperElement:function(){this.wrapperEl=
a.util.wrapElement(this.lowerCanvasEl,"div",{"class":this.containerClass});a.util.setStyle(this.wrapperEl,{width:this.getWidth()+"px",height:this.getHeight()+"px",position:"relative"});a.util.makeElementUnselectable(this.wrapperEl)},_applyCanvasStyle:function(c){var d=this.getWidth()||c.width,b=this.getHeight()||c.height;a.util.setStyle(c,{position:"absolute",width:d+"px",height:b+"px",left:0,top:0});c.width=d;c.height=b;a.util.makeElementUnselectable(c)},_copyCanvasStyle:function(a,d){d.style.cssText=
a.style.cssText},getSelectionContext:function(){return this.contextTop},getSelectionElement:function(){return this.upperCanvasEl},_setActiveObject:function(a){this._activeObject&&this._activeObject.set("active",!1);this._activeObject=a;a.set("active",!0)},setActiveObject:function(a,d){this._setActiveObject(a);this.renderAll();this.fire("object:selected",{target:a,e:d});a.fire("selected",{e:d});return this},getActiveObject:function(){return this._activeObject},_discardActiveObject:function(){this._activeObject&&
this._activeObject.set("active",!1);this._activeObject=null},discardActiveObject:function(a){this._discardActiveObject();this.renderAll();this.fire("selection:cleared",{e:a});return this},_setActiveGroup:function(a){(this._activeGroup=a)&&a.set("active",!0)},setActiveGroup:function(a,d){this._setActiveGroup(a);a&&(this.fire("object:selected",{target:a,e:d}),a.fire("selected",{e:d}));return this},getActiveGroup:function(){return this._activeGroup},_discardActiveGroup:function(){var a=this.getActiveGroup();
a&&a.destroy();this.setActiveGroup(null)},discardActiveGroup:function(a){this._discardActiveGroup();this.fire("selection:cleared",{e:a});return this},deactivateAll:function(){for(var a=this.getObjects(),d=0,c=a.length;d<c;d++)a[d].set("active",!1);this._discardActiveGroup();this._discardActiveObject();return this},deactivateAllWithDispatch:function(a){var d=this.getActiveGroup()||this.getActiveObject();d&&this.fire("before:selection:cleared",{target:d,e:a});this.deactivateAll();d&&this.fire("selection:cleared",
{e:a});return this},drawControls:function(a){var d=this.getActiveGroup();d?this._drawGroupControls(a,d):this._drawObjectsControls(a)},_drawGroupControls:function(a,d){d._renderControls(a)},_drawObjectsControls:function(a){for(var d=0,c=this._objects.length;d<c;++d)this._objects[d]&&this._objects[d].active&&(this._objects[d]._renderControls(a),this.lastRenderedObjectWithControlsAboveOverlay=this._objects[d])}});for(var e in a.StaticCanvas)"prototype"!==e&&(a.Canvas[e]=a.StaticCanvas[e]);a.isTouchSupported&&
(a.Canvas.prototype._setCursorFromEvent=function(){});a.Element=a.Canvas})();(function(){var b={mt:0,tr:1,mr:2,br:3,mb:4,bl:5,ml:6,tl:7},l=a.util.addListener,h=a.util.removeListener;a.util.object.extend(a.Canvas.prototype,{cursorMap:"n-resize ne-resize e-resize se-resize s-resize sw-resize w-resize nw-resize".split(" "),_initEventListeners:function(){this._bindEvents();l(a.window,"resize",this._onResize);l(this.upperCanvasEl,"mousedown",this._onMouseDown);l(this.upperCanvasEl,"mousemove",this._onMouseMove);
l(this.upperCanvasEl,"mousewheel",this._onMouseWheel);l(this.upperCanvasEl,"touchstart",this._onMouseDown);l(this.upperCanvasEl,"touchmove",this._onMouseMove);"undefined"!==typeof eventjs&&"add"in eventjs&&(eventjs.add(this.upperCanvasEl,"gesture",this._onGesture),eventjs.add(this.upperCanvasEl,"drag",this._onDrag),eventjs.add(this.upperCanvasEl,"orientation",this._onOrientationChange),eventjs.add(this.upperCanvasEl,"shake",this._onShake),eventjs.add(this.upperCanvasEl,"longpress",this._onLongPress))},
_bindEvents:function(){this._onMouseDown=this._onMouseDown.bind(this);this._onMouseMove=this._onMouseMove.bind(this);this._onMouseUp=this._onMouseUp.bind(this);this._onResize=this._onResize.bind(this);this._onGesture=this._onGesture.bind(this);this._onDrag=this._onDrag.bind(this);this._onShake=this._onShake.bind(this);this._onLongPress=this._onLongPress.bind(this);this._onOrientationChange=this._onOrientationChange.bind(this);this._onMouseWheel=this._onMouseWheel.bind(this)},removeListeners:function(){h(a.window,
"resize",this._onResize);h(this.upperCanvasEl,"mousedown",this._onMouseDown);h(this.upperCanvasEl,"mousemove",this._onMouseMove);h(this.upperCanvasEl,"mousewheel",this._onMouseWheel);h(this.upperCanvasEl,"touchstart",this._onMouseDown);h(this.upperCanvasEl,"touchmove",this._onMouseMove);"undefined"!==typeof eventjs&&"remove"in eventjs&&(eventjs.remove(this.upperCanvasEl,"gesture",this._onGesture),eventjs.remove(this.upperCanvasEl,"drag",this._onDrag),eventjs.remove(this.upperCanvasEl,"orientation",
this._onOrientationChange),eventjs.remove(this.upperCanvasEl,"shake",this._onShake),eventjs.remove(this.upperCanvasEl,"longpress",this._onLongPress))},_onGesture:function(a,c){this.__onTransformGesture&&this.__onTransformGesture(a,c)},_onDrag:function(a,c){this.__onDrag&&this.__onDrag(a,c)},_onMouseWheel:function(a,c){this.__onMouseWheel&&this.__onMouseWheel(a,c)},_onOrientationChange:function(a,c){this.__onOrientationChange&&this.__onOrientationChange(a,c)},_onShake:function(a,c){this.__onShake&&
this.__onShake(a,c)},_onLongPress:function(a,c){this.__onLongPress&&this.__onLongPress(a,c)},_onMouseDown:function(b){this.__onMouseDown(b);l(a.document,"touchend",this._onMouseUp);l(a.document,"touchmove",this._onMouseMove);h(this.upperCanvasEl,"mousemove",this._onMouseMove);h(this.upperCanvasEl,"touchmove",this._onMouseMove);"touchstart"===b.type?h(this.upperCanvasEl,"mousedown",this._onMouseDown):(l(a.document,"mouseup",this._onMouseUp),l(a.document,"mousemove",this._onMouseMove))},_onMouseUp:function(b){this.__onMouseUp(b);
h(a.document,"mouseup",this._onMouseUp);h(a.document,"touchend",this._onMouseUp);h(a.document,"mousemove",this._onMouseMove);h(a.document,"touchmove",this._onMouseMove);l(this.upperCanvasEl,"mousemove",this._onMouseMove);l(this.upperCanvasEl,"touchmove",this._onMouseMove);if("touchend"===b.type){var c=this;setTimeout(function(){l(c.upperCanvasEl,"mousedown",c._onMouseDown)},400)}},_onMouseMove:function(a){!this.allowTouchScrolling&&a.preventDefault&&a.preventDefault();this.__onMouseMove(a)},_onResize:function(){this.calcOffset()},
_shouldRender:function(a,c){var b=this.getActiveGroup()||this.getActiveObject();return!!(a&&(a.isMoving||a!==b)||!a&&b||!a&&!b&&!this._groupSelector||c&&this._previousPointer&&this.selection&&(c.x!==this._previousPointer.x||c.y!==this._previousPointer.y))},__onMouseUp:function(a){var c;if(this.isDrawingMode&&this._isCurrentlyDrawing)this._onMouseUpInDrawingMode(a);else{this._currentTransform?(this._finalizeCurrentTransform(),c=this._currentTransform.target):c=this.findTarget(a,!0);var b=this._shouldRender(c,
this.getPointer(a));this._maybeGroupObjects(a);c&&(c.isMoving=!1);b&&this.renderAll();this._handleCursorAndEvent(a,c)}},_handleCursorAndEvent:function(a,c){this._setCursorFromEvent(a,c);var b=this;setTimeout(function(){b._setCursorFromEvent(a,c)},50);this.fire("mouse:up",{target:c,e:a});c&&c.fire("mouseup",{e:a})},_finalizeCurrentTransform:function(){var a=this._currentTransform.target;a._scaling&&(a._scaling=!1);a.setCoords();this.stateful&&a.hasStateChanged()&&(this.fire("object:modified",{target:a}),
a.fire("modified"));this._restoreOriginXY(a)},_restoreOriginXY:function(a){if(this._previousOriginX&&this._previousOriginY){var c=a.translateToOriginPoint(a.getCenterPoint(),this._previousOriginX,this._previousOriginY);a.originX=this._previousOriginX;a.originY=this._previousOriginY;a.left=c.x;a.top=c.y;this._previousOriginY=this._previousOriginX=null}},_onMouseDownInDrawingMode:function(b){this._isCurrentlyDrawing=!0;this.discardActiveObject(b).renderAll();this.clipTo&&a.util.clipContext(this,this.contextTop);
var c=a.util.invertTransform(this.viewportTransform),c=a.util.transformPoint(this.getPointer(b,!0),c);this.freeDrawingBrush.onMouseDown(c);this.fire("mouse:down",{e:b});c=this.findTarget(b);"undefined"!==typeof c&&c.fire("mousedown",{e:b,target:c})},_onMouseMoveInDrawingMode:function(b){if(this._isCurrentlyDrawing){var c=a.util.invertTransform(this.viewportTransform),c=a.util.transformPoint(this.getPointer(b,!0),c);this.freeDrawingBrush.onMouseMove(c)}this.setCursor(this.freeDrawingCursor);this.fire("mouse:move",
{e:b});c=this.findTarget(b);"undefined"!==typeof c&&c.fire("mousemove",{e:b,target:c})},_onMouseUpInDrawingMode:function(a){this._isCurrentlyDrawing=!1;this.clipTo&&this.contextTop.restore();this.freeDrawingBrush.onMouseUp();this.fire("mouse:up",{e:a});var c=this.findTarget(a);"undefined"!==typeof c&&c.fire("mouseup",{e:a,target:c})},__onMouseDown:function(b){if(("which"in b?1===b.which:1===b.button)||a.isTouchSupported)if(this.isDrawingMode)this._onMouseDownInDrawingMode(b);else if(!this._currentTransform){var c=
this.findTarget(b),e=this.getPointer(b,!0);this._previousPointer=e;var f=this._shouldRender(c,e),d=this._shouldGroup(b,c);this._shouldClearSelection(b,c)?this._clearSelection(b,c,e):d&&(this._handleGrouping(b,c),c=this.getActiveGroup());c&&c.selectable&&!d&&(this._beforeTransform(b,c),this._setupCurrentTransform(b,c));f&&this.renderAll();this.fire("mouse:down",{target:c,e:b});c&&c.fire("mousedown",{e:b})}},_beforeTransform:function(a,c){this.stateful&&c.saveState();if(c._findTargetCorner(this.getPointer(a)))this.onBeforeScaleRotate(c);
c!==this.getActiveGroup()&&c!==this.getActiveObject()&&(this.deactivateAll(),this.setActiveObject(c,a))},_clearSelection:function(a,c,b){this.deactivateAllWithDispatch(a);c&&c.selectable?this.setActiveObject(c,a):this.selection&&(this._groupSelector={ex:b.x,ey:b.y,top:0,left:0})},_setOriginToCenter:function(a){this._previousOriginX=this._currentTransform.target.originX;this._previousOriginY=this._currentTransform.target.originY;var c=a.getCenterPoint();a.originX="center";a.originY="center";a.left=
c.x;a.top=c.y;this._currentTransform.left=a.left;this._currentTransform.top=a.top},_setCenterToOrigin:function(a){var c=a.translateToOriginPoint(a.getCenterPoint(),this._previousOriginX,this._previousOriginY);a.originX=this._previousOriginX;a.originY=this._previousOriginY;a.left=c.x;a.top=c.y;this._previousOriginY=this._previousOriginX=null},__onMouseMove:function(a){var c,b;if(this.isDrawingMode)this._onMouseMoveInDrawingMode(a);else if(!("undefined"!==typeof a.touches&&1<a.touches.length)){var f=
this._groupSelector;f?(b=this.getPointer(a,!0),f.left=b.x-f.ex,f.top=b.y-f.ey,this.renderTop()):this._currentTransform?this._transformObject(a):(c=this.findTarget(a),!c||c&&!c.selectable?this.setCursor(this.defaultCursor):this._setCursorFromEvent(a,c));this.fire("mouse:move",{target:c,e:a});c&&c.fire("mousemove",{e:a})}},_transformObject:function(a){var c=this.getPointer(a),b=this._currentTransform;b.reset=!1;b.target.isMoving=!0;this._beforeScaleTransform(a,b);this._performTransformAction(a,b,c);
this.renderAll()},_performTransformAction:function(a,c,b){var f=b.x;b=b.y;var d=c.target,l=c.action;"rotate"===l?(this._rotateObject(f,b),this._fire("rotating",d,a)):"scale"===l?(this._onScale(a,c,f,b),this._fire("scaling",d,a)):"scaleX"===l?(this._scaleObject(f,b,"x"),this._fire("scaling",d,a)):"scaleY"===l?(this._scaleObject(f,b,"y"),this._fire("scaling",d,a)):(this._translateObject(f,b),this._fire("moving",d,a),this.setCursor(this.moveCursor))},_fire:function(a,c,b){this.fire("object:"+a,{target:c,
e:b});c.fire(a,{e:b})},_beforeScaleTransform:function(a,c){if("scale"===c.action||"scaleX"===c.action||"scaleY"===c.action){var b=this._shouldCenterTransform(a,c.target);if(b&&("center"!==c.originX||"center"!==c.originY)||!b&&"center"===c.originX&&"center"===c.originY)this._resetCurrentTransform(a),c.reset=!0}},_onScale:function(a,c,b,f){!a.shiftKey&&!this.uniScaleTransform||c.target.get("lockUniScaling")?(c.reset||"scale"!==c.currentAction||this._resetCurrentTransform(a,c.target),c.currentAction=
"scaleEqually",this._scaleObject(b,f,"equally")):(c.currentAction="scale",this._scaleObject(b,f))},_setCursorFromEvent:function(a,c){if(c&&c.selectable){var b=this.getActiveGroup();(a=c._findTargetCorner&&(!b||!b.contains(c))&&c._findTargetCorner(this.getPointer(a,!0)))?this._setCornerCursor(a,c):this.setCursor(c.hoverCursor||this.hoverCursor)}else return this.setCursor(this.defaultCursor),!1;return!0},_setCornerCursor:function(a,c){if(a in b)this.setCursor(this._getRotatedCornerCursor(a,c));else if("mtr"===
a&&c.hasRotatingPoint)this.setCursor(this.rotationCursor);else return this.setCursor(this.defaultCursor),!1},_getRotatedCornerCursor:function(a,c){c=Math.round(c.getAngle()%360/45);0>c&&(c+=8);c+=b[a];return this.cursorMap[c%8]}})})();(function(){var b=Math.min,l=Math.max;a.util.object.extend(a.Canvas.prototype,{_shouldGroup:function(a,b){var c=this.getActiveObject();return a.shiftKey&&(this.getActiveGroup()||c&&c!==b)&&this.selection},_handleGrouping:function(a,b){if(b===this.getActiveGroup()&&(b=
this.findTarget(a,!0),!b||b.isType("group")))return;this.getActiveGroup()?this._updateActiveGroup(b,a):this._createActiveGroup(b,a);this._activeGroup&&this._activeGroup.saveCoords()},_updateActiveGroup:function(a,b){var c=this.getActiveGroup();if(c.contains(a)){if(c.removeWithUpdate(a),this._resetObjectTransform(c),a.set("active",!1),1===c.size()){this.discardActiveGroup(b);this.setActiveObject(c.item(0));return}}else c.addWithUpdate(a),this._resetObjectTransform(c);this.fire("selection:created",
{target:c,e:b});c.set("active",!0)},_createActiveGroup:function(a,b){if(this._activeObject&&a!==this._activeObject){var c=this._createGroup(a);c.addWithUpdate();this.setActiveGroup(c);this._activeObject=null;this.fire("selection:created",{target:c,e:b})}a.set("active",!0)},_createGroup:function(b){var l=this.getObjects();b=l.indexOf(this._activeObject)<l.indexOf(b)?[this._activeObject,b]:[b,this._activeObject];return new a.Group(b,{canvas:this})},_groupSelectedObjects:function(b){var l=this._collectObjects();
1===l.length?this.setActiveObject(l[0],b):1<l.length&&(l=new a.Group(l.reverse(),{canvas:this}),l.addWithUpdate(),this.setActiveGroup(l,b),l.saveCoords(),this.fire("selection:created",{target:l}),this.renderAll())},_collectObjects:function(){var h=[],g;g=this._groupSelector.ex;for(var c=this._groupSelector.ey,e=g+this._groupSelector.left,f=c+this._groupSelector.top,d=new a.Point(b(g,e),b(c,f)),t=new a.Point(l(g,e),l(c,f)),c=g===e&&c===f,e=this._objects.length;e--&&!((g=this._objects[e])&&g.selectable&&
g.visible&&(g.intersectsWithRect(d,t)||g.isContainedWithinRect(d,t)||g.containsPoint(d)||g.containsPoint(t))&&(g.set("active",!0),h.push(g),c)););return h},_maybeGroupObjects:function(a){this.selection&&this._groupSelector&&this._groupSelectedObjects(a);if(a=this.getActiveGroup())a.setObjectsCoords().setCoords(),a.isMoving=!1,this.setCursor(this.defaultCursor);this._currentTransform=this._groupSelector=null}})})();a.util.object.extend(a.StaticCanvas.prototype,{toDataURL:function(a){a||(a={});var b=
a.format||"png",h=a.quality||1,g=a.multiplier||1;a={left:a.left,top:a.top,width:a.width,height:a.height};return 1!==g?this.__toDataURLWithMultiplier(b,h,a,g):this.__toDataURL(b,h,a)},__toDataURL:function(b,l,h){this.renderAll(!0);var g=this.upperCanvasEl||this.lowerCanvasEl;h=this.__getCroppedCanvas(g,h);"jpg"===b&&(b="jpeg");b=a.StaticCanvas.supports("toDataURLWithQuality")?(h||g).toDataURL("image/"+b,l):(h||g).toDataURL("image/"+b);this.contextTop&&this.clearContext(this.contextTop);this.renderAll();
return b},__getCroppedCanvas:function(b,l){var h,g;if("left"in l||"top"in l||"width"in l||"height"in l)h=a.util.createCanvasElement(),g=h.getContext("2d"),h.width=l.width||this.width,h.height=l.height||this.height,g.drawImage(b,-l.left||0,-l.top||0);return h},__toDataURLWithMultiplier:function(a,b,h,g){var c=this.getWidth(),e=this.getHeight(),f=c*g,d=e*g,t=this.getActiveObject(),z=this.getActiveGroup(),A=this.contextTop||this.contextContainer;1<g&&this.setWidth(f).setHeight(d);A.scale(g,g);h.left&&
(h.left*=g);h.top&&(h.top*=g);h.width?h.width*=g:1>g&&(h.width=f);h.height?h.height*=g:1>g&&(h.height=d);z?this._tempRemoveBordersControlsFromGroup(z):t&&this.deactivateAll&&this.deactivateAll();this.renderAll(!0);a=this.__toDataURL(a,b,h);this.width=c;this.height=e;A.scale(1/g,1/g);this.setWidth(c).setHeight(e);z?this._restoreBordersControlsOnGroup(z):t&&this.setActiveObject&&this.setActiveObject(t);this.contextTop&&this.clearContext(this.contextTop);this.renderAll();return a},toDataURLWithMultiplier:function(a,
b,h){return this.toDataURL({format:a,multiplier:b,quality:h})},_tempRemoveBordersControlsFromGroup:function(a){a.origHasControls=a.hasControls;a.origBorderColor=a.borderColor;a.hasControls=!0;a.borderColor="rgba(0,0,0,0)";a.forEachObject(function(a){a.origBorderColor=a.borderColor;a.borderColor="rgba(0,0,0,0)"})},_restoreBordersControlsOnGroup:function(a){a.hideControls=a.origHideControls;a.borderColor=a.origBorderColor;a.forEachObject(function(a){a.borderColor=a.origBorderColor;delete a.origBorderColor})}});
(function(a){var b=a.fabric||(a.fabric={});a=b.util.object.extend;var h=b.util.toFixed,g=b.util.string.capitalize,c=b.util.degreesToRadians,e=b.StaticCanvas.supports("setLineDash");b.Object||(b.Object=b.util.createClass({type:"object",originX:"left",originY:"top",top:0,left:0,width:0,height:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1,opacity:1,angle:0,cornerSize:12,transparentCorners:!0,hoverCursor:null,padding:0,borderColor:"rgba(102,153,255,0.75)",cornerColor:"rgba(102,153,255,0.5)",centeredScaling:!1,
centeredRotation:!0,fill:"rgb(0,0,0)",fillRule:"nonzero",globalCompositeOperation:"source-over",backgroundColor:"",stroke:null,strokeWidth:1,strokeDashArray:null,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:10,shadow:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,transformMatrix:null,minScaleLimit:.01,selectable:!0,evented:!0,visible:!0,hasControls:!0,hasBorders:!0,hasRotatingPoint:!0,rotatingPointOffset:40,perPixelTargetFind:!1,includeDefaultValues:!0,clipTo:null,lockMovementX:!1,
lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockUniScaling:!1,lockScalingFlip:!1,stateProperties:"top left width height scaleX scaleY flipX flipY originX originY transformMatrix stroke strokeWidth strokeDashArray strokeLineCap strokeLineJoin strokeMiterLimit angle opacity fill fillRule globalCompositeOperation shadow clipTo visible backgroundColor".split(" "),initialize:function(a){a&&this.setOptions(a)},_initGradient:function(a){!a.fill||!a.fill.colorStops||a.fill instanceof
b.Gradient||this.set("fill",new b.Gradient(a.fill))},_initPattern:function(a){!a.fill||!a.fill.source||a.fill instanceof b.Pattern||this.set("fill",new b.Pattern(a.fill));!a.stroke||!a.stroke.source||a.stroke instanceof b.Pattern||this.set("stroke",new b.Pattern(a.stroke))},_initClipping:function(a){a.clipTo&&"string"===typeof a.clipTo&&(a=b.util.getFunctionBody(a.clipTo),"undefined"!==typeof a&&(this.clipTo=new Function("ctx",a)))},setOptions:function(a){for(var d in a)this.set(d,a[d]);this._initGradient(a);
this._initPattern(a);this._initClipping(a)},transform:function(a,d){d=d?this._getLeftTopCoords():this.getCenterPoint();a.translate(d.x,d.y);a.rotate(c(this.angle));a.scale(this.scaleX*(this.flipX?-1:1),this.scaleY*(this.flipY?-1:1))},toObject:function(a){var d=b.Object.NUM_FRACTION_DIGITS,d={type:this.type,originX:this.originX,originY:this.originY,left:h(this.left,d),top:h(this.top,d),width:h(this.width,d),height:h(this.height,d),fill:this.fill&&this.fill.toObject?this.fill.toObject():this.fill,stroke:this.stroke&&
this.stroke.toObject?this.stroke.toObject():this.stroke,strokeWidth:h(this.strokeWidth,d),strokeDashArray:this.strokeDashArray,strokeLineCap:this.strokeLineCap,strokeLineJoin:this.strokeLineJoin,strokeMiterLimit:h(this.strokeMiterLimit,d),scaleX:h(this.scaleX,d),scaleY:h(this.scaleY,d),angle:h(this.getAngle(),d),flipX:this.flipX,flipY:this.flipY,opacity:h(this.opacity,d),shadow:this.shadow&&this.shadow.toObject?this.shadow.toObject():this.shadow,visible:this.visible,clipTo:this.clipTo&&String(this.clipTo),
backgroundColor:this.backgroundColor,fillRule:this.fillRule,globalCompositeOperation:this.globalCompositeOperation};this.includeDefaultValues||(d=this._removeDefaultValues(d));b.util.populateWithProperties(this,d,a);return d},toDatalessObject:function(a){return this.toObject(a)},_removeDefaultValues:function(a){var d=b.util.getKlass(a.type).prototype;d.stateProperties.forEach(function(c){a[c]===d[c]&&delete a[c]});return a},toString:function(){return"#<fabric."+g(this.type)+">"},get:function(a){return this[a]},
_setObject:function(a){for(var d in a)this._set(d,a[d])},set:function(a,d){"object"===typeof a?this._setObject(a):"function"===typeof d&&"clipTo"!==a?this._set(a,d(this.get(a))):this._set(a,d);return this},_set:function(a,d){if("scaleX"===a||"scaleY"===a)d=this._constrainScale(d);"scaleX"===a&&0>d?(this.flipX=!this.flipX,d*=-1):"scaleY"===a&&0>d?(this.flipY=!this.flipY,d*=-1):"width"===a||"height"===a?this.minScaleLimit=h(Math.min(.1,1/Math.max(this.width,this.height)),2):"shadow"!==a||!d||d instanceof
b.Shadow||(d=new b.Shadow(d));this[a]=d;return this},toggle:function(a){var d=this.get(a);"boolean"===typeof d&&this.set(a,!d);return this},setSourcePath:function(a){this.sourcePath=a;return this},getViewportTransform:function(){return this.canvas&&this.canvas.viewportTransform?this.canvas.viewportTransform:[1,0,0,1,0,0]},render:function(a,d){0===this.width&&0===this.height||!this.visible||(a.save(),this._setupCompositeOperation(a),d||this.transform(a),this._setStrokeStyles(a),this._setFillStyles(a),
this.transformMatrix&&a.transform.apply(a,this.transformMatrix),this._setOpacity(a),this._setShadow(a),this.clipTo&&b.util.clipContext(this,a),this._render(a,d),this.clipTo&&a.restore(),this._removeShadow(a),this._restoreCompositeOperation(a),a.restore())},_setOpacity:function(a){this.group&&this.group._setOpacity(a);a.globalAlpha*=this.opacity},_setStrokeStyles:function(a){this.stroke&&(a.lineWidth=this.strokeWidth,a.lineCap=this.strokeLineCap,a.lineJoin=this.strokeLineJoin,a.miterLimit=this.strokeMiterLimit,
a.strokeStyle=this.stroke.toLive?this.stroke.toLive(a,this):this.stroke)},_setFillStyles:function(a){this.fill&&(a.fillStyle=this.fill.toLive?this.fill.toLive(a,this):this.fill)},_renderControls:function(a,d){if(this.active&&!d){d=this.getViewportTransform();a.save();var e;this.group&&(e=b.util.transformPoint(this.group.getCenterPoint(),d),a.translate(e.x,e.y),a.rotate(c(this.group.angle)));e=b.util.transformPoint(this.getCenterPoint(),d,null!=this.group);this.group&&(e.x*=this.group.scaleX,e.y*=
this.group.scaleY);a.translate(e.x,e.y);a.rotate(c(this.angle));this.drawBorders(a);this.drawControls(a);a.restore()}},_setShadow:function(a){if(this.shadow){var d=this.canvas&&this.canvas.viewportTransform[0]||1,c=this.canvas&&this.canvas.viewportTransform[3]||1;a.shadowColor=this.shadow.color;a.shadowBlur=this.shadow.blur*(d+c)*(this.scaleX+this.scaleY)/4;a.shadowOffsetX=this.shadow.offsetX*d*this.scaleX;a.shadowOffsetY=this.shadow.offsetY*c*this.scaleY}},_removeShadow:function(a){this.shadow&&
(a.shadowColor="",a.shadowBlur=a.shadowOffsetX=a.shadowOffsetY=0)},_renderFill:function(a){this.fill&&(a.save(),this.fill.gradientTransform&&a.transform.apply(a,this.fill.gradientTransform),this.fill.toLive&&a.translate(-this.width/2+this.fill.offsetX||0,-this.height/2+this.fill.offsetY||0),"evenodd"===this.fillRule?a.fill("evenodd"):a.fill(),a.restore(),this.shadow&&!this.shadow.affectStroke&&this._removeShadow(a))},_renderStroke:function(a){this.stroke&&0!==this.strokeWidth&&(a.save(),this.strokeDashArray?
(1&this.strokeDashArray.length&&this.strokeDashArray.push.apply(this.strokeDashArray,this.strokeDashArray),e?(a.setLineDash(this.strokeDashArray),this._stroke&&this._stroke(a)):this._renderDashedStroke&&this._renderDashedStroke(a),a.stroke()):(this.stroke.gradientTransform&&a.transform.apply(a,this.stroke.gradientTransform),this._stroke?this._stroke(a):a.stroke()),this._removeShadow(a),a.restore())},clone:function(a,d){return this.constructor.fromObject?this.constructor.fromObject(this.toObject(d),
a):new b.Object(this.toObject(d))},cloneAsImage:function(a){var d=this.toDataURL();b.util.loadImage(d,function(d){a&&a(new b.Image(d))});return this},toDataURL:function(a){a||(a={});var d=b.util.createCanvasElement(),c=this.getBoundingRect();d.width=c.width;d.height=c.height;b.util.wrapElement(d,"div");c=new b.StaticCanvas(d);"jpg"===a.format&&(a.format="jpeg");"jpeg"===a.format&&(c.backgroundColor="#fff");var e={active:this.get("active"),left:this.getLeft(),top:this.getTop()};this.set("active",!1);
this.setPositionByOrigin(new b.Point(d.width/2,d.height/2),"center","center");d=this.canvas;c.add(this);a=c.toDataURL(a);this.set(e).setCoords();this.canvas=d;c.dispose();return a},isType:function(a){return this.type===a},complexity:function(){return 0},toJSON:function(a){return this.toObject(a)},setGradient:function(a,d){d||(d={});var c={colorStops:[]};c.type=d.type||(d.r1||d.r2?"radial":"linear");c.coords={x1:d.x1,y1:d.y1,x2:d.x2,y2:d.y2};if(d.r1||d.r2)c.coords.r1=d.r1,c.coords.r2=d.r2;for(var e in d.colorStops){var g=
new b.Color(d.colorStops[e]);c.colorStops.push({offset:e,color:g.toRgb(),opacity:g.getAlpha()})}return this.set(a,b.Gradient.forObject(this,c))},setPatternFill:function(a){return this.set("fill",new b.Pattern(a))},setShadow:function(a){return this.set("shadow",a?new b.Shadow(a):null)},setColor:function(a){this.set("fill",a);return this},setAngle:function(a){var c=("center"!==this.originX||"center"!==this.originY)&&this.centeredRotation;c&&this._setOriginToCenter();this.set("angle",a);c&&this._resetOrigin();
return this},centerH:function(){this.canvas.centerObjectH(this);return this},centerV:function(){this.canvas.centerObjectV(this);return this},center:function(){this.canvas.centerObject(this);return this},remove:function(){this.canvas.remove(this);return this},getLocalPointer:function(a,c){c=c||this.canvas.getPointer(a);a=this.translateToOriginPoint(this.getCenterPoint(),"left","top");return{x:c.x-a.x,y:c.y-a.y}},_setupCompositeOperation:function(a){this.globalCompositeOperation&&(this._prevGlobalCompositeOperation=
a.globalCompositeOperation,a.globalCompositeOperation=this.globalCompositeOperation)},_restoreCompositeOperation:function(a){this.globalCompositeOperation&&this._prevGlobalCompositeOperation&&(a.globalCompositeOperation=this._prevGlobalCompositeOperation)}}),b.util.createAccessors(b.Object),b.Object.prototype.rotate=b.Object.prototype.setAngle,a(b.Object.prototype,b.Observable),b.Object.NUM_FRACTION_DIGITS=2,b.Object.__uid=0)})("undefined"!==typeof b?b:this);(function(){var b=a.util.degreesToRadians;
a.util.object.extend(a.Object.prototype,{translateToCenterPoint:function(l,h,g){var c=l.x,e=l.y,f=this.stroke?this.strokeWidth:0;"left"===h?c=l.x+(this.getWidth()+f*this.scaleX)/2:"right"===h&&(c=l.x-(this.getWidth()+f*this.scaleX)/2);"top"===g?e=l.y+(this.getHeight()+f*this.scaleY)/2:"bottom"===g&&(e=l.y-(this.getHeight()+f*this.scaleY)/2);return a.util.rotatePoint(new a.Point(c,e),l,b(this.angle))},translateToOriginPoint:function(l,h,g){var c=l.x,e=l.y,f=this.stroke?this.strokeWidth:0;"left"===
h?c=l.x-(this.getWidth()+f*this.scaleX)/2:"right"===h&&(c=l.x+(this.getWidth()+f*this.scaleX)/2);"top"===g?e=l.y-(this.getHeight()+f*this.scaleY)/2:"bottom"===g&&(e=l.y+(this.getHeight()+f*this.scaleY)/2);return a.util.rotatePoint(new a.Point(c,e),l,b(this.angle))},getCenterPoint:function(){var b=new a.Point(this.left,this.top);return this.translateToCenterPoint(b,this.originX,this.originY)},getPointByOrigin:function(a,b){var g=this.getCenterPoint();return this.translateToOriginPoint(g,a,b)},toLocalPoint:function(l,
h,g){var c=this.getCenterPoint(),e=this.stroke?this.strokeWidth:0;h&&g?(h="left"===h?c.x-(this.getWidth()+e*this.scaleX)/2:"right"===h?c.x+(this.getWidth()+e*this.scaleX)/2:c.x,g="top"===g?c.y-(this.getHeight()+e*this.scaleY)/2:"bottom"===g?c.y+(this.getHeight()+e*this.scaleY)/2:c.y):(h=this.left,g=this.top);return a.util.rotatePoint(new a.Point(l.x,l.y),c,-b(this.angle)).subtractEquals(new a.Point(h,g))},setPositionByOrigin:function(a,b,g){a=this.translateToCenterPoint(a,b,g);a=this.translateToOriginPoint(a,
this.originX,this.originY);this.set("left",a.x);this.set("top",a.y)},adjustPosition:function(a){var h=b(this.angle),g=this.getWidth()/2,c=Math.cos(h)*g,g=Math.sin(h)*g,e=this.getWidth(),f=Math.cos(h)*e,h=Math.sin(h)*e;"center"===this.originX&&"left"===a||"right"===this.originX&&"center"===a?(this.left-=c,this.top-=g):"left"===this.originX&&"center"===a||"center"===this.originX&&"right"===a?(this.left+=c,this.top+=g):"left"===this.originX&&"right"===a?(this.left+=f,this.top+=h):"right"===this.originX&&
"left"===a&&(this.left-=f,this.top-=h);this.setCoords();this.originX=a},_setOriginToCenter:function(){this._originalOriginX=this.originX;this._originalOriginY=this.originY;var a=this.getCenterPoint();this.originY=this.originX="center";this.left=a.x;this.top=a.y},_resetOrigin:function(){var a=this.translateToOriginPoint(this.getCenterPoint(),this._originalOriginX,this._originalOriginY);this.originX=this._originalOriginX;this.originY=this._originalOriginY;this.left=a.x;this.top=a.y;this._originalOriginY=
this._originalOriginX=null},_getLeftTopCoords:function(){return this.translateToOriginPoint(this.getCenterPoint(),"left","center")}})})();(function(){var b=a.util.degreesToRadians;a.util.object.extend(a.Object.prototype,{oCoords:null,intersectsWithRect:function(b,h){var g=this.oCoords,c=new a.Point(g.tl.x,g.tl.y),e=new a.Point(g.tr.x,g.tr.y),f=new a.Point(g.bl.x,g.bl.y),g=new a.Point(g.br.x,g.br.y);return"Intersection"===a.Intersection.intersectPolygonRectangle([c,e,g,f],b,h).status},intersectsWithObject:function(b){function h(c){return{tl:new a.Point(c.tl.x,
c.tl.y),tr:new a.Point(c.tr.x,c.tr.y),bl:new a.Point(c.bl.x,c.bl.y),br:new a.Point(c.br.x,c.br.y)}}var g=h(this.oCoords);b=h(b.oCoords);return"Intersection"===a.Intersection.intersectPolygonPolygon([g.tl,g.tr,g.br,g.bl],[b.tl,b.tr,b.br,b.bl]).status},isContainedWithinObject:function(b){var h=b.getBoundingRect();b=new a.Point(h.left,h.top);h=new a.Point(h.left+h.width,h.top+h.height);return this.isContainedWithinRect(b,h)},isContainedWithinRect:function(a,b){var g=this.getBoundingRect();return g.left>=
a.x&&g.left+g.width<=b.x&&g.top>=a.y&&g.top+g.height<=b.y},containsPoint:function(a){var b=this._getImageLines(this.oCoords);a=this._findCrossPoints(a,b);return 0!==a&&1===a%2},_getImageLines:function(a){return{topline:{o:a.tl,d:a.tr},rightline:{o:a.tr,d:a.br},bottomline:{o:a.br,d:a.bl},leftline:{o:a.bl,d:a.tl}}},_findCrossPoints:function(a,b){var g,c,e,f=0,d;for(d in b)if(e=b[d],!(e.o.y<a.y&&e.d.y<a.y||e.o.y>=a.y&&e.d.y>=a.y)&&(e.o.x===e.d.x&&e.o.x>=a.x?g=e.o.x:(g=(e.d.y-e.o.y)/(e.d.x-e.o.x),c=a.y-
0*a.x,e=e.o.y-g*e.o.x,g=-(c-e)/(0-g)),g>=a.x&&(f+=1),2===f))break;return f},getBoundingRectWidth:function(){return this.getBoundingRect().width},getBoundingRectHeight:function(){return this.getBoundingRect().height},getBoundingRect:function(){this.oCoords||this.setCoords();var b=[this.oCoords.tl.x,this.oCoords.tr.x,this.oCoords.br.x,this.oCoords.bl.x],h=a.util.array.min(b),b=a.util.array.max(b),b=Math.abs(h-b),g=[this.oCoords.tl.y,this.oCoords.tr.y,this.oCoords.br.y,this.oCoords.bl.y],c=a.util.array.min(g),
g=a.util.array.max(g);return{left:h,top:c,width:b,height:Math.abs(c-g)}},getWidth:function(){return this.width*this.scaleX},getHeight:function(){return this.height*this.scaleY},_constrainScale:function(a){return Math.abs(a)<this.minScaleLimit?0>a?-this.minScaleLimit:this.minScaleLimit:a},scale:function(a){a=this._constrainScale(a);0>a&&(this.flipX=!this.flipX,this.flipY=!this.flipY,a*=-1);this.scaleY=this.scaleX=a;this.setCoords();return this},scaleToWidth:function(a){var b=this.getBoundingRectWidth()/
this.getWidth();return this.scale(a/this.width/b)},scaleToHeight:function(a){var b=this.getBoundingRectHeight()/this.getHeight();return this.scale(a/this.height/b)},setCoords:function(){var l=b(this.angle),h=this.getViewportTransform(),g=this._calculateCurrentDimensions(!1),c=g.x,e=g.y;0>c&&(c=Math.abs(c));var g=Math.sqrt(Math.pow(c/2,2)+Math.pow(e/2,2)),f=Math.atan(isFinite(e/c)?e/c:0),d=Math.cos(f+l)*g,f=Math.sin(f+l)*g,g=Math.sin(l),l=Math.cos(l),t=this.getCenterPoint(),e=new a.Point(c,e),t=new a.Point(t.x-
d,t.y-f),f=new a.Point(t.x+e.x*l,t.y+e.x*g),c=a.util.transformPoint(new a.Point(t.x-e.y*g,t.y+e.y*l),h),d=a.util.transformPoint(new a.Point(f.x-e.y*g,f.y+e.y*l),h),e=a.util.transformPoint(t,h),h=a.util.transformPoint(f,h),f=new a.Point((e.x+c.x)/2,(e.y+c.y)/2),t=new a.Point((h.x+e.x)/2,(h.y+e.y)/2),z=new a.Point((d.x+h.x)/2,(d.y+h.y)/2),A=new a.Point((d.x+c.x)/2,(d.y+c.y)/2),g=new a.Point(t.x+g*this.rotatingPointOffset,t.y-l*this.rotatingPointOffset);this.oCoords={tl:e,tr:h,br:d,bl:c,ml:f,mt:t,mr:z,
mb:A,mtr:g};this._setCornerCoords&&this._setCornerCoords();return this}})})();a.util.object.extend(a.Object.prototype,{sendToBack:function(){this.group?a.StaticCanvas.prototype.sendToBack.call(this.group,this):this.canvas.sendToBack(this);return this},bringToFront:function(){this.group?a.StaticCanvas.prototype.bringToFront.call(this.group,this):this.canvas.bringToFront(this);return this},sendBackwards:function(b){this.group?a.StaticCanvas.prototype.sendBackwards.call(this.group,this,b):this.canvas.sendBackwards(this,
b);return this},bringForward:function(b){this.group?a.StaticCanvas.prototype.bringForward.call(this.group,this,b):this.canvas.bringForward(this,b);return this},moveTo:function(b){this.group?a.StaticCanvas.prototype.moveTo.call(this.group,this,b):this.canvas.moveTo(this,b);return this}});a.util.object.extend(a.Object.prototype,{getSvgStyles:function(){var a=this.fill?this.fill.toLive?"url(#SVGID_"+this.fill.id+")":this.fill:"none",b=this.fillRule,h=this.stroke?this.stroke.toLive?"url(#SVGID_"+this.stroke.id+
")":this.stroke:"none",g=this.strokeWidth?this.strokeWidth:"0",c=this.strokeDashArray?this.strokeDashArray.join(" "):"";return["stroke: ",h,"; stroke-width: ",g,"; stroke-dasharray: ",c,"; stroke-linecap: ",this.strokeLineCap?this.strokeLineCap:"butt","; stroke-linejoin: ",this.strokeLineJoin?this.strokeLineJoin:"miter","; stroke-miterlimit: ",this.strokeMiterLimit?this.strokeMiterLimit:"4","; fill: ",a,"; fill-rule: ",b,"; opacity: ","undefined"!==typeof this.opacity?this.opacity:"1",";",this.shadow?
"filter: url(#SVGID_"+this.shadow.id+");":"",this.visible?"":" visibility: hidden;"].join("")},getSvgTransform:function(){if(this.group&&"path-group"===this.group.type)return"";var b=a.util.toFixed,l=this.getAngle(),h=!this.canvas||this.canvas.svgViewportTransformation?this.getViewportTransform():[1,0,0,1,0,0],g=a.util.transformPoint(this.getCenterPoint(),h),c=a.Object.NUM_FRACTION_DIGITS,g="path-group"===this.type?"":"translate("+b(g.x,c)+" "+b(g.y,c)+")",l=0!==l?" rotate("+b(l,c)+")":"",b=1===this.scaleX&&
1===this.scaleY&&1===h[0]&&1===h[3]?"":" scale("+b(this.scaleX*h[0],c)+" "+b(this.scaleY*h[3],c)+")",c="path-group"===this.type?this.width*h[0]:0,h="path-group"===this.type?this.height*h[3]:0;return[g,l,b,this.flipX?" matrix(-1 0 0 1 "+c+" 0) ":"",this.flipY?" matrix(1 0 0 -1 0 "+h+")":""].join("")},getSvgTransformMatrix:function(){return this.transformMatrix?" matrix("+this.transformMatrix.join(" ")+") ":""},_createBaseSVGMarkup:function(){var a=[];this.fill&&this.fill.toLive&&a.push(this.fill.toSVG(this,
!1));this.stroke&&this.stroke.toLive&&a.push(this.stroke.toSVG(this,!1));this.shadow&&a.push(this.shadow.toSVG(this));return a}});a.util.object.extend(a.Object.prototype,{hasStateChanged:function(){return this.stateProperties.some(function(a){return this.get(a)!==this.originalState[a]},this)},saveState:function(a){this.stateProperties.forEach(function(a){this.originalState[a]=this.get(a)},this);a&&a.stateProperties&&a.stateProperties.forEach(function(a){this.originalState[a]=this.get(a)},this);return this},
setupState:function(){this.originalState={};this.saveState();return this}});(function(){var b=a.util.degreesToRadians;a.util.object.extend(a.Object.prototype,{_controlsVisibility:null,_findTargetCorner:function(a){if(!this.hasControls||!this.active)return!1;var b=a.x;a=a.y;var g,c;for(c in this.oCoords)if(this.isControlVisible(c)&&("mtr"!==c||this.hasRotatingPoint)&&(!this.get("lockUniScaling")||"mt"!==c&&"mr"!==c&&"mb"!==c&&"ml"!==c)&&(g=this._getImageLines(this.oCoords[c].corner),g=this._findCrossPoints({x:b,
y:a},g),0!==g&&1===g%2))return this.__corner=c;return!1},_setCornerCoords:function(){var a=this.oCoords,h=b(45-this.angle),g=Math.sqrt(2*Math.pow(this.cornerSize,2))/2,c=g*Math.cos(h),h=g*Math.sin(h),e,f;for(f in a)g=a[f].x,e=a[f].y,a[f].corner={tl:{x:g-h,y:e-c},tr:{x:g+c,y:e-h},bl:{x:g-c,y:e+h},br:{x:g+h,y:e+c}}},_calculateCurrentDimensions:function(b){var h=this.getViewportTransform(),g=this.strokeWidth,c=this.width,e=this.height,f="round"===this.strokeLineCap||"square"===this.strokeLineCap,d="line"===
this.type&&0===this.width,t="line"===this.type&&0===this.height,z=d||t;d?c=g:t&&(e=g);if(f&&t||!z)c+=0>c?-g:g;if(f&&d||!z)e+=0>e?-g:g;c=c*this.scaleX+2*this.padding;e=e*this.scaleY+2*this.padding;return b?a.util.transformPoint(new a.Point(c,e),h,!0):{x:c,y:e}},drawBorders:function(a){if(!this.hasBorders)return this;a.save();a.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1;a.strokeStyle=this.borderColor;a.lineWidth=1/this.borderScaleFactor;var b=this._calculateCurrentDimensions(!0),g=b.x,
b=b.y;this.group&&(g*=this.group.scaleX,b*=this.group.scaleY);a.strokeRect(~~-(g/2)-.5,~~-(b/2)-.5,~~g+1,~~b+1);this.hasRotatingPoint&&this.isControlVisible("mtr")&&!this.get("lockRotation")&&this.hasControls&&(g=-b/2,a.beginPath(),a.moveTo(0,g),a.lineTo(0,g-this.rotatingPointOffset),a.closePath(),a.stroke());a.restore();return this},drawControls:function(a){if(!this.hasControls)return this;var b=this._calculateCurrentDimensions(!0),g=b.x,b=b.y,c=-(g/2),e=-(b/2),f=this.cornerSize/2,d=this.transparentCorners?
"strokeRect":"fillRect";a.save();a.lineWidth=1;a.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1;a.strokeStyle=a.fillStyle=this.cornerColor;this._drawControl("tl",a,d,c-f,e-f);this._drawControl("tr",a,d,c+g-f,e-f);this._drawControl("bl",a,d,c-f,e+b-f);this._drawControl("br",a,d,c+g-f,e+b-f);this.get("lockUniScaling")||(this._drawControl("mt",a,d,c+g/2-f,e-f),this._drawControl("mb",a,d,c+g/2-f,e+b-f),this._drawControl("mr",a,d,c+g-f,e+b/2-f),this._drawControl("ml",a,d,c-f,e+b/2-f));this.hasRotatingPoint&&
this._drawControl("mtr",a,d,c+g/2-f,e-this.rotatingPointOffset-f);a.restore();return this},_drawControl:function(a,b,g,c,e){this.isControlVisible(a)&&(a=this.cornerSize,"undefined"!==typeof G_vmlCanvasManager||this.transparentCorners||b.clearRect(c,e,a,a),b[g](c,e,a,a))},isControlVisible:function(a){return this._getControlsVisibility()[a]},setControlVisible:function(a,b){this._getControlsVisibility()[a]=b;return this},setControlsVisibility:function(a){a||(a={});for(var b in a)this.setControlVisible(b,
a[b]);return this},_getControlsVisibility:function(){this._controlsVisibility||(this._controlsVisibility={tl:!0,tr:!0,br:!0,bl:!0,ml:!0,mt:!0,mr:!0,mb:!0,mtr:!0});return this._controlsVisibility}})})();(function(a){function b(a,c){var e=a.origin,g=a.axis1,h=a.axis2,l=a.dimension,k=c.nearest,m=c.center,p=c.farthest;return function(){switch(this.get(e)){case k:return Math.min(this.get(g),this.get(h));case m:return Math.min(this.get(g),this.get(h))+.5*this.get(l);case p:return Math.max(this.get(g),this.get(h))}}}
var h=a.fabric||(a.fabric={}),g=h.util.object.extend,c={x1:1,x2:1,y1:1,y2:1},e=h.StaticCanvas.supports("setLineDash");h.Line?h.warn("fabric.Line is already defined"):(h.Line=h.util.createClass(h.Object,{type:"line",x1:0,y1:0,x2:0,y2:0,initialize:function(a,b){b=b||{};a||(a=[0,0,0,0]);this.callSuper("initialize",b);this.set("x1",a[0]);this.set("y1",a[1]);this.set("x2",a[2]);this.set("y2",a[3]);this._setWidthHeight(b)},_setWidthHeight:function(a){a||(a={});this.width=Math.abs(this.x2-this.x1);this.height=
Math.abs(this.y2-this.y1);this.left="left"in a?a.left:this._getLeftToOriginX();this.top="top"in a?a.top:this._getTopToOriginY()},_set:function(a,b){this.callSuper("_set",a,b);"undefined"!==typeof c[a]&&this._setWidthHeight();return this},_getLeftToOriginX:b({origin:"originX",axis1:"x1",axis2:"x2",dimension:"width"},{nearest:"left",center:"center",farthest:"right"}),_getTopToOriginY:b({origin:"originY",axis1:"y1",axis2:"y2",dimension:"height"},{nearest:"top",center:"center",farthest:"bottom"}),_render:function(a,
b){a.beginPath();b&&(b=this.getCenterPoint(),a.translate(b.x-this.strokeWidth/2,b.y-this.strokeWidth/2));if(!this.strokeDashArray||this.strokeDashArray&&e)b=this.calcLinePoints(),a.moveTo(b.x1,b.y1),a.lineTo(b.x2,b.y2);a.lineWidth=this.strokeWidth;b=a.strokeStyle;a.strokeStyle=this.stroke||a.fillStyle;this.stroke&&this._renderStroke(a);a.strokeStyle=b},_renderDashedStroke:function(a){var b=this.calcLinePoints();a.beginPath();h.util.drawDashedLine(a,b.x1,b.y1,b.x2,b.y2,this.strokeDashArray);a.closePath()},
toObject:function(a){return g(this.callSuper("toObject",a),this.calcLinePoints())},calcLinePoints:function(){var a=this.x1<=this.x2?-1:1,b=this.y1<=this.y2?-1:1;return{x1:a*this.width*.5,x2:a*this.width*-.5,y1:b*this.height*.5,y2:b*this.height*-.5}},toSVG:function(a){var b=this._createBaseSVGMarkup(),c={x1:this.x1,x2:this.x2,y1:this.y1,y2:this.y2};this.group&&"path-group"===this.group.type||(c=this.calcLinePoints());b.push("<line ",'x1="',c.x1,'" y1="',c.y1,'" x2="',c.x2,'" y2="',c.y2,'" style="',
this.getSvgStyles(),'" transform="',this.getSvgTransform(),this.getSvgTransformMatrix(),'"/>\n');return a?a(b.join("")):b.join("")},complexity:function(){return 1}}),h.Line.ATTRIBUTE_NAMES=h.SHARED_ATTRIBUTES.concat(["x1","y1","x2","y2"]),h.Line.fromElement=function(a,b){a=h.parseAttributes(a,h.Line.ATTRIBUTE_NAMES);return new h.Line([a.x1||0,a.y1||0,a.x2||0,a.y2||0],g(a,b))},h.Line.fromObject=function(a){return new h.Line([a.x1,a.y1,a.x2,a.y2],a)})})("undefined"!==typeof b?b:this);(function(a){var b=
a.fabric||(a.fabric={}),h=Math.PI,g=b.util.object.extend;b.Circle?b.warn("fabric.Circle is already defined."):(b.Circle=b.util.createClass(b.Object,{type:"circle",radius:0,startAngle:0,endAngle:2*h,initialize:function(a){a=a||{};this.callSuper("initialize",a);this.set("radius",a.radius||0);this.startAngle=a.startAngle||this.startAngle;this.endAngle=a.endAngle||this.endAngle},_set:function(a,b){this.callSuper("_set",a,b);"radius"===a&&this.setRadius(b);return this},toObject:function(a){return g(this.callSuper("toObject",
a),{radius:this.get("radius"),startAngle:this.startAngle,endAngle:this.endAngle})},toSVG:function(a){var b=this._createBaseSVGMarkup(),f=0,d=0,g=(this.endAngle-this.startAngle)%(2*h);0===g?(this.group&&"path-group"===this.group.type&&(f=this.left+this.radius,d=this.top+this.radius),b.push("<circle ",'cx="'+f+'" cy="'+d+'" ','r="',this.radius,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform()," ",this.getSvgTransformMatrix(),'"/>\n')):b.push('<path d="M '+Math.cos(this.startAngle)*
this.radius+" "+Math.sin(this.startAngle)*this.radius," A "+this.radius+" "+this.radius," 0 ",+(g>h?1:0)+" 1"," "+Math.cos(this.endAngle)*this.radius+" "+Math.sin(this.endAngle)*this.radius,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform()," ",this.getSvgTransformMatrix(),'"/>\n');return a?a(b.join("")):b.join("")},_render:function(a,b){a.beginPath();a.arc(b?this.left+this.radius:0,b?this.top+this.radius:0,this.radius,this.startAngle,this.endAngle,!1);this._renderFill(a);this._renderStroke(a)},
getRadiusX:function(){return this.get("radius")*this.get("scaleX")},getRadiusY:function(){return this.get("radius")*this.get("scaleY")},setRadius:function(a){this.radius=a;this.set("width",2*a).set("height",2*a)},complexity:function(){return 1}}),b.Circle.ATTRIBUTE_NAMES=b.SHARED_ATTRIBUTES.concat(["cx","cy","r"]),b.Circle.fromElement=function(a,e){e||(e={});a=b.parseAttributes(a,b.Circle.ATTRIBUTE_NAMES);if(!("radius"in a&&0<=a.radius))throw Error("value of `r` attribute is required and can not be negative");
a.left=a.left||0;a.top=a.top||0;e=new b.Circle(g(a,e));e.left-=e.radius;e.top-=e.radius;return e},b.Circle.fromObject=function(a){return new b.Circle(a)})})("undefined"!==typeof b?b:this);(function(a){var b=a.fabric||(a.fabric={});b.Triangle?b.warn("fabric.Triangle is already defined"):(b.Triangle=b.util.createClass(b.Object,{type:"triangle",initialize:function(a){a=a||{};this.callSuper("initialize",a);this.set("width",a.width||100).set("height",a.height||100)},_render:function(a){var b=this.width/
2,c=this.height/2;a.beginPath();a.moveTo(-b,c);a.lineTo(0,-c);a.lineTo(b,c);a.closePath();this._renderFill(a);this._renderStroke(a)},_renderDashedStroke:function(a){var g=this.width/2,c=this.height/2;a.beginPath();b.util.drawDashedLine(a,-g,c,0,-c,this.strokeDashArray);b.util.drawDashedLine(a,0,-c,g,c,this.strokeDashArray);b.util.drawDashedLine(a,g,c,-g,c,this.strokeDashArray);a.closePath()},toSVG:function(a){var b=this._createBaseSVGMarkup(),c=this.width/2,e=this.height/2,c=[-c+" "+e,"0 "+-e,c+" "+
e].join();b.push("<polygon ",'points="',c,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform(),'"/>');return a?a(b.join("")):b.join("")},complexity:function(){return 1}}),b.Triangle.fromObject=function(a){return new b.Triangle(a)})})("undefined"!==typeof b?b:this);(function(a){var b=a.fabric||(a.fabric={}),h=2*Math.PI,g=b.util.object.extend;b.Ellipse?b.warn("fabric.Ellipse is already defined."):(b.Ellipse=b.util.createClass(b.Object,{type:"ellipse",rx:0,ry:0,initialize:function(a){a=
a||{};this.callSuper("initialize",a);this.set("rx",a.rx||0);this.set("ry",a.ry||0)},_set:function(a,b){this.callSuper("_set",a,b);switch(a){case "rx":this.rx=b;this.set("width",2*b);break;case "ry":this.ry=b,this.set("height",2*b)}return this},getRx:function(){return this.get("rx")*this.get("scaleX")},getRy:function(){return this.get("ry")*this.get("scaleY")},toObject:function(a){return g(this.callSuper("toObject",a),{rx:this.get("rx"),ry:this.get("ry")})},toSVG:function(a){var b=this._createBaseSVGMarkup(),
f=0,d=0;this.group&&"path-group"===this.group.type&&(f=this.left+this.rx,d=this.top+this.ry);b.push("<ellipse ",'cx="',f,'" cy="',d,'" ','rx="',this.rx,'" ry="',this.ry,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform(),this.getSvgTransformMatrix(),'"/>\n');return a?a(b.join("")):b.join("")},_render:function(a,b){a.beginPath();a.save();a.transform(1,0,0,this.ry/this.rx,0,0);a.arc(b?this.left+this.rx:0,b?(this.top+this.ry)*this.rx/this.ry:0,this.rx,0,h,!1);a.restore();this._renderFill(a);
this._renderStroke(a)},complexity:function(){return 1}}),b.Ellipse.ATTRIBUTE_NAMES=b.SHARED_ATTRIBUTES.concat(["cx","cy","rx","ry"]),b.Ellipse.fromElement=function(a,e){e||(e={});a=b.parseAttributes(a,b.Ellipse.ATTRIBUTE_NAMES);a.left=a.left||0;a.top=a.top||0;e=new b.Ellipse(g(a,e));e.top-=e.ry;e.left-=e.rx;return e},b.Ellipse.fromObject=function(a){return new b.Ellipse(a)})})("undefined"!==typeof b?b:this);(function(a){var b=a.fabric||(a.fabric={}),h=b.util.object.extend;b.Rect?console.warn("fabric.Rect is already defined"):
(a=b.Object.prototype.stateProperties.concat(),a.push("rx","ry","x","y"),b.Rect=b.util.createClass(b.Object,{stateProperties:a,type:"rect",rx:0,ry:0,strokeDashArray:null,initialize:function(a){a=a||{};this.callSuper("initialize",a);this._initRxRy()},_initRxRy:function(){this.rx&&!this.ry?this.ry=this.rx:this.ry&&!this.rx&&(this.rx=this.ry)},_render:function(a,b){if(1===this.width&&1===this.height)a.fillRect(0,0,1,1);else{var e=this.rx?Math.min(this.rx,this.width/2):0,f=this.ry?Math.min(this.ry,this.height/
2):0,d=this.width,h=this.height,l=b?this.left:-this.width/2;b=b?this.top:-this.height/2;var A=0!==e||0!==f;a.beginPath();a.moveTo(l+e,b);a.lineTo(l+d-e,b);A&&a.bezierCurveTo(l+d-.4477152502*e,b,l+d,b+.4477152502*f,l+d,b+f);a.lineTo(l+d,b+h-f);A&&a.bezierCurveTo(l+d,b+h-.4477152502*f,l+d-.4477152502*e,b+h,l+d-e,b+h);a.lineTo(l+e,b+h);A&&a.bezierCurveTo(l+.4477152502*e,b+h,l,b+h-.4477152502*f,l,b+h-f);a.lineTo(l,b+f);A&&a.bezierCurveTo(l,b+.4477152502*f,l+.4477152502*e,b,l+e,b);a.closePath();this._renderFill(a);
this._renderStroke(a)}},_renderDashedStroke:function(a){var c=-this.width/2,e=-this.height/2,f=this.width,d=this.height;a.beginPath();b.util.drawDashedLine(a,c,e,c+f,e,this.strokeDashArray);b.util.drawDashedLine(a,c+f,e,c+f,e+d,this.strokeDashArray);b.util.drawDashedLine(a,c+f,e+d,c,e+d,this.strokeDashArray);b.util.drawDashedLine(a,c,e+d,c,e,this.strokeDashArray);a.closePath()},toObject:function(a){a=h(this.callSuper("toObject",a),{rx:this.get("rx")||0,ry:this.get("ry")||0});this.includeDefaultValues||
this._removeDefaultValues(a);return a},toSVG:function(a){var b=this._createBaseSVGMarkup(),e=this.left,f=this.top;this.group&&"path-group"===this.group.type||(e=-this.width/2,f=-this.height/2);b.push("<rect ",'x="',e,'" y="',f,'" rx="',this.get("rx"),'" ry="',this.get("ry"),'" width="',this.width,'" height="',this.height,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform(),this.getSvgTransformMatrix(),'"/>\n');return a?a(b.join("")):b.join("")},complexity:function(){return 1}}),
b.Rect.ATTRIBUTE_NAMES=b.SHARED_ATTRIBUTES.concat("x y rx ry width height".split(" ")),b.Rect.fromElement=function(a,c){if(!a)return null;c=c||{};a=b.parseAttributes(a,b.Rect.ATTRIBUTE_NAMES);a.left=a.left||0;a.top=a.top||0;c=new b.Rect(h(c?b.util.object.clone(c):{},a));c.visible=0<c.width&&0<c.height;return c},b.Rect.fromObject=function(a){return new b.Rect(a)})})("undefined"!==typeof b?b:this);(function(a){var b=a.fabric||(a.fabric={});b.Polyline?b.warn("fabric.Polyline is already defined"):(b.Polyline=
b.util.createClass(b.Object,{type:"polyline",points:null,minX:0,minY:0,initialize:function(a,g){return b.Polygon.prototype.initialize.call(this,a,g)},_calcDimensions:function(){return b.Polygon.prototype._calcDimensions.call(this)},_applyPointOffset:function(){return b.Polygon.prototype._applyPointOffset.call(this)},toObject:function(a){return b.Polygon.prototype.toObject.call(this,a)},toSVG:function(a){return b.Polygon.prototype.toSVG.call(this,a)},_render:function(a){b.Polygon.prototype.commonRender.call(this,
a)&&(this._renderFill(a),this._renderStroke(a))},_renderDashedStroke:function(a){var g,c;a.beginPath();for(var e=0,f=this.points.length;e<f;e++)g=this.points[e],c=this.points[e+1]||g,b.util.drawDashedLine(a,g.x,g.y,c.x,c.y,this.strokeDashArray)},complexity:function(){return this.get("points").length}}),b.Polyline.ATTRIBUTE_NAMES=b.SHARED_ATTRIBUTES.concat(),b.Polyline.fromElement=function(a,g){if(!a)return null;g||(g={});var c=b.parsePointsAttribute(a.getAttribute("points"));a=b.parseAttributes(a,
b.Polyline.ATTRIBUTE_NAMES);return new b.Polyline(c,b.util.object.extend(a,g))},b.Polyline.fromObject=function(a){return new b.Polyline(a.points,a,!0)})})("undefined"!==typeof b?b:this);(function(a){var b=a.fabric||(a.fabric={}),h=b.util.object.extend,g=b.util.array.min,c=b.util.array.max,e=b.util.toFixed;b.Polygon?b.warn("fabric.Polygon is already defined"):(b.Polygon=b.util.createClass(b.Object,{type:"polygon",points:null,minX:0,minY:0,initialize:function(a,b){b=b||{};this.points=a||[];this.callSuper("initialize",
b);this._calcDimensions();"top"in b||(this.top=this.minY);"left"in b||(this.left=this.minX)},_calcDimensions:function(){var a=this.points,b=g(a,"x"),e=g(a,"y"),h=c(a,"x"),a=c(a,"y");this.width=h-b||0;this.height=a-e||0;this.minX=b||0;this.minY=e||0},_applyPointOffset:function(){this.points.forEach(function(a){a.x-=this.minX+this.width/2;a.y-=this.minY+this.height/2},this)},toObject:function(a){return h(this.callSuper("toObject",a),{points:this.points.concat()})},toSVG:function(a){for(var b=[],c=this._createBaseSVGMarkup(),
g=0,h=this.points.length;g<h;g++)b.push(e(this.points[g].x,2),",",e(this.points[g].y,2)," ");c.push("<",this.type," ",'points="',b.join(""),'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform()," ",this.getSvgTransformMatrix(),'"/>\n');return a?a(c.join("")):c.join("")},_render:function(a){this.commonRender(a)&&(this._renderFill(a),this.stroke||this.strokeDashArray)&&(a.closePath(),this._renderStroke(a))},commonRender:function(a){var b,c=this.points.length;if(!c||isNaN(this.points[c-
1].y))return!1;a.beginPath();this._applyPointOffset&&(this.group&&"path-group"===this.group.type||this._applyPointOffset(),this._applyPointOffset=null);a.moveTo(this.points[0].x,this.points[0].y);for(var e=0;e<c;e++)b=this.points[e],a.lineTo(b.x,b.y);return!0},_renderDashedStroke:function(a){b.Polyline.prototype._renderDashedStroke.call(this,a);a.closePath()},complexity:function(){return this.points.length}}),b.Polygon.ATTRIBUTE_NAMES=b.SHARED_ATTRIBUTES.concat(),b.Polygon.fromElement=function(a,
d){if(!a)return null;d||(d={});var c=b.parsePointsAttribute(a.getAttribute("points"));a=b.parseAttributes(a,b.Polygon.ATTRIBUTE_NAMES);return new b.Polygon(c,h(a,d))},b.Polygon.fromObject=function(a){return new b.Polygon(a.points,a,!0)})})("undefined"!==typeof b?b:this);(function(a){var b=a.fabric||(a.fabric={}),h=b.util.array.min,g=b.util.array.max,c=b.util.object.extend,e=Object.prototype.toString,f=b.util.drawArc,d={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},t={m:"l",M:"L"};b.Path?b.warn("fabric.Path is already defined"):
(b.Path=b.util.createClass(b.Object,{type:"path",path:null,minX:0,minY:0,initialize:function(a,b){b=b||{};this.setOptions(b);if(!a)throw Error("`path` argument is required");var d="[object Array]"===e.call(a);if(this.path=d?a:a.match&&a.match(/[mzlhvcsqta][^mzlhvcsqta]*/gi))d||(this.path=this._parsePath()),this._setPositionDimensions(),b.sourcePath&&this.setSourcePath(b.sourcePath)},_setPositionDimensions:function(){var a=this._parseDimensions();this.minX=a.left;this.minY=a.top;this.width=a.width;
this.height=a.height;a.left+="center"===this.originX?this.width/2:"right"===this.originX?this.width:0;a.top+="center"===this.originY?this.height/2:"bottom"===this.originY?this.height:0;this.top=this.top||a.top;this.left=this.left||a.left;this.pathOffset=this.pathOffset||{x:this.minX+this.width/2,y:this.minY+this.height/2}},_render:function(a){var b,d=null,c=0,e=0,g=0,h=0,l=0,t=0,k,m,p=-this.pathOffset.x,n=-this.pathOffset.y;this.group&&"path-group"===this.group.type&&(n=p=0);a.beginPath();for(var q=
0,r=this.path.length;q<r;++q){b=this.path[q];switch(b[0]){case "l":g+=b[1];h+=b[2];a.lineTo(g+p,h+n);break;case "L":g=b[1];h=b[2];a.lineTo(g+p,h+n);break;case "h":g+=b[1];a.lineTo(g+p,h+n);break;case "H":g=b[1];a.lineTo(g+p,h+n);break;case "v":h+=b[1];a.lineTo(g+p,h+n);break;case "V":h=b[1];a.lineTo(g+p,h+n);break;case "m":g+=b[1];h+=b[2];c=g;e=h;a.moveTo(g+p,h+n);break;case "M":g=b[1];h=b[2];c=g;e=h;a.moveTo(g+p,h+n);break;case "c":k=g+b[5];m=h+b[6];l=g+b[3];t=h+b[4];a.bezierCurveTo(g+b[1]+p,h+b[2]+
n,l+p,t+n,k+p,m+n);g=k;h=m;break;case "C":g=b[5];h=b[6];l=b[3];t=b[4];a.bezierCurveTo(b[1]+p,b[2]+n,l+p,t+n,g+p,h+n);break;case "s":k=g+b[3];m=h+b[4];null===d[0].match(/[CcSs]/)?(l=g,t=h):(l=2*g-l,t=2*h-t);a.bezierCurveTo(l+p,t+n,g+b[1]+p,h+b[2]+n,k+p,m+n);l=g+b[1];t=h+b[2];g=k;h=m;break;case "S":k=b[3];m=b[4];null===d[0].match(/[CcSs]/)?(l=g,t=h):(l=2*g-l,t=2*h-t);a.bezierCurveTo(l+p,t+n,b[1]+p,b[2]+n,k+p,m+n);g=k;h=m;l=b[1];t=b[2];break;case "q":k=g+b[3];m=h+b[4];l=g+b[1];t=h+b[2];a.quadraticCurveTo(l+
p,t+n,k+p,m+n);g=k;h=m;break;case "Q":k=b[3];m=b[4];a.quadraticCurveTo(b[1]+p,b[2]+n,k+p,m+n);g=k;h=m;l=b[1];t=b[2];break;case "t":k=g+b[1];m=h+b[2];null===d[0].match(/[QqTt]/)?(l=g,t=h):(l=2*g-l,t=2*h-t);a.quadraticCurveTo(l+p,t+n,k+p,m+n);g=k;h=m;break;case "T":k=b[1];m=b[2];null===d[0].match(/[QqTt]/)?(l=g,t=h):(l=2*g-l,t=2*h-t);a.quadraticCurveTo(l+p,t+n,k+p,m+n);g=k;h=m;break;case "a":f(a,g+p,h+n,[b[1],b[2],b[3],b[4],b[5],b[6]+g+p,b[7]+h+n]);g+=b[6];h+=b[7];break;case "A":f(a,g+p,h+n,[b[1],b[2],
b[3],b[4],b[5],b[6]+p,b[7]+n]);g=b[6];h=b[7];break;case "z":case "Z":g=c,h=e,a.closePath()}d=b}this._renderFill(a);this._renderStroke(a)},toString:function(){return"#<fabric.Path ("+this.complexity()+'): { "top": '+this.top+', "left": '+this.left+" }>"},toObject:function(a){a=c(this.callSuper("toObject",a),{path:this.path.map(function(a){return a.slice()}),pathOffset:this.pathOffset});this.sourcePath&&(a.sourcePath=this.sourcePath);this.transformMatrix&&(a.transformMatrix=this.transformMatrix);return a},
toDatalessObject:function(a){a=this.toObject(a);this.sourcePath&&(a.path=this.sourcePath);delete a.sourcePath;return a},toSVG:function(a){for(var b=[],d=this._createBaseSVGMarkup(),c="",f=0,e=this.path.length;f<e;f++)b.push(this.path[f].join(" "));b=b.join(" ");this.group&&"path-group"===this.group.type||(c=" translate("+-this.pathOffset.x+", "+-this.pathOffset.y+") ");d.push("<path ",'d="',b,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform(),c,this.getSvgTransformMatrix(),'" stroke-linecap="round" ',
"/>\n");return a?a(d.join("")):d.join("")},complexity:function(){return this.path.length},_parsePath:function(){for(var a=[],b=[],c,f,e=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/ig,g,h=0,l=this.path.length;h<l;h++){c=this.path[h];g=c.slice(1).trim();for(b.length=0;f=e.exec(g);)b.push(f[0]);c=[c.charAt(0)];g=0;for(var k=b.length;g<k;g++)f=parseFloat(b[g]),isNaN(f)||c.push(f);f=c[0];g=d[f.toLowerCase()];k=t[f]||f;if(c.length-1>g)for(var m=1,p=c.length;m<p;m+=g)a.push([f].concat(c.slice(m,m+
g))),f=k;else a.push(c)}return a},_parseDimensions:function(){for(var a=[],c=[],d,f=null,e=0,t=0,k=0,m=0,p=0,n=0,q,r,u,v=0,y=this.path.length;v<y;++v){d=this.path[v];switch(d[0]){case "l":k+=d[1];m+=d[2];u=[];break;case "L":k=d[1];m=d[2];u=[];break;case "h":k+=d[1];u=[];break;case "H":k=d[1];u=[];break;case "v":m+=d[1];u=[];break;case "V":m=d[1];u=[];break;case "m":k+=d[1];m+=d[2];e=k;t=m;u=[];break;case "M":k=d[1];m=d[2];e=k;t=m;u=[];break;case "c":q=k+d[5];r=m+d[6];p=k+d[3];n=m+d[4];u=b.util.getBoundsOfCurve(k,
m,k+d[1],m+d[2],p,n,q,r);k=q;m=r;break;case "C":k=d[5];m=d[6];p=d[3];n=d[4];u=b.util.getBoundsOfCurve(k,m,d[1],d[2],p,n,k,m);break;case "s":q=k+d[3];r=m+d[4];null===f[0].match(/[CcSs]/)?(p=k,n=m):(p=2*k-p,n=2*m-n);u=b.util.getBoundsOfCurve(k,m,p,n,k+d[1],m+d[2],q,r);p=k+d[1];n=m+d[2];k=q;m=r;break;case "S":q=d[3];r=d[4];null===f[0].match(/[CcSs]/)?(p=k,n=m):(p=2*k-p,n=2*m-n);u=b.util.getBoundsOfCurve(k,m,p,n,d[1],d[2],q,r);k=q;m=r;p=d[1];n=d[2];break;case "q":q=k+d[3];r=m+d[4];p=k+d[1];n=m+d[2];u=
b.util.getBoundsOfCurve(k,m,p,n,p,n,q,r);k=q;m=r;break;case "Q":p=d[1];n=d[2];u=b.util.getBoundsOfCurve(k,m,p,n,p,n,d[3],d[4]);k=d[3];m=d[4];break;case "t":q=k+d[1];r=m+d[2];null===f[0].match(/[QqTt]/)?(p=k,n=m):(p=2*k-p,n=2*m-n);u=b.util.getBoundsOfCurve(k,m,p,n,p,n,q,r);k=q;m=r;break;case "T":q=d[1];r=d[2];null===f[0].match(/[QqTt]/)?(p=k,n=m):(p=2*k-p,n=2*m-n);u=b.util.getBoundsOfCurve(k,m,p,n,p,n,q,r);k=q;m=r;break;case "a":u=b.util.getBoundsOfArc(k,m,d[1],d[2],d[3],d[4],d[5],d[6]+k,d[7]+m);k+=
d[6];m+=d[7];break;case "A":u=b.util.getBoundsOfArc(k,m,d[1],d[2],d[3],d[4],d[5],d[6],d[7]);k=d[6];m=d[7];break;case "z":case "Z":k=e,m=t}f=d;u.forEach(function(b){a.push(b.x);c.push(b.y)});a.push(k);c.push(m)}d=h(a);f=h(c);e=g(a);t=g(c);return{left:d,top:f,width:e-d,height:t-f}}}),b.Path.fromObject=function(a,d){"string"===typeof a.path?b.loadSVGFromURL(a.path,function(c){c=c[0];var f=a.path;delete a.path;b.util.object.extend(c,a);c.setSourcePath(f);d(c)}):d(new b.Path(a.path,a))},b.Path.ATTRIBUTE_NAMES=
b.SHARED_ATTRIBUTES.concat(["d"]),b.Path.fromElement=function(a,d,f){a=b.parseAttributes(a,b.Path.ATTRIBUTE_NAMES);d&&d(new b.Path(a.d,c(a,f)))},b.Path.async=!0)})("undefined"!==typeof b?b:this);(function(a){var b=a.fabric||(a.fabric={}),h=b.util.object.extend,g=b.util.array.invoke,c=b.Object.prototype.toObject;b.PathGroup?b.warn("fabric.PathGroup is already defined"):(b.PathGroup=b.util.createClass(b.Path,{type:"path-group",fill:"",initialize:function(a,b){b=b||{};this.paths=a||[];for(a=this.paths.length;a--;)this.paths[a].group=
this;b.toBeParsed&&(this.parseDimensionsFromPaths(b),delete b.toBeParsed);this.setOptions(b);this.setCoords();b.sourcePath&&this.setSourcePath(b.sourcePath)},parseDimensionsFromPaths:function(a){for(var c,d,g=[],h=[],k,m=this.transformMatrix,p=this.paths.length;p--;)for(c=this.paths[p],d=c.height+c.strokeWidth,k=c.width+c.strokeWidth,c=[{x:c.left,y:c.top},{x:c.left+k,y:c.top},{x:c.left,y:c.top+d},{x:c.left+k,y:c.top+d}],k=0;k<c.length;k++)d=c[k],m&&(d=b.util.transformPoint(d,m,!1)),g.push(d.x),h.push(d.y);
a.width=Math.max.apply(null,g);a.height=Math.max.apply(null,h)},render:function(a){if(this.visible){a.save();this.transformMatrix&&a.transform.apply(a,this.transformMatrix);this.transform(a);this._setShadow(a);this.clipTo&&b.util.clipContext(this,a);a.translate(-this.width/2,-this.height/2);for(var c=0,d=this.paths.length;c<d;++c)this.paths[c].render(a,!0);this.clipTo&&a.restore();this._removeShadow(a);a.restore()}},_set:function(a,b){if("fill"===a&&b&&this.isSameColor())for(var d=this.paths.length;d--;)this.paths[d]._set(a,
b);return this.callSuper("_set",a,b)},toObject:function(a){a=h(c.call(this,a),{paths:g(this.getObjects(),"toObject",a)});this.sourcePath&&(a.sourcePath=this.sourcePath);return a},toDatalessObject:function(a){a=this.toObject(a);this.sourcePath&&(a.paths=this.sourcePath);return a},toSVG:function(a){for(var b=this.getObjects(),d=this.getPointByOrigin("left","top"),d="translate("+d.x+" "+d.y+")",d=["<g ",'style="',this.getSvgStyles(),'" ','transform="',this.getSvgTransformMatrix(),d,this.getSvgTransform(),
'" ',">\n"],c=0,g=b.length;c<g;c++)d.push(b[c].toSVG(a));d.push("</g>\n");return a?a(d.join("")):d.join("")},toString:function(){return"#<fabric.PathGroup ("+this.complexity()+"): { top: "+this.top+", left: "+this.left+" }>"},isSameColor:function(){var a=(this.getObjects()[0].get("fill")||"").toLowerCase();return this.getObjects().every(function(b){return(b.get("fill")||"").toLowerCase()===a})},complexity:function(){return this.paths.reduce(function(a,b){return a+(b&&b.complexity?b.complexity():0)},
0)},getObjects:function(){return this.paths}}),b.PathGroup.fromObject=function(a,c){"string"===typeof a.paths?b.loadSVGFromURL(a.paths,function(d){var g=a.paths;delete a.paths;d=b.util.groupSVGElements(d,a,g);c(d)}):b.util.enlivenObjects(a.paths,function(d){delete a.paths;c(new b.PathGroup(d,a))})},b.PathGroup.async=!0)})("undefined"!==typeof b?b:this);(function(a){var b=a.fabric||(a.fabric={}),h=b.util.object.extend,g=b.util.array.min,c=b.util.array.max,e=b.util.array.invoke;if(!b.Group){var f={lockMovementX:!0,
lockMovementY:!0,lockRotation:!0,lockScalingX:!0,lockScalingY:!0,lockUniScaling:!0};b.Group=b.util.createClass(b.Object,b.Collection,{type:"group",initialize:function(a,b){b=b||{};this._objects=a||[];for(a=this._objects.length;a--;)this._objects[a].group=this;this.originalState={};this.callSuper("initialize");b.originX&&(this.originX=b.originX);b.originY&&(this.originY=b.originY);this._calcBounds();this._updateObjectsCoords();this.callSuper("initialize",b);this.setCoords();this.saveCoords()},_updateObjectsCoords:function(){this.forEachObject(this._updateObjectCoords,
this)},_updateObjectCoords:function(a){var b=a.getLeft(),c=a.getTop(),f=this.getCenterPoint();a.set({originalLeft:b,originalTop:c,left:b-f.x,top:c-f.y});a.setCoords();a.__origHasControls=a.hasControls;a.hasControls=!1},toString:function(){return"#<fabric.Group: ("+this.complexity()+")>"},addWithUpdate:function(a){this._restoreObjectsState();a&&(this._objects.push(a),a.group=this);this.forEachObject(this._setObjectActive,this);this._calcBounds();this._updateObjectsCoords();return this},_setObjectActive:function(a){a.set("active",
!0);a.group=this},removeWithUpdate:function(a){this._moveFlippedObject(a);this._restoreObjectsState();this.forEachObject(this._setObjectActive,this);this.remove(a);this._calcBounds();this._updateObjectsCoords();return this},_onObjectAdded:function(a){a.group=this},_onObjectRemoved:function(a){delete a.group;a.set("active",!1)},delegatedProperties:{fill:!0,opacity:!0,fontFamily:!0,fontWeight:!0,fontSize:!0,fontStyle:!0,lineHeight:!0,textDecoration:!0,textAlign:!0,backgroundColor:!0},_set:function(a,
b){if(a in this.delegatedProperties)for(var c=this._objects.length;c--;)this._objects[c].set(a,b);this.callSuper("_set",a,b)},toObject:function(a){return h(this.callSuper("toObject",a),{objects:e(this._objects,"toObject",a)})},render:function(a){if(this.visible){a.save();this.clipTo&&b.util.clipContext(this,a);this.transform(a);for(var c=0,f=this._objects.length;c<f;c++)this._renderObject(this._objects[c],a);this.clipTo&&a.restore();a.restore()}},_renderControls:function(a,b){this.callSuper("_renderControls",
a,b);b=0;for(var c=this._objects.length;b<c;b++)this._objects[b]._renderControls(a)},_renderObject:function(a,b){var c=a.hasRotatingPoint;a.visible&&(a.hasRotatingPoint=!1,a.render(b),a.hasRotatingPoint=c)},_restoreObjectsState:function(){this._objects.forEach(this._restoreObjectState,this);return this},realizeTransform:function(a){this._moveFlippedObject(a);this._setObjectPosition(a);return a},_moveFlippedObject:function(a){var b=a.get("originX"),c=a.get("originY"),f=a.getCenterPoint();a.set({originX:"center",
originY:"center",left:f.x,top:f.y});this._toggleFlipping(a);f=a.getPointByOrigin(b,c);a.set({originX:b,originY:c,left:f.x,top:f.y});return this},_toggleFlipping:function(a){this.flipX&&(a.toggle("flipX"),a.set("left",-a.get("left")),a.setAngle(-a.getAngle()));this.flipY&&(a.toggle("flipY"),a.set("top",-a.get("top")),a.setAngle(-a.getAngle()))},_restoreObjectState:function(a){this._setObjectPosition(a);a.setCoords();a.hasControls=a.__origHasControls;delete a.__origHasControls;a.set("active",!1);a.setCoords();
delete a.group;return this},_setObjectPosition:function(a){var b=this.getCenterPoint(),c=this._getRotatedLeftTop(a);a.set({angle:a.getAngle()+this.getAngle(),left:b.x+c.left,top:b.y+c.top,scaleX:a.get("scaleX")*this.get("scaleX"),scaleY:a.get("scaleY")*this.get("scaleY")})},_getRotatedLeftTop:function(a){var b=this.getAngle()*(Math.PI/180);return{left:-Math.sin(b)*a.getTop()*this.get("scaleY")+Math.cos(b)*a.getLeft()*this.get("scaleX"),top:Math.cos(b)*a.getTop()*this.get("scaleY")+Math.sin(b)*a.getLeft()*
this.get("scaleX")}},destroy:function(){this._objects.forEach(this._moveFlippedObject,this);return this._restoreObjectsState()},saveCoords:function(){this._originalLeft=this.get("left");this._originalTop=this.get("top");return this},hasMoved:function(){return this._originalLeft!==this.get("left")||this._originalTop!==this.get("top")},setObjectsCoords:function(){this.forEachObject(function(a){a.setCoords()});return this},_calcBounds:function(a){for(var b=[],c=[],f,e,g=["tr","br","bl","tl"],h=0,l=this._objects.length;h<
l;++h){f=this._objects[h];f.setCoords();for(var k=0;k<g.length;k++)e=g[k],b.push(f.oCoords[e].x),c.push(f.oCoords[e].y)}this.set(this._getBounds(b,c,a))},_getBounds:function(a,f,e){var h=b.util.invertTransform(this.getViewportTransform()),k=b.util.transformPoint(new b.Point(g(a),g(f)),h);a=b.util.transformPoint(new b.Point(c(a),c(f)),h);a={width:a.x-k.x||0,height:a.y-k.y||0};e||(a.left=k.x||0,a.top=k.y||0,"center"===this.originX&&(a.left+=a.width/2),"right"===this.originX&&(a.left+=a.width),"center"===
this.originY&&(a.top+=a.height/2),"bottom"===this.originY&&(a.top+=a.height));return a},toSVG:function(a){for(var b=["<g ",'transform="',this.getSvgTransform(),'">\n'],c=0,f=this._objects.length;c<f;c++)b.push(this._objects[c].toSVG(a));b.push("</g>\n");return a?a(b.join("")):b.join("")},get:function(a){if(a in f){if(this[a])return this[a];for(var b=0,c=this._objects.length;b<c;b++)if(this._objects[b][a])return!0;return!1}return a in this.delegatedProperties?this._objects[0]&&this._objects[0].get(a):
this[a]}});b.Group.fromObject=function(a,c){b.util.enlivenObjects(a.objects,function(f){delete a.objects;c&&c(new b.Group(f,a))})};b.Group.async=!0}})("undefined"!==typeof b?b:this);(function(b){var l=a.util.object.extend;b.fabric||(b.fabric={});b.fabric.Image?a.warn("fabric.Image is already defined."):(a.Image=a.util.createClass(a.Object,{type:"image",crossOrigin:"",alignX:"none",alignY:"none",meetOrSlice:"meet",_lastScaleX:1,_lastScaleY:1,initialize:function(a,b){b||(b={});this.filters=[];this.resizeFilters=
[];this.callSuper("initialize",b);this._initElement(a,b);this._initConfig(b);b.filters&&(this.filters=b.filters,this.applyFilters())},getElement:function(){return this._element},setElement:function(a,b,c){this._originalElement=this._element=a;this._initConfig(c);0!==this.filters.length?this.applyFilters(b):b&&b();return this},setCrossOrigin:function(a){this.crossOrigin=a;this._element.crossOrigin=a;return this},getOriginalSize:function(){var a=this.getElement();return{width:a.width,height:a.height}},
_stroke:function(a){a.save();this._setStrokeStyles(a);a.beginPath();a.strokeRect(-this.width/2,-this.height/2,this.width,this.height);a.closePath();a.restore()},_renderDashedStroke:function(b){var g=-this.width/2,c=-this.height/2,e=this.width,f=this.height;b.save();this._setStrokeStyles(b);b.beginPath();a.util.drawDashedLine(b,g,c,g+e,c,this.strokeDashArray);a.util.drawDashedLine(b,g+e,c,g+e,c+f,this.strokeDashArray);a.util.drawDashedLine(b,g+e,c+f,g,c+f,this.strokeDashArray);a.util.drawDashedLine(b,
g,c+f,g,c,this.strokeDashArray);b.closePath();b.restore()},toObject:function(a){return l(this.callSuper("toObject",a),{src:this._originalElement.src||this._originalElement._src,filters:this.filters.map(function(a){return a&&a.toObject()}),crossOrigin:this.crossOrigin,alignX:this.alignX,alignY:this.alignY,meetOrSlice:this.meetOrSlice})},toSVG:function(a){var b=[],c=-this.width/2,e=-this.height/2,f="none";this.group&&"path-group"===this.group.type&&(c=this.left,e=this.top);"none"!==this.alignX&&"none"!==
this.alignY&&(f="x"+this.alignX+"Y"+this.alignY+" "+this.meetOrSlice);b.push('<g transform="',this.getSvgTransform(),this.getSvgTransformMatrix(),'">\n','<image xlink:href="',this.getSvgSrc(),'" x="',c,'" y="',e,'" style="',this.getSvgStyles(),'" width="',this.width,'" height="',this.height,'" preserveAspectRatio="',f,'"',"></image>\n");if(this.stroke||this.strokeDashArray)f=this.fill,this.fill=null,b.push("<rect ",'x="',c,'" y="',e,'" width="',this.width,'" height="',this.height,'" style="',this.getSvgStyles(),
'"/>\n'),this.fill=f;b.push("</g>\n");return a?a(b.join("")):b.join("")},getSrc:function(){if(this.getElement())return this.getElement().src||this.getElement()._src},setSrc:function(b,g,c){a.util.loadImage(b,function(a){return this.setElement(a,g,c)},this,c&&c.crossOrigin)},toString:function(){return'#<fabric.Image: { src: "'+this.getSrc()+'" }>'},clone:function(a,b){this.constructor.fromObject(this.toObject(b),a)},applyFilters:function(b,g,c,e){g=g||this.filters;if(c=c||this._originalElement){var f=
c,d=a.util.createCanvasElement(),l=a.util.createImage(),k=this;d.width=f.width;d.height=f.height;d.getContext("2d").drawImage(f,0,0,f.width,f.height);if(0===g.length)return this._element=c,b&&b(),d;g.forEach(function(a){a&&a.applyTo(d,a.scaleX||k.scaleX,a.scaleY||k.scaleY);!e&&a&&"Resize"===a.type&&(k.width*=a.scaleX,k.height*=a.scaleY)});l.width=d.width;l.height=d.height;a.isLikelyNode?(l.src=d.toBuffer(void 0,a.Image.pngCompression),k._element=l,!e&&(k._filteredEl=l),b&&b()):(l.onload=function(){k._element=
l;!e&&(k._filteredEl=l);b&&b();l.onload=d=f=null},l.src=d.toDataURL("image/png"));return d}},_render:function(a,b){var c,e=this._findMargins(),f;c=b?this.left:-this.width/2;b=b?this.top:-this.height/2;"slice"===this.meetOrSlice&&(a.beginPath(),a.rect(c,b,this.width,this.height),a.clip());!1===this.isMoving&&this.resizeFilters.length&&this._needsResize()?(this._lastScaleX=this.scaleX,this._lastScaleY=this.scaleY,f=this.applyFilters(null,this.resizeFilters,this._filteredEl||this._originalElement,!0)):
f=this._element;f&&a.drawImage(f,c+e.marginX,b+e.marginY,e.width,e.height);this._renderStroke(a)},_needsResize:function(){return this.scaleX!==this._lastScaleX||this.scaleY!==this._lastScaleY},_findMargins:function(){var a=this.width,b=this.height,c=0,e=0;if("none"!==this.alignX||"none"!==this.alignY)a=[this.width/this._element.width,this.height/this._element.height],b="meet"===this.meetOrSlice?Math.min.apply(null,a):Math.max.apply(null,a),a=this._element.width*b,b*=this._element.height,"Mid"===this.alignX&&
(c=(this.width-a)/2),"Max"===this.alignX&&(c=this.width-a),"Mid"===this.alignY&&(e=(this.height-b)/2),"Max"===this.alignY&&(e=this.height-b);return{width:a,height:b,marginX:c,marginY:e}},_resetWidthHeight:function(){var a=this.getElement();this.set("width",a.width);this.set("height",a.height)},_initElement:function(b){this.setElement(a.util.getById(b));a.util.addClass(this.getElement(),a.Image.CSS_CANVAS)},_initConfig:function(a){a||(a={});this.setOptions(a);this._setWidthHeight(a);this._element&&
this.crossOrigin&&(this._element.crossOrigin=this.crossOrigin)},_initFilters:function(b,g){b.filters&&b.filters.length?a.util.enlivenObjects(b.filters,function(a){g&&g(a)},"fabric.Image.filters"):g&&g()},_setWidthHeight:function(a){this.width="width"in a?a.width:this.getElement()?this.getElement().width||0:0;this.height="height"in a?a.height:this.getElement()?this.getElement().height||0:0},complexity:function(){return 1}}),a.Image.CSS_CANVAS="canvas-img",a.Image.prototype.getSvgSrc=a.Image.prototype.getSrc,
a.Image.fromObject=function(b,g){a.util.loadImage(b.src,function(c){a.Image.prototype._initFilters.call(b,b,function(e){b.filters=e||[];e=new a.Image(c,b);g&&g(e)})},null,b.crossOrigin)},a.Image.fromURL=function(b,g,c){a.util.loadImage(b,function(b){g&&g(new a.Image(b,c))},null,c&&c.crossOrigin)},a.Image.ATTRIBUTE_NAMES=a.SHARED_ATTRIBUTES.concat("x y width height preserveAspectRatio xlink:href".split(" ")),a.Image.fromElement=function(b,g,c){b=a.parseAttributes(b,a.Image.ATTRIBUTE_NAMES);var e="xMidYMid",
f="meet",d;b.preserveAspectRatio&&(d=b.preserveAspectRatio.split(" "));d&&d.length&&(f=d.pop(),"meet"!==f&&"slice"!==f?(e=f,f="meet"):d.length&&(e=d.pop()));d="none"!==e?e.slice(1,4):"none";e="none"!==e?e.slice(5,8):"none";b.alignX=d;b.alignY=e;b.meetOrSlice=f;a.Image.fromURL(b["xlink:href"],g,l(c?a.util.object.clone(c):{},b))},a.Image.async=!0,a.Image.pngCompression=1)})("undefined"!==typeof b?b:this);(function(a){var b=a.fabric||(a.fabric={}),h=b.util.object.extend,g=b.util.object.clone,c=b.util.toFixed,
e=b.StaticCanvas.supports("setLineDash");b.Text?b.warn("fabric.Text is already defined"):(a=b.Object.prototype.stateProperties.concat(),a.push("fontFamily","fontWeight","fontSize","text","textDecoration","textAlign","fontStyle","lineHeight","textBackgroundColor"),b.Text=b.util.createClass(b.Object,{_dimensionAffectingProps:{fontSize:!0,fontWeight:!0,fontFamily:!0,fontStyle:!0,lineHeight:!0,stroke:!0,strokeWidth:!0,text:!0,textAlign:!0},_reNewline:/\r?\n/,type:"text",fontSize:40,fontWeight:"normal",
fontFamily:"Times New Roman",textDecoration:"",textAlign:"left",fontStyle:"",lineHeight:1.16,textBackgroundColor:"",stateProperties:a,stroke:null,shadow:null,_fontSizeFraction:.25,_fontSizeMult:1.13,initialize:function(a,b){b=b||{};this.text=a;this.__skipDimension=!0;this.setOptions(b);this.__skipDimension=!1;this._initDimensions()},_initDimensions:function(a){if(!this.__skipDimension){a||(a=b.util.createCanvasElement().getContext("2d"),this._setTextStyles(a));this._textLines=this.text.split(this._reNewline);
this._clearCache();var c=this.textAlign;this.textAlign="left";this.width=this._getTextWidth(a);this.textAlign=c;this.height=this._getTextHeight(a)}},toString:function(){return"#<fabric.Text ("+this.complexity()+'): { "text": "'+this.text+'", "fontFamily": "'+this.fontFamily+'" }>'},_render:function(a){this.clipTo&&b.util.clipContext(this,a);this._renderTextBackground(a);this._renderText(a);this._renderTextDecoration(a);this.clipTo&&a.restore()},_renderText:function(a){a.save();this._translateForTextAlign(a);
this._setOpacity(a);this._setShadow(a);this._setupCompositeOperation(a);this._renderTextFill(a);this._renderTextStroke(a);this._restoreCompositeOperation(a);this._removeShadow(a);a.restore()},_translateForTextAlign:function(a){"left"!==this.textAlign&&"justify"!==this.textAlign&&a.translate("center"===this.textAlign?this.width/2:this.width,0)},_setTextStyles:function(a){a.textBaseline="alphabetic";this.skipTextAlign||(a.textAlign=this.textAlign);a.font=this._getFontDeclaration()},_getTextHeight:function(){return this._textLines.length*
this._getHeightOfLine()},_getTextWidth:function(a){for(var b=this._getLineWidth(a,0),c=1,e=this._textLines.length;c<e;c++){var g=this._getLineWidth(a,c);g>b&&(b=g)}return b},_renderChars:function(a,b,c,e,g){b[a](c,e,g)},_renderTextLine:function(a,b,c,e,g,h){g-=this.fontSize*this._fontSizeFraction;if("justify"!==this.textAlign)this._renderChars(a,b,c,e,g,h);else{var k=this._getLineWidth(b,h),l=this.width;if(l>=k){k=c.split(/\s+/);c=this._getWidthOfWords(b,c,h);for(var l=(l-c)/(k.length-1),m=c=0,n=
k.length;m<n;m++)this._renderChars(a,b,k[m],e+c,g,h),c+=b.measureText(k[m]).width+l}else this._renderChars(a,b,c,e,g,h)}},_getWidthOfWords:function(a,b){return a.measureText(b.replace(/\s+/g,"")).width},_getLeftOffset:function(){return-this.width/2},_getTopOffset:function(){return-this.height/2},_renderTextFill:function(a){if(this.fill||this._skipFillStrokeCheck){for(var b=0,c=0,e=this._textLines.length;c<e;c++){var g=this._getHeightOfLine(a,c),h=g/this.lineHeight;this._renderTextLine("fillText",
a,this._textLines[c],this._getLeftOffset(),this._getTopOffset()+b+h,c);b+=g}this.shadow&&!this.shadow.affectStroke&&this._removeShadow(a)}},_renderTextStroke:function(a){if(this.stroke&&0!==this.strokeWidth||this._skipFillStrokeCheck){var b=0;a.save();this.strokeDashArray&&(1&this.strokeDashArray.length&&this.strokeDashArray.push.apply(this.strokeDashArray,this.strokeDashArray),e&&a.setLineDash(this.strokeDashArray));a.beginPath();for(var c=0,g=this._textLines.length;c<g;c++){var h=this._getHeightOfLine(a,
c),k=h/this.lineHeight;this._renderTextLine("strokeText",a,this._textLines[c],this._getLeftOffset(),this._getTopOffset()+b+k,c);b+=h}a.closePath();a.restore()}},_getHeightOfLine:function(){return this.fontSize*this._fontSizeMult*this.lineHeight},_renderTextBackground:function(a){this._renderTextBoxBackground(a);this._renderTextLinesBackground(a)},_renderTextBoxBackground:function(a){this.backgroundColor&&(a.save(),a.fillStyle=this.backgroundColor,a.fillRect(this._getLeftOffset(),this._getTopOffset(),
this.width,this.height),a.restore())},_renderTextLinesBackground:function(a){var b=0,c=this._getHeightOfLine();if(this.textBackgroundColor){a.save();a.fillStyle=this.textBackgroundColor;for(var e=0,g=this._textLines.length;e<g;e++){if(""!==this._textLines[e]){var h=this._getLineWidth(a,e),k=this._getLineLeftOffset(h);a.fillRect(this._getLeftOffset()+k,this._getTopOffset()+b,h,this.fontSize*this._fontSizeMult)}b+=c}a.restore()}},_getLineLeftOffset:function(a){return"center"===this.textAlign?(this.width-
a)/2:"right"===this.textAlign?this.width-a:0},_clearCache:function(){this.__lineWidths=[];this.__lineHeights=[];this.__lineOffsets=[]},_shouldClearCache:function(){var a=!1,b;for(b in this._dimensionAffectingProps)this["__"+b]!==this[b]&&(this["__"+b]=this[b],a=!0);return a},_getLineWidth:function(a,b){if(this.__lineWidths[b])return this.__lineWidths[b];this.__lineWidths[b]=a.measureText(this._textLines[b]).width;return this.__lineWidths[b]},_renderTextDecoration:function(a){if(this.textDecoration){var b=
this.height/2,c=[];-1<this.textDecoration.indexOf("underline")&&c.push(.85);-1<this.textDecoration.indexOf("line-through")&&c.push(.43);-1<this.textDecoration.indexOf("overline")&&c.push(-.12);if(0<c.length){var e,g=0,h,k,l;e=0;for(h=this._textLines.length;e<h;e++){var m=this._getLineWidth(a,e),n=this._getLineLeftOffset(m),p=this._getHeightOfLine(a,e);k=0;for(l=c.length;k<l;k++)a.fillRect(this._getLeftOffset()+n,g+(this._fontSizeMult-1+c[k])*this.fontSize-b,m,this.fontSize/15);g+=p}}}},_getFontDeclaration:function(){return[b.isLikelyNode?
this.fontWeight:this.fontStyle,b.isLikelyNode?this.fontStyle:this.fontWeight,this.fontSize+"px",b.isLikelyNode?'"'+this.fontFamily+'"':this.fontFamily].join(" ")},render:function(a,b){this.visible&&(a.save(),this._setTextStyles(a),this._shouldClearCache()&&this._initDimensions(a),b||this.transform(a),this._setStrokeStyles(a),this._setFillStyles(a),this.transformMatrix&&a.transform.apply(a,this.transformMatrix),this.group&&"path-group"===this.group.type&&a.translate(this.left,this.top),this._render(a),
a.restore())},toObject:function(a){a=h(this.callSuper("toObject",a),{text:this.text,fontSize:this.fontSize,fontWeight:this.fontWeight,fontFamily:this.fontFamily,fontStyle:this.fontStyle,lineHeight:this.lineHeight,textDecoration:this.textDecoration,textAlign:this.textAlign,textBackgroundColor:this.textBackgroundColor});this.includeDefaultValues||this._removeDefaultValues(a);return a},toSVG:function(a){var b=this._createBaseSVGMarkup(),c=this._getSVGLeftTopOffsets(this.ctx),c=this._getSVGTextAndBg(c.textTop,
c.textLeft);this._wrapSVGTextAndBg(b,c);return a?a(b.join("")):b.join("")},_getSVGLeftTopOffsets:function(a){a=this._getHeightOfLine(a,0);return{textLeft:-this.width/2+(this.group&&"path-group"===this.group.type?this.left:0),textTop:0+(this.group&&"path-group"===this.group.type?-this.top:0),lineTop:a}},_wrapSVGTextAndBg:function(a,b){a.push('\t<g transform="',this.getSvgTransform(),this.getSvgTransformMatrix(),'">\n',b.textBgRects.join(""),"\t\t<text ",this.fontFamily?'font-family="'+this.fontFamily.replace(/"/g,
"'")+'" ':"",this.fontSize?'font-size="'+this.fontSize+'" ':"",this.fontStyle?'font-style="'+this.fontStyle+'" ':"",this.fontWeight?'font-weight="'+this.fontWeight+'" ':"",this.textDecoration?'text-decoration="'+this.textDecoration+'" ':"",'style="',this.getSvgStyles(),'" >',b.textSpans.join(""),"</text>\n","\t</g>\n")},_getSVGTextAndBg:function(a,b){var c=[],e=[],g=0;this._setSVGBg(e);for(var h=0,k=this._textLines.length;h<k;h++)this.textBackgroundColor&&this._setSVGTextLineBg(e,h,b,a,g),this._setSVGTextLineText(h,
c,g,b,a,e),g+=this._getHeightOfLine(this.ctx,h);return{textSpans:c,textBgRects:e}},_setSVGTextLineText:function(a,d,e,g,h){e=this.fontSize*(this._fontSizeMult-this._fontSizeFraction)-h+e-this.height/2;d.push('<tspan x="',c(g+this._getLineLeftOffset(this.__lineWidths[a]),4),'" ','y="',c(e,4),'" ',this._getFillAttributes(this.fill),">",b.util.string.escapeXml(this._textLines[a]),"</tspan>")},_setSVGTextLineBg:function(a,b,e,g,h){a.push("\t\t<rect ",this._getFillAttributes(this.textBackgroundColor),
' x="',c(e+this._getLineLeftOffset(this.__lineWidths[b]),4),'" y="',c(h-this.height/2,4),'" width="',c(this.__lineWidths[b],4),'" height="',c(this._getHeightOfLine(this.ctx,b)/this.lineHeight,4),'"></rect>\n')},_setSVGBg:function(a){this.backgroundColor&&a.push("\t\t<rect ",this._getFillAttributes(this.backgroundColor),' x="',c(-this.width/2,4),'" y="',c(-this.height/2,4),'" width="',c(this.width,4),'" height="',c(this.height,4),'"></rect>\n')},_getFillAttributes:function(a){var c=a&&"string"===typeof a?
new b.Color(a):"";return c&&c.getSource()&&1!==c.getAlpha()?'opacity="'+c.getAlpha()+'" fill="'+c.setAlpha(1).toRgb()+'"':'fill="'+a+'"'},_set:function(a,b){this.callSuper("_set",a,b);a in this._dimensionAffectingProps&&(this._initDimensions(),this.setCoords())},complexity:function(){return 1}}),b.Text.ATTRIBUTE_NAMES=b.SHARED_ATTRIBUTES.concat("x y dx dy font-family font-style font-weight font-size text-decoration text-anchor".split(" ")),b.Text.DEFAULT_SVG_FONT_SIZE=16,b.Text.fromElement=function(a,
c){if(!a)return null;var e=b.parseAttributes(a,b.Text.ATTRIBUTE_NAMES);c=b.util.object.extend(c?b.util.object.clone(c):{},e);c.top=c.top||0;c.left=c.left||0;"dx"in e&&(c.left+=e.dx);"dy"in e&&(c.top+=e.dy);"fontSize"in c||(c.fontSize=b.Text.DEFAULT_SVG_FONT_SIZE);c.originX||(c.originX="left");a=a.textContent.replace(/^\s+|\s+$|\n+/g,"").replace(/\s+/g," ");c=new b.Text(a,c);a=0;"left"===c.originX&&(a=c.getWidth()/2);"right"===c.originX&&(a=-c.getWidth()/2);c.set({left:c.getLeft()+a,top:c.getTop()-
c.getHeight()/2+c.fontSize*(.18+c._fontSizeFraction)});return c},b.Text.fromObject=function(a){return new b.Text(a.text,g(a))},b.util.createAccessors(b.Text))})("undefined"!==typeof b?b:this);delete window.fabric;return b}().fabric;b.fabric=a}}});(function(){var b=X(m.com.fabricjs).fabric,a=u([13,27,32]),k=a[0],n=a[1],p=a[2];window.onkeydown=function(a){return a.keyCode!=p};var l=v("Attribute",[R],{get __init__(){return q(this,function(a,b){a.game=b;a.game.attributes.append(a);a.install();a.reset()})},
get reset(){return q(this,function(a){a.commit()})},get predict(){return q(this,function(a){})},get interact(){return q(this,function(a){})},get commit(){return q(this,function(a){})}}),h=v("Sprite",[l],{get __init__(){return q(this,function(a,b,c,e){a.width=c;a.height=e;l.__init__(a,b)})},get install(){return q(this,function(a){a.image=new b.Rect(y({width:a.game.scaleX(a.width),height:a.game.scaleY(a.height),originX:"center",originY:"center",fill:"white"}))})},get reset(){return q(this,function(a,
b,c,e,f){if("undefined"==typeof b||null!=b&&b.hasOwnProperty("__kwargtrans__"))b=0;if("undefined"==typeof c||null!=c&&c.hasOwnProperty("__kwargtrans__"))c=0;if("undefined"==typeof e||null!=e&&e.hasOwnProperty("__kwargtrans__"))e=0;if("undefined"==typeof f||null!=f&&f.hasOwnProperty("__kwargtrans__"))f=0;if(arguments.length){var g=arguments.length-1;if(arguments[g]&&arguments[g].hasOwnProperty("__kwargtrans__")){var g=arguments[g--],h;for(h in g)switch(h){case "self":a=g[h];break;case "vX":b=g[h];
break;case "vY":c=g[h];break;case "x":e=g[h];break;case "y":f=g[h]}}}a.vX=b;a.vY=c;a.x=e;a.y=f;l.reset(a)})},get predict(){return q(this,function(a){a.x+=a.vX*a.game.deltaT;a.y+=a.vY*a.game.deltaT})},get commit(){return q(this,function(a){a.image.left=a.game.orthoX(a.x);a.image.top=a.game.orthoY(a.y)})},get draw(){return q(this,function(a){a.game.canvas.add(a.image)})}}),g=v("Paddle",[h],{margin:30,width:10,height:100,speed:400,get __init__(){return q(this,function(a,b,c){a.index=c;h.__init__(a,b,
a.width,a.height)})},get reset(){return q(this,function(a){h.reset(a,I({x:a.index?Math.floor(500)-a.margin:Math.floor(-500)+a.margin,y:0}))})},get predict(){return q(this,function(a){a.vY=0;a.index?a.game.keyCode==T("K")?a.vY=a.speed:a.game.keyCode==T("M")&&(a.vY=-a.speed):a.game.keyCode==T("A")?a.vY=a.speed:a.game.keyCode==T("Z")&&(a.vY=-a.speed);h.predict(a)})},get interact(){return q(this,function(a){a.y=Math.max(Math.floor(a.height/2)-Math.floor(325),Math.min(a.y,Math.floor(325)-Math.floor(a.height/
2)));a.y-Math.floor(a.height/2)<a.game.ball.y&&a.game.ball.y<a.y+Math.floor(a.height/2)&&(0==a.index&&a.game.ball.x<a.x||1==a.index&&a.game.ball.x>a.x)&&(a.game.ball.x=a.x,a.game.ball.vX=-a.game.ball.vX,a.game.ball.speedUp(a))})}}),c=v("Ball",[h],{side:8,speed:300,get __init__(){return q(this,function(a,b){h.__init__(a,b,a.side,a.side)})},get reset(){return q(this,function(a){var b=a.game.serviceIndex*Math.PI+(.5<Math.random()?1:-1)*Math.random()*Math.atan(.65);h.reset(a,I({vX:a.speed*Math.cos(b),
vY:a.speed*Math.sin(b)}))})},get predict(){return q(this,function(a){h.predict(a);a.x<Math.floor(-500)?a.game.scored(1):a.x>Math.floor(500)&&a.game.scored(0);a.y>Math.floor(325)?(a.y=Math.floor(325),a.vY=-a.vY):a.y<Math.floor(-325)&&(a.y=Math.floor(-325),a.vY=-a.vY)})},get speedUp(){return q(this,function(a,b){b=1+.15*Math.pow(1-Math.abs(a.y-b.y)/Math.floor(b.height/2),2);Math.abs(a.vX)<3*a.speed&&(a.vX*=b,a.vY*=b)})}}),e=v("Scoreboard",[l],{nameShift:75,hintShift:25,get install(){return q(this,function(a){for(var c=
[],e=$jscomp.makeIterator(u([u(["AZ keys:",-.4375]),u(["KM keys:",.0625])])),f=e.next();!f.done;f=e.next()){var g=$jscomp.makeIterator(f.value),f=g.next().value,g=g.next().value;c.append(new b.Text("Player {}".format(f),y({fill:"white",fontFamily:"arial",fontSize:"{}".format(a.game.canvas.width/30),left:a.game.orthoX(1E3*g),top:a.game.orthoY(Math.floor(325)+a.nameShift)})))}a.playerLabels=c;a.hintLabel=new b.Text("[spacebar] starts game, [enter] resets score",y({fill:"white",fontFamily:"arial",fontSize:"{}".format(a.game.canvas.width/
70),left:a.game.orthoX(-437.5),top:a.game.orthoY(Math.floor(325)+a.hintShift)}));a.image=new b.Line(H([a.game.orthoX(Math.floor(-500)),a.game.orthoY(Math.floor(325)),a.game.orthoX(Math.floor(500)),a.game.orthoY(Math.floor(325))]),y({stroke:"white"}))})},get increment(){return q(this,function(a,b){a.scores[b]++})},get reset(){return q(this,function(a){a.scores=H([0,0]);l.reset(a)})},get commit(){return q(this,function(a){for(var c=[],e=$jscomp.makeIterator(ba(a.scores,u([-.125,.375]))),f=e.next();!f.done;f=
e.next()){var g=$jscomp.makeIterator(f.value),f=g.next().value,g=g.next().value;c.append(new b.Text("{}".format(f),y({fill:"white",fontFamily:"arial",fontSize:"{}".format(a.game.canvas.width/30),left:a.game.orthoX(1E3*g),top:a.game.orthoY(Math.floor(325)+a.nameShift)})))}a.scoreLabels=c})},get draw(){return q(this,function(a){for(var b=$jscomp.makeIterator(ba(a.playerLabels,a.scoreLabels)),c=b.next();!c.done;c=b.next()){var e=$jscomp.makeIterator(c.value),c=e.next().value,e=e.next().value;a.game.canvas.add(c);
a.game.canvas.add(e);a.game.canvas.add(a.hintLabel)}a.game.canvas.add(a.image)})}}),a=v("Game",[R],{get __init__(){return q(this,function(a){a.serviceIndex=.5<Math.random()?1:0;a.pause=!0;a.keyCode=null;a.textFrame=document.getElementById("text_frame");a.canvasFrame=document.getElementById("canvas_frame");a.buttonsFrame=document.getElementById("buttons_frame");a.canvas=new b.Canvas("canvas",y({backgroundColor:"black",originX:"center",originY:"center"}));a.canvas.onWindowDraw=a.draw;a.canvas.lineWidth=
2;a.canvas.clear();a.attributes=H([]);a.paddles=function(){for(var b=[],c=0;2>c;c++)b.append(g(a,c));return b}();a.ball=c(a);a.scoreboard=e(a);window.setInterval(a.py_update,10);window.setInterval(a.draw,20);window.addEventListener("keydown",a.keydown);window.addEventListener("keyup",a.keyup);a.buttons=H([]);for(var f=$jscomp.makeIterator(u("A Z K M space enter".split(" "))),h=f.next();!h.done;h=f.next()){var h=h.value,k=document.getElementById(h);k.addEventListener("mousedown",function(b){return function(){return a.mouseOrTouch(b,
!0)}}(h));k.addEventListener("touchstart",function(b){return function(){return a.mouseOrTouch(b,!0)}}(h));k.addEventListener("mouseup",function(b){return function(){return a.mouseOrTouch(b,!1)}}(h));k.addEventListener("touchend",function(b){return function(){return a.mouseOrTouch(b,!1)}}(h));k.style.cursor="pointer";k.style.userSelect="none";a.buttons.append(k)}a.time=+new Date;window.onresize=a.resize;a.resize()})},get install(){return q(this,function(a){a=$jscomp.makeIterator(a.attributes);for(var b=
a.next();!b.done;b=a.next())b.value.install()})},get mouseOrTouch(){return q(this,function(a,b,c){a.keyCode=c?"space"==b?p:"enter"==b?k:T(b):null})},get py_update(){return q(this,function(a){var b=a.time;a.time=+new Date;a.deltaT=(a.time-b)/1E3;if(a.pause)a.keyCode==p?a.pause=!1:a.keyCode==k&&a.scoreboard.reset();else{for(var c=$jscomp.makeIterator(a.attributes),b=c.next();!b.done;b=c.next())b=b.value,b.predict();c=$jscomp.makeIterator(a.attributes);for(b=c.next();!b.done;b=c.next())b=b.value,b.interact();
a=$jscomp.makeIterator(a.attributes);for(b=a.next();!b.done;b=a.next())b=b.value,b.commit()}})},get scored(){return q(this,function(a,b){a.scoreboard.increment(b);a.serviceIndex=1-b;b=$jscomp.makeIterator(a.paddles);for(var c=b.next();!c.done;c=b.next())c.value.reset();a.ball.reset();a.pause=!0})},get commit(){return q(this,function(a){a=$jscomp.makeIterator(a.attributes);for(var b=a.next();!b.done;b=a.next())b.value.commit()})},get draw(){return q(this,function(a){a.canvas.clear();a=$jscomp.makeIterator(a.attributes);
for(var b=a.next();!b.done;b=a.next())b.value.draw()})},get resize(){return q(this,function(a){a.pageWidth=window.innerWidth;a.pageHeight=window.innerHeight;a.textTop=0;a.pageHeight>1.2*a.pageWidth?(a.canvasWidth=a.pageWidth,a.canvasTop=a.textTop+300):(a.canvasWidth=.6*a.pageWidth,a.canvasTop=a.textTop+200);a.canvasLeft=.5*(a.pageWidth-a.canvasWidth);a.canvasHeight=.6*a.canvasWidth;a.buttonsTop=a.canvasTop+a.canvasHeight+50;a.buttonsWidth=500;a.textFrame.style.top=a.textTop;a.textFrame.style.left=
a.canvasLeft+.05*a.canvasWidth;a.textFrame.style.width=.9*a.canvasWidth;a.canvasFrame.style.top=a.canvasTop;a.canvasFrame.style.left=a.canvasLeft;a.canvas.setDimensions(y({width:a.canvasWidth,height:a.canvasHeight}));a.buttonsFrame.style.top=a.buttonsTop;a.buttonsFrame.style.left=.5*(a.pageWidth-a.buttonsWidth);a.buttonsFrame.style.width=a.canvasWidth;a.install();a.commit();a.draw()})},get scaleX(){return q(this,function(a,b){return a.canvas.width/1E3*b})},get scaleY(){return q(this,function(a,b){return a.canvas.height/
750*b})},get orthoX(){return q(this,function(a,b){return a.scaleX(b+Math.floor(500))})},get orthoY(){return q(this,function(a,b){return a.scaleY(750-Math.floor(325)-b)})},get keydown(){return q(this,function(a,b){a.keyCode=b.keyCode})},get keyup(){return q(this,function(a,b){a.keyCode=null})}}),f=a();m.Attribute=l;m.Ball=c;m.Game=a;m.Paddle=g;m.Scoreboard=e;m.Sprite=h;m.enter=k;m.esc=n;m.fabric=b;m.fieldHeight=650;m.game=f;m.orthoHeight=750;m.orthoWidth=1E3;m.space=p})();return m}window.pong=pong();

//# sourceMappingURL=extra/sourcemap/pong.min.js.map
