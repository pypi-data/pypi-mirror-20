#TMSH-VERSION: 11.6.0

gtm datacenter /Common/AsiaDC { }
gtm datacenter /Common/DC1 { }
gtm datacenter /Common/DC2 { }
gtm datacenter /Common/DC3 { }
gtm datacenter /Common/EuropeDC { }
gtm pool /Common/GTM-pool-2 {
    alternate-mode drop-packet
    fallback-ipv4 1.1.1.1
    fallback-mode none
    load-balancing-mode global-availability
    members {
        /Common/Avi-SE-1:VIP {
            order 0
        }
        /Common/Avi-SE-2:VIP-2 {
            order 1
        }
    }
    monitor /Common/gateway_icmp 
}
gtm pool /Common/gtm_pool { }
gtm prober-pool /Common/myproberpool {
    members {
        /Common/gtmself {
            order 0
        }
    }
}
gtm region /Common/EastCoast {
    region-members {
        country AF { }
    }
}
gtm region /Common/WestCoast {
    region-members {
        state US/Alabama { }
        state US/Arizona { }
        state US/California { }
    }
}
gtm server "/Common/Avi Vantage" {
    addresses {
        1.1.1.1 {
            device-name "Avi Vantage"
        }
    }
    datacenter /Common/DC1
    product generic-load-balancer
    virtual-servers {
        demo_avi_com {
            destination 10.1.1.1:80
            translation-address 200.1.1.1
            translation-port 80
        }
        www_avi_com {
            destination 10.1.1.2:80
            translation-address 200.1.1.2
            translation-port 80
        }
    }
}
gtm server /Common/Avi-SE-1 {
    addresses {
        10.90.117.180 {
            device-name Avi-SE-1
        }
    }
    datacenter /Common/EuropeDC
    product generic-host
    virtual-servers {
        VIP {
            destination 10.90.117.100:80
            monitor /Common/tcp 
        }
    }
}
gtm server /Common/Avi-SE-2 {
    addresses {
        10.90.115.10 {
            device-name Avi-SE-2
        }
    }
    datacenter /Common/EuropeDC
    product generic-host
    virtual-servers {
        VIP-2 {
            destination 10.10.10.10:80
        }
    }
}
gtm server /Common/F5-GTM-1 {
    addresses {
        10.10.10.10 {
            device-name F5-GTM-1
        }
    }
    datacenter /Common/AsiaDC
    product generic-host
    virtual-servers {
        website1 {
            destination 10.10.10.101:80
        }
        website2 {
            destination 10.10.10.201:80
        }
    }
}
gtm server /Common/SErver3 {
    addresses {
        10.90.114.12 {
            device-name SErver3
        }
    }
    datacenter /Common/DC1
    prober-pool /Common/myproberpool
    product generic-load-balancer
    virtual-servers {
        SErver3 {
            destination 10.90.114.30:80
            monitor /Common/my1.0_healthcheck 
        }
        unixserver {
            destination 10.90.115.10:80
            monitor /Common/my1.0_healthcheck 
        }
    }
}
gtm server /Common/gtmself {
    addresses {
        10.90.114.120 {
            device-name gtmself
        }
    }
    datacenter /Common/DC1
    monitor /Common/bigip 
    virtual-server-discovery enabled
    virtual-servers {
        /Common/EngVIP {
            destination 172.1.1.1:80
        }
        /Common/F5-VIP-80-001 {
            destination 192.168.38.20:80
        }
        /Common/F5-VIP-443-001 {
            destination 192.168.38.21:443
        }
        /Common/F5-VIP-443-002 {
            destination 192.168.38.22:443
        }
        /Common/F5-VIP-443-004 {
            destination 192.168.38.25:443
        }
        /Common/F5-VIP-Forwarding {
            destination 10.10.20.0:0
        }
        /Common/testhttp {
            destination 10.90.191.111:67
        }
        /Common/testmr {
            destination 10.90.191.100:80
        }
        /Common/testvip {
            destination 10.90.114.121:67
        }
        /Common/testvip-http-80 {
            destination 10.90.114.121:80
        }
    }
}
gtm topology  ldns: region /Common/WestCoast  server: datacenter /Common/DC2 {
    order 1
    score 100
}
gtm topology  ldns: region /Common/EastCoast  server: datacenter /Common/DC1 {
    order 2
    score 100
}
gtm topology  ldns: region /Common/EastCoast  server: datacenter /Common/DC2 {
    order 3
    score 10
}
gtm topology  ldns: region /Common/WestCoast  server: datacenter /Common/DC1 {
    order 4
    score 10
}
gtm wideip /Common/www.test2.com {
    pools {
        /Common/GTM-pool-2 {
            order 0
        }
        /Common/gtm_pool {
            order 1
        }
    }
}
gtm global-settings general {
    monitor-disabled-objects yes
    synchronization yes
    synchronize-zone-files yes
}
gtm global-settings metrics {
    metrics-collection-protocols { icmp }
}
gtm global-settings metrics-exclusions {
    addresses none
}
gtm monitor gateway-icmp /Common/myicmp {
    defaults-from /Common/gateway_icmp
    destination *:*
    interval 2
    probe-attempts 3
    probe-interval 1
    probe-timeout 5
    timeout 5
}
gtm monitor http /Common/my1.0_healthcheck {
    defaults-from /Common/http
    destination *:*
    interval 2
    probe-timeout 5
    recv 200
    send "GET /index.html HTTP/1.0\\r\\nConnection: Close\\r\\n\\r\\n"
    timeout 5
}
