{% extends "base_nav.html" %}
{% load humanize %}
{% load i18n %}
{% load staticfiles %}
{% load smart_pagination %}
{% block "title" %}{% trans "Audit log" %}{% endblock %}
{% block "content" %}
<div class="container">
	<div class="row">
		<div class="col-md-12">
			<h1>
			{% if secret %}
			{% blocktrans with name=secret.name %}Audit log for secret '{{ name }}'{% endblocktrans %}
			{% elif user %}
			{% blocktrans with name=user.username %}Audit log for user '{{ name }}'{% endblocktrans %}
			{% else %}
			{% trans "Audit log" %}
			{% endif %}
			</h1>
			<br><br>
			<div class="panel panel-default">
				<table class="table table-hover">
					{% for entry in log_entries %}
					<tr>
					<td>{{ entry.time|date:"Y-m-d H:i:s" }}</td>
					<td>{% if entry.secret %}<a href="{{ entry.secret.get_absolute_url }}">{{ entry.secret.name }}</a>{% endif %}</td>
					<td>{% if entry.actor %}{{ entry.actor.username }}{% endif %}</td>
					<td>{{ entry.message }}</td>
					</tr>
					{% endfor %}
				</table>
			</div>
			{% if is_paginated %}
			<ul class="pagination">
				{% if page_obj.has_previous %}
				<li><a href="?page={{ page_obj.previous_page_number }}{% if audit_search_term %}&search={{ audit_search_term_url }}{% endif %}"><i class="fa fa-chevron-left"></i></a></li>
				{% else %}
				<li class="disabled"><a href="#"><i class="fa fa-chevron-left"></i></a></li>
				{% endif %}
				{% for page in paginator.page_range|smart_pages:page_obj.number %}
				{% if page_obj.number == page %}
				<li class="active"><a href="#">{{ page }} <span class="sr-only">(current)</span></a></li>
				{% else %}
				<li><a href="?page={{ page }}{% if audit_search_term %}&search={{ audit_search_term_url }}{% endif %}">{{ page }}</a></li>
				{% endif %}
				{% endfor %}
				{% if page_obj.has_next %}
				<li><a href="?page={{ page_obj.next_page_number }}{% if audit_search_term %}&search={{ audit_search_term_url }}{% endif %}"><i class="fa fa-chevron-right"></i></a></li>
				{% else %}
				<li class="disabled"><a href="#"><i class="fa fa-chevron-right"></i></a></li>
				{% endif %}
			</ul>
			{% endif %}
		</div>
	</div>
</div>
{% endblock %}
